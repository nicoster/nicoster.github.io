<?xml version="1.0" encoding="utf-8" ?>
 <rss version="2.0" xmlns:excerpt="http://wordpress.org/export/1.0/excerpt/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:wfw="http://wellformedweb.org/CommentAPI/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:wp="http://wordpress.org/export/1.0/">
  <channel>

<item><title><![CDATA[svn 命令行操作]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2011/02/28/6214314.aspx</link><content:encoded><![CDATA[

<p>
<p>以下命令在 OSX Terminal 测试通过</p>
<p>

<p>nickx:~/Documents $ svn --version</p>
<p>svn, version 1.6.5 (r38866)</p>
<p>&nbsp;&nbsp; compiled Jun 24 2010, 17:16:45</p>
<div></div>
</p>
<p>nickx:~/Documents $ svn ps svn:ignore '</p>
<p>*.pbxuser</p>
<p>*.mode1v3</p>
<p>&nbsp;' yourproject.xcodeproj</p>

<p>
<p>nickx:~/Documents $&nbsp;svn ps svn:externals "LlamaSettings http://llamasettings.googlecode.com/svn/trunk/src/LlamaSettings" .</p>
<p>(注意最后的点，表示在当前目录设置 externals property)</p>
<div></div>
</p>
<div></div>
</p>
]]></content:encoded><pubDate>2011-02-28 22:45</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[海信播放 mkv ]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2011/01/29/6168629.aspx</link><content:encoded><![CDATA[

<p>买了一个海信电视 (LED42K11P), 可以接 USB 移动硬盘，直接播放其中的 mkv 等文件。使用中发现一些 mkv 无法播放</p>
<p>用 mkvinfo 查看不能播放的文件，如下：</p>
<p><textarea cols="50" rows="15" name="code" class="c-sharp">nickx:/Applications/Mkvtoolnix.app/Contents/MacOS $ ./mkvinfo ~/Movie/Open.Season.2006.1080p.BluRay.x264-ESiR.mkv 
+ EBML head
|+ Doc type: matroska
|+ Doc type version: 1
|+ Doc type read version: 1
+ Segment, size 7282675670
|+ Seek head (subentries will be skipped)
|+ EbmlVoid (size: 4025)
|+ Segment information
| + Timecode scale: 1000000
| + Muxing application: libebml v0.7.7 + libmatroska v0.8.1
| + Writing application: mkvmerge v2.1.0 ('Another Place To Fall') built on Aug 19 2007 13:40:07
| + Duration: 5175.584s (01:26:15.584)
| + Date: Sun Dec 30 05:47:57 2007 UTC
| + Segment UID: 0x92 0x5a 0x8d 0x80 0x47 0xa0 0x13 0xd2 0x9a 0x57 0xe0 0xb1 0x41 0x87 0x95 0xb4
|+ Segment tracks
| + A track
|  + Track number: 1
|  + Track UID: 3008761227
|  + Track type: video
|  + Enabled: 1
|  + Default flag: 1
|  + Forced flag: 0
|  + Lacing flag: 0
|  + MinCache: 1
|  + Timecode scale: 1
|  + Max BlockAddition ID: 0
|  + Codec ID: V_MPEG4/ISO/AVC
|  + Codec decode all: 1
|  + CodecPrivate, length 130 (h.264 profile: High @L5.1)
|  + Default duration: 41.708ms (23.976 fps for a video track)
|  + Language: eng
|  + Name: x264 @ 10230kbps
|  + Video track
|   + Pixel width: 1920
|   + Pixel height: 1040
|   + Interlaced: 0
|   + Display width: 1920
|   + Display height: 1040
| + A track
|  + Track number: 2
|  + Track UID: 3723460535
|  + Track type: audio
|  + Enabled: 1
|  + Default flag: 1
|  + Forced flag: 0
|  + Lacing flag: 1
|  + MinCache: 0
|  + Timecode scale: 1
|  + Max BlockAddition ID: 0
|  + Codec ID: A_AC3
|  + Codec decode all: 1
|  + Default duration: 32.000ms (31.250 fps for a video track)
|  + Language: eng
|  + Name: AC3 5.1 @ 640kbps
|  + Audio track
|   + Sampling frequency: 48000
|   + Channels: 6
| + A track
|  + Track number: 3
|  + Track UID: 3162890891
|  + Track type: subtitles
|  + Enabled: 1
|  + Default flag: 1
|  + Forced flag: 0
|  + Lacing flag: 0
|  + MinCache: 0
|  + Timecode scale: 1
|  + Max BlockAddition ID: 0
|  + Codec ID: S_TEXT/UTF8
|  + Codec decode all: 1
|  + Language: eng
| + A track
|  + Track number: 4
|  + Track UID: 955949746
|  + Track type: subtitles
|  + Enabled: 1
|  + Default flag: 0
|  + Forced flag: 0
|  + Lacing flag: 0
|  + MinCache: 0
|  + Timecode scale: 1
|  + Max BlockAddition ID: 0
|  + Codec ID: S_TEXT/UTF8
|  + Codec decode all: 1
|  + Language: swe
| + A track
|  + Track number: 5
|  + Track UID: 4217129601
|  + Track type: subtitles
|  + Enabled: 1
|  + Default flag: 0
|  + Forced flag: 0
|  + Lacing flag: 0
|  + MinCache: 0
|  + Timecode scale: 1
|  + Max BlockAddition ID: 0
|  + Codec ID: S_TEXT/UTF8
|  + Codec decode all: 1
|  + Language: fin
| + A track
|  + Track number: 6
|  + Track UID: 2746514592
|  + Track type: audio
|  + Enabled: 1
|  + Default flag: 0
|  + Forced flag: 0
|  + Lacing flag: 1
|  + MinCache: 0
|  + Timecode scale: 1
|  + Max BlockAddition ID: 0
|  + Codec ID: A_AC3
|  + Codec decode all: 1
|  + Default duration: 32.000ms (31.250 fps for a video track)
|  + Language: und
|  + Audio track
|   + Sampling frequency: 48000
|   + Channels: 6
|+ EbmlVoid (size: 1024)
|+ Cluster
</textarea>&nbsp;</p>

<p>关键在这行：&nbsp;&nbsp;+ CodecPrivate, length 130 (h.264 profile: High @L5.1)</p>
<p>查看了一下 h.264 里关于 level 5.1 的描述 （http://en.wikipedia.org/wiki/H.264/MPEG-4_AVC#Levels), 又 google 了一番，发现很多电视/硬件播放器等都只支持到 L4.1. 所以，考虑将 L5.1 转到 L4.1，貌似最好用的工具是 MediaCoder, 居然发现是国人折腾的。不由得感叹国内盗版的发达促进了视频转换软件的发展。 试着转换了一下，许是参数设置的问题， 转换出来的文件可能是参数设置的问题，清晰度大大下降, 而且转换过程极慢，估计即使使用 CUDA 也好几个小时。</p>

<p>对于不能播放的文件，我也遇到一个不一样的情况</p>
<p><textarea cols="50" rows="15" name="code" class="c-sharp">nickx:/Applications/Mkvtoolnix.app/Contents/MacOS $ ./mkvinfo /Volumes/Movie\ Center/Crossbow.Inception.720p《盗梦空间》/crossbow.inception.720p.mkv 
+ EBML head
|+ EBML version: 1
|+ EBML read version: 1
|+ EBML maximum ID length: 4
|+ EBML maximum size length: 8
|+ Doc type: matroska
|+ Doc type version: 2
|+ Doc type read version: 2
+ Segment, size 7034822683
|+ Seek head (subentries will be skipped)
|+ EbmlVoid (size: 4028)
|+ Segment information
| + Timecode scale: 1000000
| + Muxing application: libebml v1.0.0 + libmatroska v1.0.0
| + Writing application: mkvmerge v4.4.0 ('Die Wiederkehr') built on Oct 31 2010 21:52:48
| + Duration: 8887.963s (02:28:07.963)
| + Date: Sun Nov 14 13:02:25 2010 UTC
| + Segment UID: 0x8d 0x10 0x80 0x91 0xaa 0x8b 0x24 0x66 0xb2 0x72 0xc3 0x86 0xd4 0x09 0x72 0x1c
|+ Segment tracks
| + A track
|  + Track number: 1
|  + Track UID: 197403056
|  + Track type: audio
|  + Codec ID: A_DTS
|  + Audio track
|   + Sampling frequency: 48000
|   + Channels: 6
| + A track
|  + Track number: 2
|  + Track UID: 3594460600
|  + Track type: subtitles
|  + Default flag: 0
|  + Lacing flag: 0
|  + Codec ID: S_TEXT/UTF8
| + A track
|  + Track number: 3
|  + Track UID: 1
|  + Track type: video
|  + Lacing flag: 0
|  + MinCache: 1
|  + Codec ID: V_MPEG4/ISO/AVC
|  + CodecPrivate, length 41 (h.264 profile: High @L4.1)
|  + Default duration: 41.708ms (23.976 fps for a video track)
|  + Video track
|   + Pixel width: 1280
|   + Pixel height: 536
|   + Display width: 1280
|   + Display height: 536
|  + Content encodings
|   + Content encoding
|    + Content compression
|     + Algorithm: 3 (header removal)
|     + Settings: length 1, data:  0x00
|+ EbmlVoid (size: 1143)
...
|+ EbmlVoid (size: 101)
|+ Cluster
</textarea>&nbsp;</p>
<p>这个文件不一样的地方是，它的 video track 在最后，不象其他的文件都是在第一个 track. 用 mmg 调整一下顺序就可以播放了。 调整顺序的过程也比较快， 大概 5 分钟吧</p>

<p>试图进入海信电视的工厂模式，一直没能成功。</p>
]]></content:encoded><pubDate>2011-01-29 11:10</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[用 sed 批量修改文件]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2010/11/09/5996722.aspx</link><content:encoded><![CDATA[

<p>最终的命令行如下：</p>

<p>find . -depth 4 -name '*.vcproj'|xargs sed -i -e 's/".*\.pdb"/"..\/..\/..\/..\/maps\/$(ConfigurationName)\/$(TargetName).pdb"/g'</p>

<p>主要是 sed 命令的使用，其实也简单&nbsp;</p>
<p>-i in-place editing</p>
<p>-e 's/../../g' 用第二部分替换第一部分，g 表全局替换</p>


<p>reference:</p>
<p>http://www.chedong.com/blog/archives/001201.html</p>
<p>http://rainx.cn/archives/81</p>
]]></content:encoded><pubDate>2010-11-09 08:45</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[给 mp3 加 lrc]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2010/10/18/5948366.aspx</link><content:encoded><![CDATA[

<p>find . -name '*.lrc' -exec sed -i '.bak' '1'd {} \;&nbsp;</p>
<p>先对 lrc 文件进行处理，去掉第一行。因为第一行是中文，貌似 eyed3 不能处理中文，anyway 去掉每个文件的第一行</p>

<p>
<p>&nbsp;ls -1 *.mp3 |awk -F [-.] '{printf "eyed3 -t \"%s New Concept II\" -n %d -L ::\"$(cat %d.lrc)\" -A \"New Concept II\" --remove-images -N 96 %s\n", $2, $2, $2, $0}'|bash</p>
<div>使用 eyed3&nbsp;</div>
</p>

]]></content:encoded><pubDate>2010-10-18 11:44</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Add a static route item in OSX]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2010/06/03/5644659.aspx</link><content:encoded><![CDATA[

<p>
<p>nickx:~ $ cd /Library/StartupItems/</p>
<p>nickx:/Library/StartupItems $ ls</p>
<p>AddRoutes</p>
<p>nickx:/Library/StartupItems $ cd AddRoutes/</p>
<p>nickx:/Library/StartupItems/AddRoutes $ ls</p>
<p>AddRoutes<span></span>StartupParameters.plist</p>
<p>nickx:/Library/StartupItems/AddRoutes $ cat AddRoutes&nbsp;</p>
<p>#!/bin/sh</p>

<p># Set up static routing tables&nbsp;</p>
<p># Roark Holz, Thursday, April 6, 2006</p>

<p>. /etc/rc.common</p>

<p>StartService ()</p>
<p>{</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;ConsoleMessage "Adding Static Routing Tables"</p>
<p><span></span>sudo route add 10.224.0.0/16 10.224.104.129</p>
<p>}</p>

<p>StopService ()</p>
<p>{</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;return 0</p>
<p>}</p>

<p>RestartService ()</p>
<p>{</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;return 0</p>
<p>}</p>

<p>RunService "$1"</p>
<p>nickx:/Library/StartupItems/AddRoutes $ cat StartupParameters.plist&nbsp;</p>
<p>{</p>
<p>Description = "Add static routing tables";</p>
<p>Provides = ("AddRoutes");</p>
<p>Requires = ("Network");</p>
<p>OrderPreference = "None";</p>
<p>}</p>
<p>nickx:/Library/StartupItems/AddRoutes $ cd ..</p>
<p>nickx:/Library/StartupItems $ chown -R root:wheel AddRoutes/</p>
<p>nickx:/Library/StartupItems $ cd AddRoutes/</p>
<p>nickx:/Library/StartupItems/AddRoutes $ chmod 755 *</p>
<p>nickx:/Library/StartupItems/AddRoutes $ ls</p>
<p>AddRoutes<span></span>StartupParameters.plist</p>
<p>nickx:/Library/StartupItems/AddRoutes $ ls -l</p>
<p>total 16</p>
<p>-rwxr-xr-x@ 1 root &nbsp;wheel &nbsp;313 Jun &nbsp;3 10:26 AddRoutes</p>
<p>-rwxr-xr-x@ 1 root &nbsp;wheel &nbsp;123 Jun &nbsp;3 10:26 StartupParameters.plist</p>
<div></div>
</p>
]]></content:encoded><pubDate>2010-06-03 14:10</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[pass phrase arguments]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2010/01/20/5216374.aspx</link><content:encoded><![CDATA[

<h1><a name="PASS_PHRASE_ARGUMENTS">PASS PHRASE ARGUMENTS</a></h1>
<p>Several commands accept password arguments, typically using <strong>-passin</strong> and <strong>-passout</strong> for input and output passwords respectively. These allow the password to be obtained from a variety of sources. Both of these options take a single argument whose format is described below. If no password argument is given and a password is required then the user is prompted to enter one: this will typically be read from the current terminal with echoing turned off. </p>
<dl><dt><strong><a name="item_pass"><strong>pass:password</strong></a></strong> </dt><dd>
<p>the actual password is <strong>password</strong>. Since the password is visible to utilities (like 'ps' under Unix) this form should only be used where security is not important. </p>
</dd><dt><strong><a name="item_env"><strong>env:var</strong></a></strong> </dt><dd>
<p>obtain the password from the environment variable <strong>var</strong>. Since the environment of other processes is visible on certain platforms (e.g. ps under certain Unix OSes) this option should be used with caution. </p>
</dd><dt><strong><a name="item_file"><strong>file:pathname</strong></a></strong> </dt><dd>
<p>the first line of <strong>pathname</strong> is the password. If the same <strong>pathname</strong> argument is supplied to <strong>-passin</strong> and <strong>-passout</strong> arguments then the first line will be used for the input password and the next line for the output password. <strong>pathname</strong> need not refer to a regular file: it could for example refer to a device or named pipe. </p>
</dd><dt><strong><a name="item_fd"><strong>fd:number</strong></a></strong> </dt><dd>
<p>read the password from the file descriptor <strong>number</strong>. This can be used to send the data via a pipe for example. </p>
</dd><dt><strong><a name="item_stdin"><strong>stdin</strong></a></strong> </dt><dd>
<p>read the password from standard input. </p>
</dd></dl>
]]></content:encoded><pubDate>2010-01-20 11:11</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[win64 debugging]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/12/28/5090737.aspx</link><content:encoded><![CDATA[

<p>32位程序在 win64 下运行 crash, 用 taskmgr 创建一个 dump. 用 32位 windbg 打开这个 dump, 用如下命令切换到 32位 模式之后, 调试就和普通 32位 dump 一样了:</p>

<p>0:000&gt; <strong>.load wow64exts</strong><br />0:000&gt; <strong>!sw</strong><br />Switched to <strong>32bit mode</strong></p>
]]></content:encoded><pubDate>2009-12-28 14:00</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[check ShowWindow API]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/12/10/4979075.aspx</link><content:encoded><![CDATA[

<p>在 windows 下调试窗口相关的代码时, 有时候需要检查一个窗口为什么被显示/隐藏. 归根结底显示/隐藏窗口都是通过调用 ShowWindow/SetWindowPos 这两个 API 来实现的. 这里提供的脚本本质上就是在这两个 API 上放断点. trace 出窗口句柄以及参数. 看脚本:</p>
<p><textarea cols="50" rows="15" name="code" class="c-sharp">.if (not(${/d:$arg1})) 
{
.echo usage:
.echo "  $$&gt;a&lt;${$arg0} [hwnd]"
.echo "  Specify hwnd if you want to break"

bp USER32!NtUserShowWindow ".printf \"%N, %N, ShowWindow\\n\", poi(@esp+4), @@(!!@@(poi(@esp+8)));g"
bp USER32!NtUserSetWindowPos ".printf \"%N, %N, SetWindowPos\\n\", poi(@esp+4), @@(!!(@@(poi(@esp+1c))&amp;0x40));g"
}
.else
{
bp USER32!NtUserShowWindow ".printf \"%N, %N, ShowWindow\\n\", poi(@esp+4), @@(!!@@(poi(@esp+8)));j (poi(@esp+4) == ${$arg1}) '';'g'"
bp USER32!NtUserSetWindowPos ".printf \"%N, %N, SetWindowPos\\n\", poi(@esp+4), @@(!!(@@(poi(@esp+1c))&amp;0x40));j (poi(@esp+4) == ${$arg1}) '';'g'"
}

bl
</textarea>&nbsp;</p>

<p>将文件保存为&nbsp;chkshowwnd 到&nbsp;windbg 安装目录. 在 windbg 中这样调用:</p>

<p>$$&gt;a&lt;chkshowwnd [hwnd]&nbsp;</p>

<p>如果不指定窗口句柄, 则会显示所有的 ShowWindow/SetWindowPos 调用. 一般你会发现这两个 API 调用得太多了. 因此, 你可以指定你想关注的窗口句柄, 这样, 在这个窗口被显示/隐藏时, windbg 会停下来, 你就可以检查调用栈了. </p>


]]></content:encoded><pubDate>2009-12-10 13:53</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[xcode 分布式编译]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/12/09/4973893.aspx</link><content:encoded><![CDATA[

<p>看到 xcode 的设置里有一个 Distributed Builds. 今天晚上打算试试. 先 google. 找到了两片文章:</p>

<p>http://www.algorithm.com.au/blog/files/xcode-distributed-builds-performance.php</p>
<p>
<h3><span style="font-weight: normal;">Xcode Distributed Builds Performance</span></h3>
<p><span style="font-weight: normal;">
<h3><span style="font-weight: normal; font-size: 12px;">http://distcc.samba.org/faq.html</span></h3>
<p><span style="font-weight: normal; font-size: 12px;">
<h3><span style="font-weight: normal;">distcc frequently asked questions</span></h3>

<p>第一篇里提到, 分布式编译带来的好处不大.&nbsp;</p>
<p>第二篇有这么一句:</p>
<p>
<p>Apple's&nbsp;<a href="http://developer.apple.com/tools/xcode/">Xcode</a>&nbsp;development kit includes a fork of an old verison of distcc, plus Apple patches to locate machines using Rendezvous and a small GUI to configure it.</p>
<p>The source is available from&nbsp;<a href="http://www.opensource.apple.com/">opensource.apple.com</a>.</p>
</p>

<p>自己试了试, 找了三个机器打开了这个选项, 在其中一台上编译的时候, 发现分布式编译起作用了. 但速度一般. 可能是我的项目不够大. 在我测试第二个项目的时候出现问题. 编译不过. 说一个 progma 无效. 去掉分布式编译, 则没有问题.</p>

<p>看来 apple 用的这个旧版本的 distcc 还有些 bug 啊.</p>

</span></p>
</span></p>
</p>
]]></content:encoded><pubDate>2009-12-09 19:56</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[显示源码相关命令 lsa lsc lsp lsf]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/11/27/4885950.aspx</link><content:encoded><![CDATA[


<p>首先保证 .srcpath 设置正确</p>
<p>lsa address 列出 address 所在的代码块.<br />如果你觉得显示的不够多, 可以用 <br />lsp -a 30 <br />来设置 lsa 命令显示的行数.</p>
<p>lsc 列出当前显示的文件名和行号</p>
<p>lsf filename 加载特定的源文件, 但此命令不理会 srcpath, 所以你必须指定相对当前目录的路径或者绝对路径. 所以, 这个命令不太实用.</p>
]]></content:encoded><pubDate>2009-11-27 09:25</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[UniqueList excel]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/10/22/4713287.aspx</link><content:encoded><![CDATA[

<p>对 excel 表中的列作 unique 操作. 要求先排好序.</p>

<p>Sub UniqueList()<br />&nbsp;&nbsp;&nbsp; On Error Resume Next<br />&nbsp;&nbsp;&nbsp; For col = 65 To 65 + 23<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Range(Chr(col) &amp; "1", Range(Chr(col) &amp; "65536").End(xlUp)).AdvancedFilter Action:=xlFilterCopy, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Unique:=True, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CopyToRange:=Range("A" &amp; Chr(col) &amp; "1", "A" &amp; Chr(col) &amp; "1")<br />&nbsp;&nbsp;&nbsp; Next col<br />End Sub</p>
]]></content:encoded><pubDate>2009-10-22 14:41</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[邮件短信提醒 vba script for outlook]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/09/29/4616830.aspx</link><content:encoded><![CDATA[

<p>使用 sms.api.bz 这个短信网关. 要求先开通飞信. 填好 URL 中的各个参数.</p>
<p>在 outlook 中, 用 alt+f11 打开 vba 编辑器. 保持好如下脚本.</p>
<p>然后创建一条规则, 当特定邮件到达时执行这个脚本.</p>

<p><textarea cols="50" rows="15" name="code" class="vb">Sub SendSMS(Item As Outlook.MailItem)
    Dim msg
    Dim ret
    msg = URLEncode(Item.Subject)
    ret = GetDataFromURL("http://sms.api.bz/fetion.php?username=&amp;password=&amp;sendto=&amp;message=" &amp; msg, "GET", "")
End Sub



Public Function URLEncode(strURL)
Dim I
Dim tempStr
For I = 1 To Len(strURL)
    If Asc(Mid(strURL, I, 1)) &lt; 0 Then
       tempStr = "%" &amp; Right(CStr(Hex(Asc(Mid(strURL, I, 1)))), 2)
       tempStr = "%" &amp; Left(CStr(Hex(Asc(Mid(strURL, I, 1)))), Len(CStr(Hex(Asc(Mid(strURL, I, 1))))) - 2) &amp; tempStr
       URLEncode = URLEncode &amp; tempStr
    ElseIf (Asc(Mid(strURL, I, 1)) &gt;= 65 And Asc(Mid(strURL, I, 1)) &lt;= 90) Or (Asc(Mid(strURL, I, 1)) &gt;= 97 And Asc(Mid(strURL, I, 1)) &lt;= 122) Then
       URLEncode = URLEncode &amp; Mid(strURL, I, 1)
    Else
       URLEncode = URLEncode &amp; "%" &amp; Hex(Asc(Mid(strURL, I, 1)))
    End If
Next
End Function
 

Function GetDataFromURL(strURL, strMethod, strPostData)
  Dim lngTimeout
  Dim strUserAgentString
  Dim intSslErrorIgnoreFlags
  Dim blnEnableRedirects
  Dim blnEnableHttpsToHttpRedirects
  Dim strHostOverride
  Dim strLogin
  Dim strPassword
  Dim strResponseText
  Dim objWinHttp
  lngTimeout = 59000
  strUserAgentString = "http_requester/0.1"
  intSslErrorIgnoreFlags = 13056 ' 13056: ignore all err, 0: accept no err
  blnEnableRedirects = True
  blnEnableHttpsToHttpRedirects = True
  strHostOverride = ""
  strLogin = ""
  strPassword = ""
  Set objWinHttp = CreateObject("WinHttp.WinHttpRequest.5.1")
  objWinHttp.SetTimeouts lngTimeout, lngTimeout, lngTimeout, lngTimeout
  objWinHttp.Open strMethod, strURL
  If strMethod = "POST" Then
    objWinHttp.SetRequestHeader "Content-type", _
      "application/x-www-form-urlencoded"
  End If
  If strHostOverride &lt;&gt; "" Then
    objWinHttp.SetRequestHeader "Host", strHostOverride
  End If
  objWinHttp.Option(0) = strUserAgentString
  objWinHttp.Option(4) = intSslErrorIgnoreFlags
  objWinHttp.Option(6) = blnEnableRedirects
  objWinHttp.Option(12) = blnEnableHttpsToHttpRedirects
  If (strLogin &lt;&gt; "") And (strPassword &lt;&gt; "") Then
    objWinHttp.SetCredentials strLogin, strPassword, 0
  End If
  On Error Resume Next
  objWinHttp.Send (strPostData)
  If Err.Number = 0 Then
    If objWinHttp.Status = "200" Then
      GetDataFromURL = objWinHttp.ResponseText
    Else
      GetDataFromURL = "HTTP " &amp; objWinHttp.Status &amp; " " &amp; _
        objWinHttp.StatusText
    End If
  Else
    GetDataFromURL = "Error " &amp; Err.Number &amp; " " &amp; Err.Source &amp; " " &amp; _
      Err.Description
  End If
  On Error GoTo 0
  Set objWinHttp = Nothing
End Function
</textarea></p>

<p>由于安全性的问题, 还要给这个脚本签名.</p>
<p>在开始菜单中打开 vba 数字证书工具.&nbsp;</p>
<p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/arcoolgg/EntryImages/20090929/a.PNG" alt="" width="704" height="195" /></p>

<p>给自己创建一个证书.</p>
<p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/arcoolgg/EntryImages/20090929/b.PNG" alt="" /></p>

<p>打开 vba 编辑器, 如图选择,&nbsp;&nbsp;</p>
<p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/arcoolgg/EntryImages/20090929/d.PNG" alt="" width="179" height="168" /></p>

<p>&nbsp;指定刚才创建的证书.</p>

<p>&nbsp;<img src="http://p.blog.csdn.net/images/p_blog_csdn_net/arcoolgg/EntryImages/20090929/e.PNG" alt="" width="422" height="557" /></p>

<p>在 outlook 中打开 security... 对话框.</p>

<p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/arcoolgg/EntryImages/20090929/f.PNG" alt="" width="400" height="358" /></p>

<p>选择 安全级别为 "中".</p>
<p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/arcoolgg/EntryImages/20090929/g.PNG" alt="" width="384" height="373" /></p>

<p>重启 outlook, alt+f11 会提示如下对话框, 选择始终相信, 并且启用脚本:</p>
<p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/arcoolgg/EntryImages/20090929/10.PNG" alt="" width="506" height="300" /></p>

<p>现在应该好了. </p>
<p>CSDN 贴图还是麻烦.</p>
]]></content:encoded><pubDate>2009-09-29 13:16</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[kb 参数使用示例]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/09/07/4527484.aspx</link><content:encoded><![CDATA[

<h2 style="margin: 0in 0in 0pt;"><span style="color: #4f81bd; font-family: Cambria;"><span style="font-size: small; color: #000000;">[quoted from </span><a href="http://blogs.msdn.com/ntdebugging/archive/2009/09/02/push-locks-what-are-they.aspx"><span style="font-size: small;">http://blogs.msdn.com/ntdebugging/archive/2009/09/02/push-locks-what-are-they.aspx</span></a><span style="font-size: small; color: #000000;">]</span></span></h2>
<p style="margin: 0in 0in 0pt;">&nbsp;</p>
<h2 style="margin: 0in 0in 0pt;"><span style="font-size: medium; color: #4f81bd; font-family: Cambria;">What does a Pushlock look like?</span></h2>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">3: kd&gt; !thread 8c9764c0</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">THREAD 8c9764c0<span style="mso-spacerun: yes;">&nbsp; </span>Cid 2410.1be4<span style="mso-spacerun: yes;">&nbsp; </span>Teb: 7ff9f000 Win32Thread: e5c6f298 <strong style="mso-bidi-font-weight: normal;">GATEWAIT</strong></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">Stack Init b386b000 Current <strong style="mso-bidi-font-weight: normal;">b386a978</strong> Base b386b000 Limit b3867000 Call 0</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">ChildEBP RetAddr<span style="mso-spacerun: yes;">&nbsp; </span>Args to Child<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a990 80833485 8c9764c0 8c9764e4 00000003 nt!KiSwapContext+0x26 (FPO: [Uses EBP] [0,0,4])</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9bc 8082ffe0 b06a6a03 e11e0b18 b386aa54 nt!KiSwapThread+0x2e5 (FPO: [Non-Fpo]) (CONV: fastcall)</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9e4 8087d722 00000000 e11e0b08 e11e0b18 nt!<strong style="mso-bidi-font-weight: normal;">KeWaitForGate</strong>+0x152 (FPO: [Non-Fpo]) (CONV: fastcall)</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">e11e0b18 <strong style="mso-bidi-font-weight: normal;">00000000</strong> 0c050204 7346744e e37b2808 nt!<strong style="mso-bidi-font-weight: normal;">ExfAcquirePushLockExclusive</strong>+0x112 (FPO: [Non-Fpo]) (CONV: fastcall)</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: small; font-family: Calibri;">Above is a snipped output from a dump that I was recently looking at. From the stack, you can see the ExfAcquirePushLockExclusive call trying to acquire the pushlock, which then calls KEWaitForGate. In this case, the lock was already acquired, so this thread allocated a wait block on its stack, and then added itself to the waitlist. </span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: small; font-family: Calibri;">Also, the stack is broken due to the fastcall, therefore the debugger cannot display it entirely. So we can manually reconstruct the stack by passing parameters to the <em style="mso-bidi-font-style: normal;">kb</em> command.</span></p>
<p class="MsoQuote" style="margin: 0in 0in 0pt; text-align: center;" align="center"><em><span style="font-size: small;"><span style="font-family: Calibri;">k[b|p|P|v] = BasePtr StackPtr InstructionPtr</span></span></em></p>
<p class="MsoQuote" style="margin: 0in 0in 0pt; text-align: center;" align="center"><em><span style="font-size: small;"><span style="font-family: Calibri;"><span style="font-style: normal; mso-bidi-font-style: italic;"></span></span></span></em>&nbsp;</p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: small; font-family: Calibri;">To get the arguments, we first dump the stack manually using the <em style="mso-bidi-font-style: normal;">dps</em> command with the current <em style="mso-bidi-font-style: normal;">esp</em>.</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">3: kd&gt; dps b386a978 l50</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a978<span style="mso-spacerun: yes;">&nbsp; </span>b386ad40</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a97c<span style="mso-spacerun: yes;">&nbsp; </span>00000000</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a980<span style="mso-spacerun: yes;">&nbsp; </span>8088dafe nt!KiSwapContext+0x26</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a984<span style="mso-spacerun: yes;">&nbsp; </span>b386a9bc</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a988<span style="mso-spacerun: yes;">&nbsp; </span>b386aa00</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a98c<span style="mso-spacerun: yes;">&nbsp; </span>f773f120</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a990<span style="mso-spacerun: yes;">&nbsp; </span>8c9764c0</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a994<span style="mso-spacerun: yes;">&nbsp; </span>80833485 nt!KiSwapThread+0x2e5</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a998<span style="mso-spacerun: yes;">&nbsp; </span>8c9764c0</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a99c<span style="mso-spacerun: yes;">&nbsp; </span>8c9764e4</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9a0<span style="mso-spacerun: yes;">&nbsp; </span>00000003</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9a4<span style="mso-spacerun: yes;">&nbsp; </span>8c9764c0</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9a8<span style="mso-spacerun: yes;">&nbsp; </span>00000003</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9ac<span style="mso-spacerun: yes;">&nbsp; </span>00000002</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9b0<span style="mso-spacerun: yes;">&nbsp; </span>00000002</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9b4<span style="mso-spacerun: yes;">&nbsp; </span>f773fa7c</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9b8<span style="mso-spacerun: yes;">&nbsp; </span>008c0030</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9bc<span style="mso-spacerun: yes;">&nbsp; </span>b386a9e4</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9c0<span style="mso-spacerun: yes;">&nbsp; </span>8082ffe0 nt!KeWaitForGate+0x152</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9c4<span style="mso-spacerun: yes;">&nbsp; </span>b06a6a03</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9c8<span style="mso-spacerun: yes;">&nbsp; </span>e11e0b18</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9cc<span style="mso-spacerun: yes;">&nbsp; </span>b386aa54</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9d0<span style="mso-spacerun: yes;">&nbsp; </span>00000000</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9d4<span style="mso-spacerun: yes;">&nbsp; </span>8c976504</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9d8<span style="mso-spacerun: yes;">&nbsp; </span>00000000</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9dc<span style="mso-spacerun: yes;">&nbsp; </span>0000001c</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9e0<span style="mso-spacerun: yes;">&nbsp; </span>00000000</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-family: Calibri;"><strong style="mso-bidi-font-weight: normal;"><span style="font-size: 9pt; background: yellow; mso-highlight: yellow;">b386a9e4</span></strong><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&nbsp; </span><strong style="mso-bidi-font-weight: normal;"><span style="background: yellow; mso-highlight: yellow;">b386aa40</span></strong></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9e8<span style="mso-spacerun: yes;">&nbsp; </span><strong style="mso-bidi-font-weight: normal;"><span style="background: yellow; mso-highlight: yellow;">8087d722</span></strong> nt!ExfAcquirePushLockExclusive+0x112</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9ec<span style="mso-spacerun: yes;">&nbsp; </span>00000000</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9f0<span style="mso-spacerun: yes;">&nbsp; </span>e11e0b08</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9f4<span style="mso-spacerun: yes;">&nbsp; </span>e11e0b18</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9f8<span style="mso-spacerun: yes;">&nbsp; </span>b386aa40</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386a9fc<span style="mso-spacerun: yes;">&nbsp; </span>8096e9a9 nt!SeOpenObjectAuditAlarm+0x1cf</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa00<span style="mso-spacerun: yes;">&nbsp; </span>00040007</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa04<span style="mso-spacerun: yes;">&nbsp; </span>00000000</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa08<span style="mso-spacerun: yes;">&nbsp; </span>8c976568</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa0c<span style="mso-spacerun: yes;">&nbsp; </span>8c976568</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa10<span style="mso-spacerun: yes;">&nbsp; </span>b06a6a00</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa14<span style="mso-spacerun: yes;">&nbsp; </span>b4ee0a00</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa18<span style="mso-spacerun: yes;">&nbsp; </span>b127cc10</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa1c<span style="mso-spacerun: yes;">&nbsp; </span>00000000</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa20<span style="mso-spacerun: yes;">&nbsp; </span>00000001</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa24<span style="mso-spacerun: yes;">&nbsp; </span>80a60456 hal!KfLowerIrql+0x62</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa28<span style="mso-spacerun: yes;">&nbsp; </span>b386ac04</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa2c<span style="mso-spacerun: yes;">&nbsp; </span>8d117800</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa30<span style="mso-spacerun: yes;">&nbsp; </span>00000000</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa34<span style="mso-spacerun: yes;">&nbsp; </span>00000000</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa38<span style="mso-spacerun: yes;">&nbsp; </span>b386aa20</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa3c<span style="mso-spacerun: yes;">&nbsp; </span>01943080</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa40<span style="mso-spacerun: yes;">&nbsp; </span>b386aa64</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa44<span style="mso-spacerun: yes;">&nbsp; </span>808b7a14 nt!CmpCheckRecursionAndRecordThreadInfo+0x2a</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: small; font-family: Calibri;">From the output above, we can see the stack. To reconstruct the stack, we can get the ebp, esp, and eip from the stack for the ExfAcquirePushLockExclusive frame, and pass it to the <em style="mso-bidi-font-style: normal;">kb</em> command. Voila!</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: small; font-family: Calibri;">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">3: kd&gt; kb = b386aa40 b386a9e4 8087d722 </span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">ChildEBP RetAddr<span style="mso-spacerun: yes;">&nbsp; </span>Args to Child<span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa40 808b7a14 b386ac04 e11e0b18 e11e0b18 nt!ExfAcquirePushLockExclusive+0x112</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aa64 808b7b09 e11e0b18 b386aa80 e101bf40 nt!CmpCheckRecursionAndRecordThreadInfo+0x2a</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386aaa4 808da118 0000001c b386ab58 00000001 nt!CmpCallCallBacks+0x6b</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386ab90 80937942 e101bf40 00000000 89f13648 nt!CmpParseKey+0xd4</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386ac10 80933a76 00000000 b386ac50 00000040 nt!ObpLookupObjectName+0x5b0</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386ac64 808bb471 00000000 8e930480 00000d01 nt!ObOpenObjectByName+0xea</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386ad50 808897bc 0243eba0 00020019 0243eb68 nt!NtOpenKey+0x1ad</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">b386ad50 7c8285ec 0243eba0 00020019 0243eb68 nt!KiFastCallEntry+0xfc</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">WARNING: Frame IP not in any known module. Following frames may be wrong.</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 9pt;"><span style="font-family: Calibri;">0243eba4 00000000 00000000 00000000 00000000 0x7c8285ec</span></span></p>
]]></content:encoded><pubDate>2009-09-07 14:09</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[ida, ollydbg 使用 PDB. _NT_SYMBOL_PATH]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/08/20/4465488.aspx</link><content:encoded><![CDATA[

<p>ida 5.2 自带的加载 pdb 的功能有问题. 于是找到了这个:</p>
<p><a href="http://msmvps.com/blogs/v_scherbina/archive/2006/12/22/pdbext_5F00_v0_5F00_2.aspx">http://msmvps.com/blogs/v_scherbina/archive/2006/12/22/pdbext_5F00_v0_5F00_2.aspx</a></p>

<p>ollydbg 只会在当前目录找 pdb. 这里的帖子上讲了如何修改 ollydbg.exe 来 fix 这个问题:</p>
<p><a href="http://www.openrce.org/forums/posts/187">http://www.openrce.org/forums/posts/187</a></p>
<p>D:\odbg110&gt;fc /b ollydbg.exe ollydbgsym.exe<br />Comparing files OLLYDBG.EXE and OLLYDBGSYM.EXE<br />00090709: 10 37<br />0009070A: 12 02<br />0009070B: 00 03<br />0009070C: 00 80<br />000907EC: 74 EB</p>
]]></content:encoded><pubDate>2009-08-20 10:44</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[skip running a func using windbg]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/08/06/4417242.aspx</link><content:encoded><![CDATA[

<p><textarea cols="50" rows="15" name="code" class="c-sharp">.if (not(${/d:$arg1})) 
{
.echo usage:
.echo "  ${$arg0} func-name [arg-count]"
.echo "  if arg-count is omitted, 0 is the default value."
}
.else
{
.if (${/d:$arg2}) 
{ 
bp ${$arg1} "reip=poi(@esp); resp=@esp+ ${$arg2}*4+4;.echo #skip ${$arg1};g"
} 
.else
{
bp ${$arg1} "reip=poi(@esp); resp=@esp+4;.echo #skip ${$arg1};g"
}

bl
}</textarea></p>

<p>使用起来很简单. 把上面的代码另存为 skipfunc 到 windbg 的安装目录.</p>
<p>调试一个程序的时候, 用这样的命令来取消一个函数(比如 MessageBoxW) 的调用.</p>

<p>$$&gt;a&lt;skipfunc user32!messageboxw 4</p>

<p>第一个参数执行要 skip 的函数名, 第二个参数指定这个函数的参数个数. 如果没有指定, 则认为没有参数.</p>
]]></content:encoded><pubDate>2009-08-06 09:56</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Anatomy of a SWF File]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/08/02/4401181.aspx</link><content:encoded><![CDATA[

<p><a href="http://www.actionscript.org/resources/articles/728/1/Anatomy-of-a-SWF-File/Page1.html">http://www.actionscript.org/resources/articles/728/1/Anatomy-of-a-SWF-File/Page1.html</a></p>
]]></content:encoded><pubDate>2009-08-02 10:39</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[sysinternal 发布新工具 procdump]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/07/30/4395425.aspx</link><content:encoded><![CDATA[

<p>当一个程序 hang 或者长时间没有响应的时候， 可以自动创建 dump 文件。</p>

<p>check the following link for details.</p>
<p>&nbsp;<a href="http://technet.microsoft.com/en-us/sysinternals/dd996900.aspx">http://technet.microsoft.com/en-us/sysinternals/dd996900.aspx</a></p>
]]></content:encoded><pubDate>2009-07-30 21:12</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Create dump via taskmgr in XP]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/07/22/4370772.aspx</link><content:encoded><![CDATA[

<p>You can create a dump file in Taskmgr in Vista. now I'm gonna add this feature to Taskmgr in XP.</p>

<p>说一些细节.</p>
<p>. makedump.exe 用于创建 dump. 实现很简单. 只是调用了 MiniDumpWriteDump. </p>
<p>&nbsp; makedump.exe 可被单独使用. </p>

<p>. makedmp.dll 用于 hook taskmgr.exe</p>
<p>&nbsp; hook 一个 exe 有很多办法. 看看 核心编程 就知道. 我这里使用的 setdll.exe 更 taskmgr 增加 makedmp.dll 的依赖. </p>
<p>&nbsp; makedmp.dll 的实现参考了 codeproject 上的 TaskEx 项目. 实际上也就是做了大量的精简. 因为我的需求也很简单, 只是需要给 Process list 的右键菜单增加两个菜单项.</p>
<p>&nbsp; 为了避免修改 system32 下的 taskmgr.exe, 我将 taskmgr.exe 复制到安装目录的taskmgrex.exe, 用 setdll 修改了本地拷贝. 然后又修改了 IFEO 键值. 每次 taskmgr.exe 被启动时实际是执行了 taskmgrex.exe.</p>

<p>. 编译出来的文件很小. makedump.exe&nbsp;(6k), makedmp.dll (3k)</p>

<p><a href="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/EntryImages/20090722/makedump 2009-07-22 16.10'.png">下载</a>后改扩展名为 .rar, 解压运行 install.cmd&nbsp;即可. </p>
<p>---</p>
<p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/EntryImages/20090722/img.png" alt="" width="280" height="325" /><a href="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/EntryImages/20090722/img.png"></a></p>
]]></content:encoded><pubDate>2009-07-22 15:54</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[PDB Files: What Every Developer Must Know ]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/07/09/4333743.aspx</link><content:encoded><![CDATA[

<p><a href="http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/05/11/pdb-files-what-every-developer-must-know.aspx">http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/05/11/pdb-files-what-every-developer-must-know.aspx</a></p>
]]></content:encoded><pubDate>2009-07-09 11:56</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[查看 wininet 内部的 serverinfo cache]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2009/05/23/4210187.aspx</link><content:encoded><![CDATA[

<p>0:030&gt;as dx !list "-t ntdll!_LIST_ENTRY.Flink -e -x \"dpa poi(@$extret)+0n20 l1;dd poi(@$extret)+10 l1\" WININET!GlobalServerInfoList"</p>
<p>0:030&gt; dx<br />dpa poi(@$extret)+0n20 l1;dd poi(@$extret)+10 l1 <br />04141dcc&nbsp; 04779fb0 "<a href="http://www.flash.cn">www.flash.cn</a>"<br />04141dc8&nbsp; 00000001</p>
<p>dpa poi(@$extret)+0n20 l1;dd poi(@$extret)+10 l1 <br />0412f98c&nbsp; 047f72a8 "toolbarqueries.google.com"<br />0412f988&nbsp; 00000001</p>
<p>dpa poi(@$extret)+0n20 l1;dd poi(@$extret)+10 l1 <br />041427b4&nbsp; 047f3310 "<a href="http://www.hi-pda.com">www.hi-pda.com</a>"<br />041427b0&nbsp; 00000001</p>

<p>第一行是域名, 第二行是 ref count. 清 wininet dns cache 时, 需要清除这个 serverinfo cache</p>
]]></content:encoded><pubDate>2009-05-23 09:24</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[comments macro in vs2008]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2008/11/20/3340828.aspx</link><content:encoded><![CDATA[

<P>&nbsp;&nbsp;&nbsp; Sub AddCommentDateTime()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'DESCRIPTION: Add current date&amp;&amp;time as comment<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim nHour = DateAndTime.Now.Hour<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim strMinute = DateAndTime.Now.Minute</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If nHour &gt; 9 And nHour &lt; 16 And len(strMinute) = 1 Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strMinute = "0" + strMinute<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim str As String<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str = "/* nick " &amp; Right(CStr(Year(Now)), 2) &amp; "-" &amp; CStr(Month(Now)) &amp; "-" &amp; CStr(Day(Now)) &amp; " " _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp; CStr(nHour) &amp; ":" &amp; strMinute &amp; "&nbsp; */"</P>
<P><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim sel = CType(DTE.ActiveDocument.Selection(), EnvDTE.TextSelection)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sel.Text = str<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sel.WordLeft(False, 1)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sel.CharLeft(False, 1)</P>
<P>&nbsp;&nbsp;&nbsp; End Sub</P>
]]></content:encoded><pubDate>2008-11-20 14:39</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[XEP-0124: Bidirectional-streams Over Synchronous HTTP (BOSH)]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2008/11/04/3216998.aspx</link><content:encoded><![CDATA[

<P>XEP-0124: Bidirectional-streams Over Synchronous HTTP (BOSH)</P>
<P><A href="http://xmpp.org/extensions/xep-0124.html">http://xmpp.org/extensions/xep-0124.html</A></P>
<P>&nbsp;</P>
<P><SPAN class=ref><A href="http://xmpp.org/extensions/xep-0206.html"><U><FONT color=#0000ff>XMPP Over BOSH</FONT></U></A></SPAN></P>
<P><A href="http://xmpp.org/extensions/xep-0206.html">http://xmpp.org/extensions/xep-0206.html</A></P>
<P>&nbsp;</P>
<P><A class=l onmousedown="return clk(0,'','','res','5','')" href="http://xmpp.org/extensions/attic/jep-0124-0.9.html" target=_blank><U><FONT size=3><FONT color=#cc0033>JEP</FONT><FONT color=#0000cc>-</FONT><FONT color=#cc0033>0124</FONT><FONT color=#0000cc>: </FONT><FONT color=#cc0033>HTTP Binding</FONT></FONT></U></A><SPAN class="std nobr">&nbsp;</SPAN></P>
<P><SPAN class="std nobr"><FONT color=#008000><STRONG>xmpp</STRONG>.org/extensions/attic/<B>jep</B>-<B>0124</B>-0.9.html </FONT></SPAN></P>
]]></content:encoded><pubDate>2008-11-04 11:13</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[用 Adplus 自动获取 dump]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2008/09/11/2913184.aspx</link><content:encoded><![CDATA[

程序依然有些 crash. 在 UnhandledExceptionFilter 中写 dump 文件. 但有的 crash 还是没能生成 dump. 打算用 ADPlus 来生成, 让 qa 都安装 Windbg. 不过让 qa 每次运行程序还要再运行一下 adplus 还是麻烦. 所以考虑用 IFEO, 运行程序的同时自动加载 adplus.<div><br></div><div>写成了一个 inf 文件, 放到 windbg 所在目录, 右击/安装 即可:</div><div><br></div><div><div><div class="highlighter"><ol start="1" class="highlighter-c"><li><span>[Version]</span></li><li class="alt"><span>Signature=</span><span class="string">"$CHICAGO$"</span><span></span></li><li><span>Provider=nickx,2008</span></li><li class="alt"><span></span></li><li><span>[DefaultInstall]</span></li><li class="alt"><span>AddReg=conn_AddReg</span></li><li><span></span></li><li class="alt"><span>[conn_AddReg]</span></li><li><span>hklm,</span><span class="string">"%conn1_SMWCIc%"</span><span>,</span><span class="string">"debugger"</span><span>,,</span><span class="string">"cscript"</span><span class="string">"%01%\adplus.vbs"</span><span class="string">"-c"</span><span class="string">"%01%\adplus.cfg"</span><span class="string">"-CTCL-o"</span><span class="string">"%dump_folder%"</span><span class="string">"-lcv-NoDumpOnFirst-quiet-crash-sc"</span><span></span></li><li class="alt"><span></span></li><li><span>[Strings]</span></li><li class="alt"><span>conn1_SMWCIc=</span><span class="string">"SOFTWARE\Microsoft\WindowsNT\CurrentVersion\ImageFileExecutionOptions\yourprogram.exe"</span><span></span></li><li><span>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></li><li class="alt"><span>;;;SPECIFYDUMPFOLDERHERE</span></li><li><span>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span></li><li class="alt"><span>dump_folder=</span><span class="string">"c:\dumps"</span><span></span></li></ol></div>注意, 其中引用了一个 adplus.cfg:</div><div><br></div><div><div class="highlighter"><ol start="1" class="highlighter-xml"><li><span class="tag">&lt;</span><span class="tag-name">ADPlus</span><span class="tag">></span><span></span></li><li class="alt"><span></span><span class="tag">&lt;</span><span class="tag-name">PostCommands</span><span class="tag">></span><span></span></li><li><span></span><span class="tag">&lt;</span><span class="tag-name">Cmd</span><span class="tag">></span><span>sxi-c"gn;"ld</span><span class="tag">&lt;/</span><span class="tag-name">Cmd</span><span class="tag">></span><span></span></li><li class="alt"><span></span><span class="tag">&lt;</span><span class="tag-name">Cmd</span><span class="tag">></span><span>sxi-c".echo;.echoThisprocessisshuttingdown!;.echo;.time;~*kvn250;.echo;!runaway"epr</span><span class="tag">&lt;/</span><span class="tag-name">Cmd</span><span class="tag">></span><span></span></li><li><span></span><span class="tag">&lt;/</span><span class="tag-name">PostCommands</span><span class="tag">></span><span></span></li><li class="alt"><span></span><span class="tag">&lt;/</span><span class="tag-name">ADPlus</span><span class="tag">></span><span></span></li></ol></div>用于禁用在程序退出是生成 dump 的行为. 因为我只是需要记录 crash 时的 dump.</div><div><br></div><div>贴出来和大家共享.</div><div><br></div></div>
]]></content:encoded><pubDate>2008-09-11 13:45</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[实现 UnhandledExceptionFilter() 需要的几个问题]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/12/12/1931929.aspx</link><content:encoded><![CDATA[

dump file 是分析程序 crash 的利器, 在程序 crash 时写 dump 文件就是很自然的了. 而想要在程序 crash 的时候写 dump, 就不得不提 UnhandledExceptionFilter() 函数. 通过 API SetUnhandledExceptionFilter() 将自己写的 UnhandledExceptionFilter() 告诉操作系统, 系统在程序 crash 的时候就会调用这个函数. 用户在其中就可以完成想要的功能.<br /><br />首先要解决的是 UnhandledExceptionFilter() 被多次调用的问题. <br /><br />试想, 程序在一个线程中 crash, 执行 UnhandledExceptionFilter(), 在执行过程中, 另一个线程又出现 crash, 再次进入 UnhandledExceptionFilter() , 一般的这不是期望的结果. 所以, 在执行 UnhandledExceptionFilter() 时, 应该确保进程中所有其他的线程都被挂起. 就像当一个进程被调试器断点时, 被调试进程所有线程都被挂起一样. 似乎没有线程的 API 比如 SuspendAllThreads() 可以用, 但自己实现也很简单. 用 toolhelp 枚举所有线程, 逐个挂起即可, 注意不要把自己挂起.<br /><br />UnhandledExceptionFilter() 被多次执行的另一种情况是, 其他线程都挂起了, 出错的线程执行完 UnhandledExceptionFilter() 之后退出, 进程还需要做一些清理工作, 在这个时候再次 crash, 又一次执行 UnhandledExceptionFilter(). 我在 UnhandledExceptionFilter() 的开始处设了一个标志, 如果不是第一次执行, 则直接返回. <br /><br />另一个需要注意的是, 其他的 dll 有可能会调用 SetUnhandledExceptionFilter() 函数设置自己的异常处理函数. 如果发现有时候出现异常, 却没有 dump 文件, 可以先查看一下是不是被其他的 dll 替换了异常处理函数. 当然, 还有其他一些原因也会导致没有 dump 文件, 比如发生异常时调用栈等数据结构被严重破坏, 异常处理函数中又抛出未处理的异常等. <br /><br />&lt;未完待续&gt;<br />&nbsp;<br />参考文献:<br />http://www.microsoft.com/msj/0197/exception/exception.aspx<br />http://www.dumpanalysis.org/blog/index.php/2007/05/19/inside-vista-error-reporting-part-1/<br />http://eparg.spaces.live.com/blog/cns!59BFC22C0E7E1A76!2650.entry?wa=wsignin1.0
]]></content:encoded><pubDate>2007-12-12 19:42</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[移植代码到 DLL 时遇到的一个问题]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/09/02/1769612.aspx</link><content:encoded><![CDATA[

<p>有一个功能模块, 本来是写在主程序当中. 现在觉得有必要将它写成一个 DLL. 于是开始代码的移植. 费了好大的劲. 终于移植完成, 通过编译了. 这时运行程序, CRASH!<br />调试之, 发现是在一个 map 的赋值出现了问题.<br />看 vc6 自带的 STL 的代码: </p>
<p>map 的赋值操作, 也就是其中的树赋值操作.<br />_Myt&amp; operator=(const _Myt&amp; _X)<br />{<br />&nbsp;&nbsp;&nbsp; _Tr = _X._Tr;<br />&nbsp;&nbsp;&nbsp; return (*this);<br />}</p>
<p>树的赋值操作:<br />_Myt&amp; operator=(const _Myt&amp; _X)<br />{<br />&nbsp;&nbsp;&nbsp; if (this != &amp;_X)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; erase(begin(), end());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key_compare = _X.key_compare;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Copy(_X);<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; return (*this);<br />}<br />先删除自己, 然后调用 _Copy(const _Myt&amp;);</p>
<p>void _Copy(const _Myt&amp; _X)<br />{<br />&nbsp;&nbsp;&nbsp; _Root() = _Copy(_X._Root(), _Head);<br />&nbsp;&nbsp;&nbsp; _Size = _X.size();<br />&nbsp;&nbsp;&nbsp; if (_Root() != _Nil)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Lmost() = _Min(_Root());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Rmost() = _Max(_Root());<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Lmost() = _Head, _Rmost() = _Head;<br />}</p>
<p>其中又调用了 _Copy(_Nodeptr, _Nodeptr);</p>
<p>_Nodeptr _Copy(_Nodeptr _X, _Nodeptr _P)<br />{<br />&nbsp;&nbsp;&nbsp; _Nodeptr _R = _X;<br />&nbsp;&nbsp;&nbsp; for (; _X != _Nil; _X = _Left(_X))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // error here<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Nodeptr _Y = _Buynode(_P, _Color(_X));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_R == _X)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _R = _Y;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Right(_Y) = _Copy(_Right(_X), _Y);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Consval(&amp;_Value(_Y), _Value(_X));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Left(_P) = _Y;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _P = _Y;<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; _Left(_P) = _Nil;<br />&nbsp;&nbsp;&nbsp; return (_R);<br />}</p>
<p>看标记的那一行. _X 与 _Nil 比较. 其中的 _Nil 如下:<br />static _Tree&lt;_K, _Ty, _Kfn, _Pr, _A&gt;::_Nodeptr _Tree&lt;_K, _Ty, _Kfn, _Pr, _A&gt;::_Nil = 0;</p>
<p>是一个静态变量. 初始值为 0. 在一个 module (注: 这里的 module 是指的一个exe, 或者 dll. 下同) 中构建第一个 map 实例时, 有这样的代码:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_Nil == 0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {_Nil = _Buynode(0, _Black);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Left(_Nil) = 0, _Right(_Nil) = 0; }</p>
<p>如果 _Nil 未初始化则创建一个 node, 初始化 _Nil. 然后 map 将内部的 _Head._Parent 指向这个 _Nil.</p>
<p>设想这样一种情形. 一个 EXE, 一个 DLL. <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />EXE:<br />void main()<br />{<br />&nbsp;map m;<br />&nbsp;func(m);<br />}</p>
<p>DLL:<br />void func(map&amp; m)<br />{<br />&nbsp;map n = m;<br />}</p>
<p>在 EXE 中构建了一个 map 实例. 然后传到 DLL 中做赋值操作.<br />分析执行过程, 首先 EXE 中的 m 初始化, 完成之后 m._Head._Parent&nbsp; 指向了一个 _Nil 节点. 然后这个 m 传到 dll 中. 此时, n 进行初始化, 又执行这样的代码:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_Nil == 0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {_Nil = _Buynode(0, _Black);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Left(_Nil) = 0, _Right(_Nil) = 0; }</p>
<p>注意, 在 DLL 中, 这里的 _Nil 为 0. 因为这个 _Nil 和 EXE 中的 _Nil 并不是同一份拷贝. 因此又会创建一个 node, 然后让 _Nil 指向它. 再让 n._Head._Parent 指向这个 _Nil.<br />问题在这里开始出现了. map 的代码认为其所有的实例的 _Head._Parent 都指向同一个 _Nil. 但这里已经违背了这个原则.<br />最终的结果就是 crash. 在这个例子中, crash 出现在 _Copy(_Nodeptr, _Nodeptr) 函数中.&nbsp;</p>
<p><a href="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/map.png">下载示例源码</a>. (右击, 目标另存为.., 得到一 .png, 改名为 .rar) 如果要编译其中的代码. 比如使用 vc6, 可以执行 C:\Program Files\Microsoft Visual Studio\VC98\Bin\VCVARS32.BAT 然后在其中用命令行编译. </p>
]]></content:encoded><pubDate>2007-09-02 23:21</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Remove annoying AD window when PopKart exits]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/07/31/1720387.aspx</link><content:encoded><![CDATA[

<p>跑跑卡丁车退出的时候会弹出一个广告窗口. 从进程列表中可看出有一个&nbsp;AdBalloonExt.exe. 直接删除这个文件.&nbsp;卡丁车似乎不能运行.&nbsp;网上也有方法去掉这个. 原理就是不让它运行. 一般使用组策略. 不过我还是喜欢用 ifeo. 在注册表中加入简单的一项. 一劳永逸的解决这个问题.&nbsp;</p>
<p>注册表文件如下:</p>
<p>Windows Registry Editor Version 5.00</p>
<p>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\AdBalloonExt.exe]<br />&quot;debugger&quot;=&quot;c:\\windows\\system32\\conime.exe&quot;</p>
<p>&nbsp;也就是运行 AdBalloonExt 的时候偷梁换柱, 运行 conime. 而 conime 一运行就退出了. </p>
<a href="http://dl2.csdn.net/down4/20070731/31235500514.rar">点击下载</a>
]]></content:encoded><pubDate>2007-07-31 23:50</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Change Label of Taskbar Icons Show In Groups]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/07/18/1697485.aspx</link><content:encoded><![CDATA[

<p>xp 的一个新特性. taskbar icons show in groups. 任务栏图标分组显示. 不知大家注意到没有. 分组后图标的 label 有可能变化. 如图, IE 的 label 本来是 about:blank - Microsoft Internet Explorer. 分组之后显示的是 Internet Explorer. 前者很明白. 自然就是 window title. 那么后者呢? 手头有这么个问题. </p>
<p><img alt="" src="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/b.PNG" />_<img alt="" src="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/a.PNG" /></p>
<p>一开始就是满世界 google. 没有结果. 找到最多的就是教你如何禁用 balloon tooltip. 然后有试了试 spy++, 鼠标一放上去. 一大堆消息. 最多的就是 HITTEST. 也没有收获. 又想试试 windbg. 可惜无处下手啊. 想设断点都不知道该找那个 API. ShowToolTip()? 我想的太天真了. 最后. 我想到了一个办法. 写一个简单的程序. 把默认的字符串都带上标记. 比如 DemoProgram 的 Mainframe 就改成 DemoProgramMainFrame, AppTitle 就改成 DemoProgramAppTitle 等等. 改了之后编译. 没有变化? 奇怪. 折腾了一会儿. 又 rebuild all 了一把. 嗯, 变化了. 分组后的图标 label 变成了 DemoProgramFileDesc. 原来是版本信息中的文件描述. 又改成别的试了试. 嗯? 居然不变化了? 无奈, 搜索注册表. 哈哈. 被我找到了这么一个键值:</p>
<p>&nbsp;HKEY_CURRENT_USER\Software\Microsoft\Windows\ShellNoRoam\MUICache<br />&nbsp;<br />这个键下有这样的值/数据:<br />d:\demoprogram.exe=DemoProgramFileDesc</p>
<p>原来被资源管理器缓存了. 直接修改这个键值. 重启程序就可以看到生效了. <br />又试了试如果 FileDescription 如果为空会怎么样? 发现 Explorer 会用 exe 的文件名作为名称. </p>
<p>试了这么多办法. 还是土办法管用. 其实还可以试试著名的 Process Monitor. 不过在这个例子中可能也不能奏效. &nbsp;</p>
]]></content:encoded><pubDate>2007-07-18 20:27</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[windbg 的一个小应用]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/07/13/1688669.aspx</link><content:encoded><![CDATA[

<p>&nbsp;公司的新机器居然有兼容性问题. 有时候会莫名其妙的重启. 没有蓝屏. 直接黑屏重启. 有些郁闷. 找找原因吧. 看能不能解决. </p>
<p>&nbsp;到 eventvwr 里面看看. 嗯. 有一条 savedump 的记录. 有收获啊. minidump 写到了 c:\windows\minidump 下.&nbsp;</p>
<p><br />&nbsp;<img alt="" src="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/2.PNG" /><br />&nbsp;用 windbg 打开这个 crash dump. 如同. 找到肇事者了. Rtenicxp.sys</p>
<p><img alt="" src="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/3.PNG" /><br />&nbsp;<br />&nbsp;在网上一搜. 发现是我的 Rtl 网卡. 我开始还怀疑是显卡的问题. 看来错怪它了. 本来可以上网搜索网卡的最新驱动的. 但我喜欢用 Everest. </p>
<p><img alt="" src="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/1.PNG" /><br />&nbsp;<br />&nbsp;直接点击那个链接. 运气好的话能到最新驱动下载的页面. 就算再不济, 也能带你到厂商的主页. 来一个站内搜索: 8168. 运气不错. 2007.7.3 刚刚有的更新. 下载之, 100 多 K. 不错. 很喜欢这种只带 sys 的驱动程序包. 讨厌那种安装包. 太大了. 至少几M, 我还见过几百M的. shit.<br />&nbsp;<br />&nbsp;应该差不多了. 很简单吧. 下次遇到机器死机的时候, 可以看看有没有 kernal minidump 哦. <br />&nbsp;<br />&nbsp;&quot;用 windbg, 就算是傻瓜, 也能找到错误的原因&quot;&nbsp;</p>
]]></content:encoded><pubDate>2007-07-13 16:52</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[从 TSVN 到 TCVS]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/07/11/1685750.aspx</link><content:encoded><![CDATA[

<p>以前一直用 svn, 到了新公司, 用 cvs. 客户端用的是 eclipse, 仅仅使用其作为 cvs 客户端的功能. 因为我们的代码是 c++ 的. </p>
<p>用惯了 TortoiseSVN, 既然让用 cvs, 那我就试试 TortoiseCVS 把. 一家公司出的. 据说使用体验也差不多. 使用了两周时间了. 有些经验和大家分享. </p>
<p>. 图标没有 TSVN 好看. <br />&nbsp;这个好办. 把 TSVN 的图标复制到 TCVS 下, 改一下文件名, 再修改一下设置. 就好了.</p>
<p><br />&nbsp;<img alt="" src="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/4.PNG" /><br />. 不刷新文件夹状态. <br />&nbsp;当这个文件夹下包含修改时, cvs 不把这个文件夹的图标变成已修改的. 这个其实有选项的. 如图. 改成第三项就和 svn 一样的了. 但是有个问题. 如果 cvs 的服务端不在局域网内. 刷新图标的会比较慢. 看你能不能忍受了. 我现在改成了第二项. 效率能好一点.&nbsp;</p>
<p><br />&nbsp;<img alt="" src="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/7.PNG" /><br />. 没有 diff 工具. <br />&nbsp;这个帮助里有说明. 自己去下载一个 windiff, 感觉不错. 不比 TSVN 带的那个差. 甚至更好. <br />&nbsp;<br />. 没有专门的对话框显示当前文件夹下已修改的文件列表. <br />&nbsp;这个在 TSVN 里是有的. 到了 TCVS 下没有了. 不过可以变通一下. 在当前目录选择 commit.., 看到没有. 已修改的文件列表处理了把. 双击也可以 diff, 右键菜单里的功能挺多的. 甚至把 shell 菜单都集成进去了. 不错.<br />&nbsp;</p>
<p><img alt="" src="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/8.PNG" /><br />. 没有 revert. <br />&nbsp;帮助上说了. 可以用 update special.., 记得选中那个 clean copy 选项. 或者删除再更新. faint. 官方都这么建议, 那为啥不做一个 revert?<br />&nbsp;<br />. Lock/unlock<br />&nbsp;CVS 下的叫法不一样. 它叫做 Edit/Unedit. 一个字: 怪. 一般不怎么用. 所以影响不大. 第一次使用的时候我还以为 UnEdit 就是 Revert. 一点, 好家伙. 所有的图标都变了. 吓了我一跳<br />&nbsp;<br />就这些了. 以后再有再补充把. 希望对你有用. <br />&nbsp;</p>
]]></content:encoded><pubDate>2007-07-11 21:03</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[使用 Boost]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/06/03/1636644.aspx</link><content:encoded><![CDATA[

<p>现在的程序中用 STL 还是比较常见的.&nbsp;用 STL 一个比较不爽的地方就是要写 functor.&nbsp;在这个时候往往就希望 C++ 支持匿名函数. 也知道 boost 里有神奇的 lambda 库. 但一直觉得 boost 的安装比较麻烦. 所以也一直没有尝试.&nbsp;</p>
<p>直到最近, 终于想通了. 常常觉得 java 一个很好的地方就是他有很多支持库.&nbsp;其实 boost 也就是最好的 c++ 支持库啊. 如果因为安装麻烦而不用. 那不是有点因噎废食了? 所以我决定安装它.&nbsp;Boost 1.34 刚刚出来. 网上找到的安装过程一般都是针对 1.33&nbsp;的. 不过过程也差不多. 只是 1.34 里似乎不建议自己编译 bjam, 而是去下载编译好的版本. 有了 bjam 后, 直接运行之就可以开始编译 boost 了.&nbsp;我用的是 vs2005, 所以编译器问题不大.&nbsp;&nbsp;有人说全部编译花了 3 小时. 我不知道花了多长时间(应该不到 3 小时), 但编译后的 lib 占了 2G 空间. 似乎没有提示什么错误. 试着编译了一些例子程序. 通过. 顺便说一下, bjam 用的是命令行编译的方式. 所以环境变量要设置好. 可以使用开始菜单中的那个 &quot;Visual Studio 2005 Command Prompt&quot;, 在其中执行 bjam. 但我更倾向于把这些环境变量写到注册表中. 这样设置之后, 配合 scite, 写一些小的例子程序, 编译/运行还是非常方便的. 我把这些环境变量整理了一下. 从这里下载: <a href="http://nicoster.googlepages.com/vsvars32.bat">http://nicoster.googlepages.com/vsvars32.bat</a>&nbsp; 这个 bat 文件假定 vs2005 默认安装目录. 里面用到的 setx, 是 xp support tools 带的一个工具. 可以从这里下载: <a href="http://nicoster.googlepages.com/setx.rar">http://nicoster.googlepages.com/setx.rar</a><br /></p>
<p>首先是试了试 lambda, 看了看 boost 自带的 doc, 简单的 lambda 表达式还是比较容易的. 然后在网上发现了 beyond the C++ : an intruduction to boost. 国内的几个站点有下载. 但下载不了. 后来还是求助于 filedonkey.com, 用 emule 下载到了. 正在看.传到我的 googlepages 上. 大家可以下载: <a href="http://nicoster.googlepages.com/boost_chm.rar">http://nicoster.googlepages.com/boost_chm.rar</a></p>
<p>感觉 C++ 程序员还是很有必要看看 boost 的. 不是说非要去看他的实现. 但至少用法应该知道. </p>
<p>另外, 请教大家一个问题. boost 编译之后 lib 那么多层目录. 有什么好办法可以引用到这些 lib 文件? 逐个加到 lib 环境变量似乎不太现实. </p>

]]></content:encoded><pubDate>2007-06-03 20:11</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[New ListCtrl Sorting Algorithm in XP]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/04/28/1588540.aspx</link><content:encoded><![CDATA[

<p><span lang="EN-US" style="FONT-SIZE: 10.5pt; FONT-FAMILY: &quot;Calibri&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA">Sorting items more naturally in ListCtrl, like XP does. Adding a single line into your program to enable this cool feature.</span>&nbsp;</p>
<p>在 CodeProject 写的第二篇帖子. 这次很快就发表了. </p>
<p><span lang="EN-US" style="FONT-SIZE: 10.5pt; FONT-FAMILY: &quot;Calibri&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><a href="http://www.codeproject.com/cpp/ListCtrlSort.asp">http://www.codeproject.com/cpp/ListCtrlSort.asp</a></span></p>
<p><span lang="EN-US" style="FONT-SIZE: 10.5pt; FONT-FAMILY: &quot;Calibri&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA">提供了几个很实用的类. 在你需要用 CListView, CListCtrl 的时候直接替换成 ListViewSort, ListCtrlSort, 那么, 你的的 ListCtrl 就自动拥有了排序的功能, 而且排序的效果和 XP 一致哦. 绝对值得一试.</span></p>
<p><span lang="EN-US" style="FONT-SIZE: 10.5pt; FONT-FAMILY: &quot;Calibri&quot;,&quot;sans-serif&quot;; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'Times New Roman'; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA">WTL 也可以用!</span></p>
]]></content:encoded><pubDate>2007-04-28 13:18</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[freecap 推荐]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/04/19/1570242.aspx</link><content:encoded><![CDATA[

<p>freecap 推荐</p>
<p>sockscap 想必大家都知道. 让一个不支持代理的程序支持 socks 代理. 而 freecap 是升级版. 有一下几个优势:</p>
<p>1. 不仅支持 socks4/5 代理. 还可以使用 http 代理. 使用更广泛 <br />2. 支持命令行. 使用更自然. 比如我可以创建这样一个 vncviewer 的快捷方式:<br />&nbsp;D:\freecap\freecapconw.exe -b d:\freecap -f d:\freecap\freecap.xml&nbsp; &quot;C:\Program Files\RealVNC\VNC4\vncviewer.exe&quot;<br />&nbsp;这样就不用每次先启动 sockscap 程序, 然后点击其中的快捷方式启动 vncviewer 了.<br />3. 免费. 提供源码. 不过是 delphi 的.</p>
<p>命令行中用到了一个 freecap.xml 配置文件, 可以使用起 GUI 来设置, 导出即可.</p>
<p>缺点:<br />不支持 windows 服务, 我本打算把 winvnc4 服务改一下, 成这样:<br />sc create winvnc4cap binpath= &quot;\&quot;%ProgramFiles%\RealVNC\VNC4\freecapcon.exe\&quot; -b \&quot;%ProgramFiles%\RealVNC\VNC4\&quot; -f \&quot;%ProgramFiles%\RealVNC\VNC4\freecap.xml\&quot; \&quot;%ProgramFiles%\RealVNC\VNC4\winvnc4.exe\&quot; -service&quot; </p>
<p>提示服务启动失败. 想想也是, freecapcon 并不满足 scm 那些要求. <br />然后又想到 Image File Execution Option. 加上一个 winvnc4.exe 键, 创建一个值 debugger:<br />&nbsp;d:\freecap\freecapconw.exe -b d:\freecap -f d:\freecap\freecap.xml <br />&nbsp;<br />net start winvnc4, winvnc4 没出来. 倒是除了一大堆的 freecapcon. </p>
<p>先放弃了. <br />如果哪位有办法, 一定要告诉我哦. <br />另外, 如果哪位熟悉 delphi, 可以调试调试.<br /></p>

]]></content:encoded><pubDate>2007-04-19 11:12</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[MessageBalloon - an enhanced MessageBox]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/04/17/1568379.aspx</link><content:encoded><![CDATA[

<p>codeproject 发表了. 所以大家还是去 codeproject 上看吧</p>
<p><a href="http://www.codeproject.com/dialog/MessageBalloon.asp">http://www.codeproject.com/dialog/MessageBalloon.asp</a></p>
]]></content:encoded><pubDate>2007-04-17 22:37</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[自己创建 minidump]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/04/05/1553027.aspx</link><content:encoded><![CDATA[

<p><br />以前曾写过一个 bugslayer.dll 的介绍. 在程序出错时将调用栈写到文件. 觉得不错. 后来开始用 windbg. 知道了 userdump. 知道了如何调试 dump... 才知道程序崩溃的时候写 dump 文件其实可以获取比调用栈多得多的信息.&nbsp; </p>
<p>如果你的程序什么都不干. 那么在程序出错的时候. drwtsn32.exe 会写一个 userdump. 但 drwtsn32 有些缺点. 比如只能写一个 dump 文件. 后面的崩溃写 dump 文件时会覆盖前面的. win2000 下的 drwtsn32 只能写旧式的 dump 文件(往往尺寸比较大). 有一篇文章论述的比较清楚:<br />&nbsp;<a href="http://www.debuginfo.com/articles/ntsdwatson.html">http://www.debuginfo.com/articles/ntsdwatson.html</a></p>
<p>建议使用 ntsd 代替 drwtsn32. 但 ntsd 的缺点就是需要安装最新的 windbg. 这是一个硬伤. 在看了 debuginfo.com 的另一篇文章:<br />&nbsp;<a href="http://www.debuginfo.com/articles/effminidumps.html">http://www.debuginfo.com/articles/effminidumps.html</a><br />&nbsp;<br />之后, 我选择的是在程序出错的时候调用 api 自己写 minidump. 克服了 drwtsn32, ntsd 的缺点. <br />将封装好的函数放到了一个头文件中, 包含即可. 使用的方法很简单:</p>
<p>#include &lt;windows.h&gt;<br />#include &quot;minidump.h&quot;<br />LONG __stdcall MyUnhandledExceptionFilter(PEXCEPTION_POINTERS pExceptionInfo)<br />{<br />&nbsp;CreateMiniDump(pExceptionInfo, &quot;c:\\user.dmp&quot;);<br />&nbsp;return EXCEPTION_EXECUTE_HANDLER;<br />}</p>
<p>void main()<br />{<br />&nbsp;SetUnhandledExceptionFilter(MyUnhandledExceptionFilter);<br />&nbsp;*(int*)0=0;&nbsp;// AV<br />}</p>
<p>这样就好了. 注意安装至少 xp 以上的 sdk.<br />这里用到了一个 api SetUnhandledExceptionFilter(), 如果不明白可以搜一下 msdn.<br />运行例子程序出错退出之后, 就得到了 c:\\user.dmp. 可以用 windbg 等调试器来分析了. &nbsp;</p>
<p>代码从这里下载 <a href="http://nicoster.googlepages.com/minidump.rar">http://nicoster.googlepages.com/minidump.rar</a></p>
]]></content:encoded><pubDate>2007-04-05 15:49</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[将 svn 版本修订号写入程序版本信息]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/04/04/1551427.aspx</link><content:encoded><![CDATA[

<p><font face="Courier New">tsvn 带有一个命令行程序 subwcrev.exe. 可以对一个指定文件进行一些宏替换, 比如: 将 $WCREV$ 替换成当前版本号. 这个是最有用的. 详细帮助见 &nbsp;<br />&nbsp;</font><a href="http://tortoisesvn.net/docs/nightly/TortoiseSVN_zh_CN/tsvn-subwcrev-keywords.html"><font face="Courier New">http://tortoisesvn.net/docs/nightly/TortoiseSVN_zh_CN/tsvn-subwcrev-keywords.html</font></a><br /><font face="Courier New">以 vc6 为例, 文件的版本信息保存在 rc 文件. 编译成 res 文件, 然后和其他 obj 一起 link. 现在的思路就是. 编辑 rc 文件, 将版本号比如 2.2.4.0 改成 2.2.4.$WCREV$, 在每次 link 之前, 先用 subwcrev.exe 处理 rc 文件, 进行宏替换. 然后调用 rc.exe 编译替换后的新文件. 生成 res 之后一起 link. </font></p>
<p><font face="Courier New">. 修改 rc 文件的 versioninfo 段成如下:<br />&nbsp;#ifdef _AUTOVERSION<br />&nbsp; FILEVERSION 2,2,4,$WCREV$<br />&nbsp; PRODUCTVERSION 2,2,4,$WCREV$<br />&nbsp;#else<br />&nbsp; FILEVERSION 2,2,4,0<br />&nbsp; PRODUCTVERSION 2,2,4,0<br />&nbsp;#endif<br />&nbsp;...<br />&nbsp;#ifdef _AUTOVERSION<br />&nbsp;&nbsp;&nbsp;&nbsp;VALUE &quot;FileVersion&quot;, &quot;2, 2, 4, $WCREV$\0&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;VALUE &quot;ProductVersion&quot;, &quot;2, 2, 4, $WCREV$\0&quot;<br />&nbsp;#else<br />&nbsp;&nbsp;&nbsp;&nbsp;VALUE &quot;FileVersion&quot;, &quot;2, 2, 4, 0\0&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;VALUE &quot;ProductVersion&quot;, &quot;2, 2, 4, 0\0&quot;<br />&nbsp;#endif&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></p>
<p><font face="Courier New">其实也就是加上了条件编译. 默认情况下没有定义 _AUTOVERSION, 则使用原来的 fileversion, productversion. 如果定义了 _AUTOVERSION, 则使用新的版本信息. </font></p>
<p><font face="Courier New">. 在项目属性找到 pre-link 页. 在其中增加:<br />subwcrev\subwcrev.exe . myprogram.rc myprogram.rc_ <br />rc.exe /l 0x804 /fo&quot;\release\myprogram.res&quot; /d &quot;_AUTOVERSION&quot; /d &quot;_AFXDLL&quot; &quot;myprogram.rc_&quot;</font></p>
<p><font face="Courier New">第一条命令处理 myprogram.rc , 生成 myprogram.rc_<br />第二条命令编译 myprogram.rc_ 为 myprogram.res, 注意它的路径. 这里是 release 版的默认路径.&nbsp; 原则就是这里生成的 res 替换原来的 res 文件. </font></p>
<p><font face="Courier New">按 f7, build. 现在版本信息已经刷新了. 每次向 svn 提交. 版本都会更新. </font></p>
<p><font face="Courier New">不过我们还可以更进一步. 将版本信息, 编译时间等写入到关于对话框中. 其实关键还是 pre-link. <br />. 创建一个文件 buildtime.cpp, 内容如下:<br />&nbsp;const char*szBuildTime = &quot;Build on $WCNOW$&quot;; <br />&nbsp;const char*szFullVersion=&quot;MyProgram 2.2.4.$WCREV$$WCMODS?+:$$WCMIXED?#:$&quot;;</font></p>
<p><font face="Courier New">. 在关于对话框 OnInitDialog() 中加入:<br />&nbsp;extern const char* szBuildTime;<br />&nbsp;extern const char* szFullVersion;<br />&nbsp;SetDlgItemText(IDC_BUILDTIME, szBuildTime);<br />&nbsp;SetDlgItemText(IDC_VERSION, szFullVersion);</font></p>
<p><font face="Courier New">. 在 pre-link 再加上两条:<br />&nbsp;subwcrev\subwcrev.exe . buildtime.cpp buildtime_.cpp<br />&nbsp;cl /c /nologo /Fo\Release\buildtime.obj /MT buildTime_.cpp</font></p>
<p><font face="Courier New">原理和 rc 文件一样. 先替换, 后编译. 同样要保证生成的 buildtime.obj 覆盖原来的 buildtime.obj</font></p>
<p><font face="Courier New">大功告成. <br />不过有一点要注意. vc6 的资源编辑器在每次编辑资源之后都重新生成 rc 文件. 也就是说, 会删除我们对 rc 的修改. 还没有找到好的办法, 现在只能是每次编辑资源之后再手工添加一下条件编译的部分. 建议在项目进入 beta 之后再加上版本信息. 因为这个时候程序的资源一般都不会变动了.</font></p>
<p><font face="Courier New">另外, 虽然这里是以 vc6 为例, 但也可以应用到 vc2003, vc2005 等编译环境. </font></p>
<p><font face="Courier New">后记: 还可以考虑用程序自动修改. 找到 FILEVERSION, 将后面的版本替换成 FILEVERSION 2,2,4,$WCREV$, 然后再用 subwcrev 替换. 再用 rc 编译. 这样还不用定义 _AUTOVERSION 宏.&nbsp; <br /></font></p>
<p><font face="Courier New"></font></p>
<p><font face="Courier New"></font></p>
<p><font face="Courier New"></font></p>
<p><br /><font face="Courier New">&nbsp;</font></p>
]]></content:encoded><pubDate>2007-04-04 10:30</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[TimerWnd 类的一个 bug]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/03/08/1524497.aspx</link><content:encoded><![CDATA[

<p>今天准备修改一下服务器程序关于 socket, 线程这一块的代码. 将 CObjectThread 的一个成员 m_pPCLayer 变成了父类. 发现程序在 TimerWnd 的代码出现问题. <br />分析发现, TimerWnd 在 PCLayer 和 CCAMThread 中被使用. 代码改完之后, 程序会先创建 PCLayer 的 3 个 TimerWnd 的实例. 之后又创建 CCAMThread 的一个 TimerWnd 实例. 但是, CCAMThread 的实例却调用了 PCLayer 的 TimerWnd 的 WndProc. 导致出错. 调试的大部分时间其实被用来得出这些结论. </p>
<p>有了这些, 后面的工作就好做了. 原来是 CCAMThread 创建 TimerWnd 窗口之前, 先注册窗口类. 但是注册失败了. 使用了 PCLayer 注册的窗口类创建了窗口. 自然, 调用的是 PCLayer 的 WndProc. TimerWnd 的设计之初的想法是, 反正 RegisterClass 函数在第二次注册时会失败. 没有多加考虑. 当一个程序中有两个不同的类继承了 TimerWnd, 今天这样的问题就出现了. 因为以前的程序一般都只有一个类使用了 TimerWnd, 所以问题一直没有发现. </p>
<p>最后一个问题是, 为什么修改代码之前服务器能正常运行呢? 现在就是体现 SVN&nbsp; 的优势的时候了. 改代码之前我已经将代码做了一个 branch, 修改的是 branch 的代码. 现在我从 svn 上取服务器的主干代码到另一个工作拷贝. 编译, 加断点, 调试. 很快就得到了一个令人瞠目结舌的答案. 原来在服务器中 PCLayer 的定时器一直没有用过! 由于 PCLayer 中的定时器是一个冗余容错的设计. 不执行一般也不会有问题. 所以问题一直没有暴露. </p>
<p>由于使用模版的缘故, 使得 TimerWnd 如果被多个类使用, 则需要注册不同的窗口类. 在这里. 模版就不是那么的合适了. 使用虚函数则不会有这样的问题: 即使被多个类使用. 也只需要一个窗口类, 一个 WndProc, 只是调用不同的子类中的 OnTimer 即可. &nbsp;</p>
]]></content:encoded><pubDate>2007-03-08 17:22</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Trace CallStack when App Crashes (程序崩溃时导出调用栈) ---- BugSlayerUtil.dll 的使用]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/01/15/1483657.aspx</link><content:encoded><![CDATA[

<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana"><font size="2">以前写的一个例子, 现在才放上来..</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana"><font size="2"></font></span>&nbsp;</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">程序出错时</span><span lang="EN-US" style="FONT-FAMILY: Verdana">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">调用</span><span lang="EN-US" style="FONT-FAMILY: Verdana">BugSlayerUtil.dll </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">中的函数将调用栈</span><span lang="EN-US" style="FONT-FAMILY: Verdana">(callstack) </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">写入文件</span><span lang="EN-US" style="FONT-FAMILY: Verdana">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">用来调试程序</span><span lang="EN-US" style="FONT-FAMILY: Verdana">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">事半功倍</span><span lang="EN-US" style="FONT-FAMILY: Verdana">.<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-FAMILY: Verdana"><o:p><font size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">首先要做的是让程序带有调试信息</span><span lang="EN-US" style="FONT-FAMILY: Verdana">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">以</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> vc6 IDE </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">为例</span><span lang="EN-US" style="FONT-FAMILY: Verdana">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">打开项目属性</span><span lang="EN-US" style="FONT-FAMILY: Verdana">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">切换到所有配置</span><span lang="EN-US" style="FONT-FAMILY: Verdana">(All Configurations), </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">然后</span><span lang="EN-US" style="FONT-FAMILY: Verdana">C/C++</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">属性页下的</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> General </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">类</span><span lang="EN-US" style="FONT-FAMILY: Verdana">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">将</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> Debug info </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">改成</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> Program Database.<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-FAMILY: Verdana"><font size="2"><v:shapetype id="_x0000_t75" stroked="f" filled="f" path="m@4@5l@4@11@9@11@9@5xe" o:preferrelative="t" o:spt="75" coordsize="21600,21600"><v:stroke joinstyle="miter"></v:stroke><v:formulas><v:f eqn="if lineDrawn pixelLineWidth 0"></v:f><v:f eqn="sum @0 1 0"></v:f><v:f eqn="sum 0 0 @1"></v:f><v:f eqn="prod @2 1 2"></v:f><v:f eqn="prod @3 21600 pixelWidth"></v:f><v:f eqn="prod @3 21600 pixelHeight"></v:f><v:f eqn="sum @0 0 1"></v:f><v:f eqn="prod @6 1 2"></v:f><v:f eqn="prod @7 21600 pixelWidth"></v:f><v:f eqn="sum @8 21600 0"></v:f><v:f eqn="prod @7 21600 pixelHeight"></v:f><v:f eqn="sum @10 21600 0"></v:f></v:formulas><v:path o:connecttype="rect" gradientshapeok="t" o:extrusionok="f"></v:path><o:lock aspectratio="t" v:ext="edit"></o:lock></v:shapetype><v:shape id="_x0000_i1025" style="WIDTH: 432.75pt; HEIGHT: 280.5pt" type="#_x0000_t75"><v:imagedata o:title="" src="file:///D:\nico\LOCALS~1\Temp\msohtml1\05\clip_image001.png"></v:imagedata></v:shape><o:p></o:p></font></span></p>
<span lang="EN-US" style="FONT-SIZE: 10.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt; mso-fareast-font-family: 宋体; mso-font-kerning: 1.0pt; mso-bidi-font-family: 'Times New Roman'; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><br style="PAGE-BREAK-BEFORE: always" clear="all" /></span>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">然后切换到</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> Link </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">页</span><span lang="EN-US" style="FONT-FAMILY: Verdana">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">选择</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> Debug </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">类</span><span lang="EN-US" style="FONT-FAMILY: Verdana">,</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">选中</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> Debug Info, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">并选中</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> Microsoft format.<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-FAMILY: Verdana"><font size="2"><v:shape id="_x0000_i1026" style="WIDTH: 432.75pt; HEIGHT: 280.5pt" type="#_x0000_t75"><v:imagedata o:title="" src="file:///D:\nico\LOCALS~1\Temp\msohtml1\05\clip_image003.png"></v:imagedata></v:shape><o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-FAMILY: Verdana"><o:p><font size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">将附带的</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> include </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">目录复制到你的硬盘中</span><span lang="EN-US" style="FONT-FAMILY: Verdana">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">比如</span><span lang="EN-US" style="FONT-FAMILY: Verdana">d:\include, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">在如图的</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> Directories </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">中指定这个目录</span><span lang="EN-US" style="FONT-FAMILY: Verdana">.<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><v:shape id="_x0000_s1026" style="MARGIN-TOP: 6pt; Z-INDEX: 1; LEFT: 0px; MARGIN-LEFT: 3.6pt; WIDTH: 312.75pt; POSITION: absolute; HEIGHT: 240.75pt; TEXT-ALIGN: left" type="#_x0000_t75"><font size="2"><v:imagedata o:title="" src="file:///D:\nico\LOCALS~1\Temp\msohtml1\05\clip_image005.png"></v:imagedata><w:wrap type="square" side="right"></w:wrap></font></v:shape><span lang="EN-US" style="FONT-FAMILY: Verdana"><br style="mso-special-character: line-break" clear="all" /><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-FAMILY: Verdana"><o:p><font size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">最简单的做法就是包含</span><span lang="EN-US" style="FONT-FAMILY: Verdana">UnhandledExceptionFilter.h, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">然后把其中的</span><span lang="EN-US" style="FONT-FAMILY: Verdana">CUnhandledExceptionFilter </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">类作为</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> app </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">类的父类</span><span lang="EN-US" style="FONT-FAMILY: Verdana">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">就像附带的</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> TestBugslayer </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">项目一样</span><span lang="EN-US" style="FONT-FAMILY: Verdana">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">类</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> CUnhandledExceptionFilter </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">会在构造的时候调用</span><span lang="EN-US" style="FONT-FAMILY: Verdana">SetUnhandledExceptionFilter(). </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">如果你有自己的</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> UnhandledExceptionFilter </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">函数</span><span lang="EN-US" style="FONT-FAMILY: Verdana">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">则不要从</span><span lang="EN-US" style="FONT-FAMILY: Verdana">CUnhandledExceptionFilter </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">派生</span><span lang="EN-US" style="FONT-FAMILY: Verdana">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">可以在自己的</span><span lang="EN-US" style="FONT-FAMILY: Verdana">UnhandledExceptionFilter </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">函数中调用</span><span lang="EN-US" style="FONT-FAMILY: Verdana">CUnhandledExceptionFilter::GetCrashInfoString() </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">静态函数</span><span lang="EN-US" style="FONT-FAMILY: Verdana">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">该函数将返回包括调用栈在内的丰富调试信息的一个字符串</span><span lang="EN-US" style="FONT-FAMILY: Verdana">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">你需要做的只是把这个字符串写入文件即可</span><span lang="EN-US" style="FONT-FAMILY: Verdana">.<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">当然</span><span lang="EN-US" style="FONT-FAMILY: Verdana">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">你的程序能通过编译连接还需要</span><span lang="EN-US" style="FONT-FAMILY: Verdana">BugslayerUtil.lib </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">文件</span><span lang="EN-US" style="FONT-FAMILY: Verdana">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">你可以简单的将这个文件复制到你的源文件目录中</span><span lang="EN-US" style="FONT-FAMILY: Verdana">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">另外</span><span lang="EN-US" style="FONT-FAMILY: Verdana">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">要运行你的程序需要</span><span lang="EN-US" style="FONT-FAMILY: Verdana">BugslayerUtil.dll </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">文件</span><span lang="EN-US" style="FONT-FAMILY: Verdana">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">确保它在你的项目生成</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> exe </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">的目录中</span><span lang="EN-US" style="FONT-FAMILY: Verdana">.<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-FAMILY: Verdana"><o:p><font size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="2"><span style="COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">注意</span><span lang="EN-US" style="COLOR: blue; FONT-FAMILY: Verdana">: </span><span style="COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">由于</span><span lang="EN-US" style="COLOR: blue; FONT-FAMILY: Verdana"> release </span><span style="COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">版本中用到的系统</span><span lang="EN-US" style="COLOR: blue; FONT-FAMILY: Verdana"> dll </span><span style="COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">不带调试信息</span><span lang="EN-US" style="COLOR: blue; FONT-FAMILY: Verdana">, release </span><span style="COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">版本的程序导出的调用栈信息会较</span><span lang="EN-US" style="COLOR: blue; FONT-FAMILY: Verdana"> debug </span><span style="COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">版程序少一些</span><span lang="EN-US" style="COLOR: blue; FONT-FAMILY: Verdana">. </span><span style="COLOR: blue; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">但关键的出错行还是会有的</span><span lang="EN-US" style="COLOR: blue; FONT-FAMILY: Verdana">. 另外, 发布程序时需要带上编译时生成 pdb 文件</span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-FAMILY: Verdana"><o:p><font size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><strong style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 14pt; FONT-FAMILY: 黑体; mso-hansi-font-family: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">附录<span lang="EN-US">:<o:p></o:p></span></font></span></strong></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><strong style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-SIZE: 14pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">Appendix:<o:p></o:p></font></span></strong></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-FAMILY: Verdana"><o:p><font size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><strong style="mso-bidi-font-weight: normal"><span lang="EN-US" style="FONT-FAMILY: Verdana"><font size="2">Where does BugslayerUtil.dll come from?<o:p></o:p></font></span></strong></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="2"><span lang="EN-US" style="FONT-FAMILY: Verdana">BugslayerUtil.dll </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">来自</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> John Robbins </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">的</span><span lang="EN-US" style="FONT-FAMILY: Verdana"> Bugslayer</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">专栏</span><span lang="EN-US" style="FONT-FAMILY: Verdana">. John </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">将每次专栏中写的工具都放到了</span><span lang="EN-US" style="FONT-FAMILY: Verdana">BugslayerUtil.dll. <o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-FAMILY: Verdana"><font size="2">http://www.microsoft.com/msj/0898/bugslayer0898.aspx<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-FAMILY: Verdana"><o:p><font size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">调用栈的信息如下形式</span><span lang="EN-US" style="FONT-FAMILY: Verdana">:<o:p></o:p></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-FAMILY: Verdana"><o:p><font size="2">&nbsp;</font></o:p></span></p>
<div style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; mso-element: para-border-div; mso-border-bottom-alt: solid windowtext .75pt">
<p class="MsoNormal" style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 0cm; MARGIN: 0cm 0cm 0pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: medium none; mso-border-bottom-alt: solid windowtext .75pt; mso-padding-alt: 0cm 0cm 1.0pt 0cm"><font size="2"><span lang="EN-US" style="FONT-FAMILY: Verdana">DEBUG </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">版程序</span><span lang="EN-US" style="FONT-FAMILY: Verdana">:<o:p></o:p></span></font></p>
</div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-FAMILY: Verdana"><o:p><font size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">RnmsAdaptorD.exe caused a EXCEPTION_ACCESS_VIOLATION in module MSVCRTD.dll at 001B:10218207, memset()+71 byte(s), intel\memset.asm, line 115<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">EAX=00000000<span style="mso-spacerun: yes">&nbsp; </span>EBX=000504E2<span style="mso-spacerun: yes">&nbsp; </span>ECX=00000000<span style="mso-spacerun: yes">&nbsp; </span>EDX=00000001<span style="mso-spacerun: yes">&nbsp; </span>ESI=5F4335C0<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">EDI=00000000<span style="mso-spacerun: yes">&nbsp; </span>EBP=0013EF04<span style="mso-spacerun: yes">&nbsp; </span>ESP=0013EEC4<span style="mso-spacerun: yes">&nbsp; </span>EIP=10218207<span style="mso-spacerun: yes">&nbsp; </span>FLG=00010293<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">CS=001B<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>DS=0023<span style="mso-spacerun: yes">&nbsp; </span>SS=0023<span style="mso-spacerun: yes">&nbsp; </span>ES=0023<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>FS=003B<span style="mso-spacerun: yes">&nbsp; </span>GS=0000<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:10218207 (0x00000000 0x00000000 0x00000001 0x5F4335C0) MSVCRTD.dll, memset()+71 byte(s), intel\memset.asm, line 115<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:00410383 (0x0013F624 0x0013EF3C 0x77D48734 0x00060434) RnmsAdaptorD.exe, CAboutDlg::OnInitDialog()+76 byte(s), D:\mss3000\v220\RnmsAdaptor\RnmsAdaptorDlg.cpp, line 546+11 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F4335FB (0x00060434 0x00000110 0x000504E2 0x00000000) MFC42D.DLL, AfxDlgProc()+59 byte(s), dlgcore.cpp, line 35+14 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D48734 (0x5F4335C0 0x00060434 0x00000110 0x000504E2) USER32.dll, GetDC()+109 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D545E4 (0x00000000 0x5F4335C0 0x00060434 0x00000110) USER32.dll, DefDlgProcW()+1026 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D53FD9 (0x00000000 0x00000110 0x000504E2 0x00000000) USER32.dll, PrivateExtractIconExW()+254 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D6E571 (0x00060434 0x00000110 0x000504E2 0x00000000) USER32.dll, DefDlgProcA()+34 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D48734 (0x77D6E54F 0x00060434 0x00000110 0x000504E2) USER32.dll, GetDC()+109 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D48816 (0x00000000 0x77D6E54F 0x00060434 0x00000110) USER32.dll, GetDC()+335 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D4C63F (0x77D6E54F 0x00060434 0x00000110 0x000504E2) USER32.dll, IsWindowUnicode()+161 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D4E905 (0x77D6E54F 0x00060434 0x00000110 0x000504E2) USER32.dll, CallWindowProcA()+27 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F42DF36 (0x00000110 0x000504E2 0x00000000 0x0013F624) MFC42D.DLL, CWnd::DefWindowProcA()+50 byte(s), wincore.cpp, line 1000+32 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F42C8CB (0x0013F624 0x5F495541 0x5F4CFE48 0x00000000) MFC42D.DLL, CWnd::Default()+57 byte(s), wincore.cpp, line 249<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F434816 (0x000504E2 0x00000000 0x0013F2CC 0x00155060) MFC42D.DLL, CDialog::HandleInitDialog()+173 byte(s), dlgcore.cpp, line 621+8 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F42F2AC (0x00000110 0x000504E2 0x00000000 0x0013F268) MFC42D.DLL, CWnd::OnWndMsg()+1690 byte(s), wincore.cpp, line 1815+17 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F42EBE8 (0x00000110 0x000504E2 0x00000000 0x0013F3A4) MFC42D.DLL, CWnd::WindowProc()+46 byte(s), wincore.cpp, line 1585+30 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F42C789 (0x0013F624 0x00060434 0x00000110 0x000504E2) MFC42D.DLL, AfxCallWndProc()+237 byte(s), wincore.cpp, line 215+26 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F42CC25 (0x00060434 0x00000110 0x000504E2 0x00000000) MFC42D.DLL, AfxWndProc()+129 byte(s), wincore.cpp, line 368<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F49049D (0x00060434 0x00000110 0x000504E2 0x00000000) MFC42D.DLL, AfxWndProcBase()+74 byte(s), afxstate.cpp, line 220+21 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D48734 (0x5F490453 0x00060434 0x00000110 0x000504E2) USER32.dll, GetDC()+109 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D48816 (0x00000000 0x5F490453 0x00060434 0x00000110) USER32.dll, GetDC()+335 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D4B89B (0x00691700 0x0068B778 0x000504E2 0x00000000) USER32.dll, GetParent()+364 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D54E28 (0x00000000 0x00691700 0x00000194 0x00060434) USER32.dll, GetWindowTextLengthW()+1351 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D5514C (0x00400000 0x00428278 0x000A0422 0x5F4335C0) USER32.dll, CreateDialogIndirectParamAorW()+51 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D69B1B (0x00400000 0x00428278 0x000A0422 0x5F4335C0) USER32.dll, CreateDialogIndirectParamA()+27 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F433F17 (0x00428278 0x0013FBA4 0x00400000 0x0013F684) MFC42D.DLL, CWnd::CreateDlgIndirect()+662 byte(s), dlgcore.cpp, line 327+36 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F434552 (0x0013F930 0x0013FBA4 0x0041D684 0x00000001) MFC42D.DLL, CDialog::DoModal()+324 byte(s), dlgcore.cpp, line 528+32 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:0040FF5A (0x0013F930 0x00155060 0x00000000 0x0000000A) RnmsAdaptorD.exe, CRnmsAdaptorDlg::OnHelpAbout()+71 byte(s), D:\mss3000\v220\RnmsAdaptor\RnmsAdaptorDlg.cpp, line 428<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F4373FC (0x0013FBA4 0x00008004 0x00000000 0x00401311) MFC42D.DLL, _AfxDispatchCmdMsg()+162 byte(s), cmdtarg.cpp, line 88<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F437B2B (0x00008004 0x00000000 0x00000000 0x00000000) MFC42D.DLL, CCmdTarget::OnCmdMsg()+628 byte(s), cmdtarg.cpp, line 302+39 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F43374B (0x00008004 0x00000000 0x00000000 0x00000000) MFC42D.DLL, CDialog::OnCmdMsg()+36 byte(s), dlgcore.cpp, line 97+24 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F42FA63 (0x00008004 0x00000000 0x0013F930 0x00155060) MFC42D.DLL, CWnd::OnCommand()+312 byte(s), wincore.cpp, line 2088<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F42EC65 (0x00000111 0x00008004 0x00000000 0x0013F8CC) MFC42D.DLL, CWnd::OnWndMsg()+83 byte(s), wincore.cpp, line 1597+28 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F42EBE8 (0x00000111 0x00008004 0x00000000 0x0013FA08) MFC42D.DLL, CWnd::WindowProc()+46 byte(s), wincore.cpp, line 1585+30 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F42C789 (0x0013FBA4 0x000A0422 0x00000111 0x00008004) MFC42D.DLL, AfxCallWndProc()+237 byte(s), wincore.cpp, line 215+26 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F42CC25 (0x000A0422 0x00000111 0x00008004 0x00000000) MFC42D.DLL, AfxWndProc()+129 byte(s), wincore.cpp, line 368<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F49049D (0x000A0422 0x00000111 0x00008004 0x00000000) MFC42D.DLL, AfxWndProcBase()+74 byte(s), afxstate.cpp, line 220+21 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D48734 (0x5F490453 0x000A0422 0x00000111 0x00008004) USER32.dll, GetDC()+109 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D48816 (0x00000000 0x5F490453 0x000A0422 0x00000111) USER32.dll, GetDC()+335 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D489CD (0x00424A68 0x00000001 0x0013FAC0 0x5F4396C8) USER32.dll, GetWindowLongW()+295 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D496C7 (0x00424A68 0x0013FEDC 0x0013FB64 0x7FFDE000) USER32.dll, DispatchMessageA()+15 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F4396C8 (0x0013FEDC 0x0013FB64 0x7FFDE000 0x00424A30) MFC42D.DLL, CWinThread::PumpMessage()+256 byte(s), thrdcore.cpp, line 846<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F43219F (0x00000004 0x0013FEDC 0x0013FB64 0x7FFDE000) MFC42D.DLL, CWnd::RunModalLoop()+514 byte(s), wincore.cpp, line 3478+19 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F43459F (0x7C903804 0x0013E3EC 0x0013FB90 0x0013FB90) MFC42D.DLL, CDialog::DoModal()+401 byte(s), dlgcore.cpp, line 536+12 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:00403FC4 (0x7C903804 0x0013E3EC 0x7FFDE000 0x00424A30) RnmsAdaptorD.exe, CRnmsAdaptorApp::InitInstance()+1038 byte(s), D:\mss3000\v220\RnmsAdaptor\RnmsAdaptor.cpp, line 205+11 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:5F433523 (0x00400000 0x00000000 0x001523A1 0x00000001) MFC42D.DLL, AfxWinMain()+131 byte(s), winmain.cpp, line 39+11 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:00418AF8 (0x00400000 0x00000000 0x001523A1 0x00000001) RnmsAdaptorD.exe, WinMain()+24 byte(s), appmodul.cpp, line 30<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:00418513 (0x7C903804 0x0013E3EC 0x7FFDE000 0x8054A6ED) RnmsAdaptorD.exe, WinMainCRTStartup()+435 byte(s), crtexe.c, line 330+54 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:7C816FD7 (0x00418360 0x00000000 0x78746341 0x00000020) kernel32.dll, RegisterWaitForInputIdle()+73 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<div style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; mso-element: para-border-div; mso-border-bottom-alt: solid windowtext .75pt">
<p class="MsoNormal" style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 0cm; MARGIN: 0cm 0cm 0pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: medium none; mso-border-bottom-alt: solid windowtext .75pt; mso-padding-alt: 0cm 0cm 1.0pt 0cm"><font size="2"><span lang="EN-US" style="FONT-FAMILY: Verdana">RELEASE </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">版程序</span><span lang="EN-US" style="FONT-FAMILY: Verdana">:<o:p></o:p></span></font></p>
</div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US" style="FONT-FAMILY: Verdana"><o:p><font size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">RnmsAdaptor.exe caused a EXCEPTION_ACCESS_VIOLATION in module RnmsAdaptor.exe at 001B:00407C74, CAboutDlg::OnInitDialog()+36 byte(s), D:\mss3000\v220\RnmsAdaptor\RnmsAdaptorDlg.cpp, line 546+2 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">EAX=00000000<span style="mso-spacerun: yes">&nbsp; </span>EBX=0013F7CC<span style="mso-spacerun: yes">&nbsp; </span>ECX=00000000<span style="mso-spacerun: yes">&nbsp; </span>EDX=7FFEFFFF<span style="mso-spacerun: yes">&nbsp; </span>ESI=73DD6745<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">EDI=00000000<span style="mso-spacerun: yes">&nbsp; </span>EBP=0013F20C<span style="mso-spacerun: yes">&nbsp; </span>ESP=0013F1BC<span style="mso-spacerun: yes">&nbsp; </span>EIP=00407C74<span style="mso-spacerun: yes">&nbsp; </span>FLG=00010246<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">CS=001B<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>DS=0023<span style="mso-spacerun: yes">&nbsp; </span>SS=0023<span style="mso-spacerun: yes">&nbsp; </span>ES=0023<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>FS=003B<span style="mso-spacerun: yes">&nbsp; </span>GS=0000<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:00407C74 (0x77D48734 0x0011045C 0x00000110 0x002E04FC) RnmsAdaptor.exe, CAboutDlg::OnInitDialog()+36 byte(s), D:\mss3000\v220\RnmsAdaptor\RnmsAdaptorDlg.cpp, line 546+2 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD6773 (0x73DD6745 0x0011045C 0x00000110 0x002E04FC) MFC42.DLL, Ordinal1130()+46 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D545E4 (0x00000000 0x73DD6745 0x0011045C 0x00000110) USER32.dll, DefDlgProcW()+1026 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D53FD9 (0x00000000 0x00000110 0x002E04FC 0x00000000) USER32.dll, PrivateExtractIconExW()+254 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D6E571 (0x0011045C 0x00000110 0x002E04FC 0x00000000) USER32.dll, DefDlgProcA()+34 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D48734 (0x77D6E54F 0x0011045C 0x00000110 0x002E04FC) USER32.dll, GetDC()+109 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D48816 (0x00000000 0x77D6E54F 0x0011045C 0x00000110) USER32.dll, GetDC()+335 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D4C63F (0x77D6E54F 0x0011045C 0x00000110 0x002E04FC) USER32.dll, IsWindowUnicode()+161 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D4E905 (0x77D6E54F 0x0011045C 0x00000110 0x002E04FC) USER32.dll, CallWindowProcA()+27 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD216B (0x00000110 0x002E04FC 0x00000000 0x0013F7CC) MFC42.DLL, Ordinal2385()+68 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD21EC (0x00000110 0x002E04FC 0x73E7B0E8 0x0013F49C) MFC42.DLL, Ordinal2379()+39 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD1B9B (0x00000110 0x002E04FC 0x00000000 0x0013F5B4) MFC42.DLL, Ordinal6374()+36 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD1B05 (0x0013F7CC 0x84C800C4 0x00000110 0x002E04FC) MFC42.DLL, Ordinal1109()+145 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD1A58 (0x0011045C 0x00000110 0x002E04FC 0x00000000) MFC42.DLL, Ordinal1578()+54 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73E6847D (0x0011045C 0x00000110 0x002E04FC 0x00000000) MFC42.DLL, Ordinal1579()+57 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D48734 (0x73E68444 0x0011045C 0x00000110 0x002E04FC) USER32.dll, GetDC()+109 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D48816 (0x00000000 0x73E68444 0x0011045C 0x00000110) USER32.dll, GetDC()+335 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D4B89B (0x0062CC10 0x00629BF0 0x002E04FC 0x00000000) USER32.dll, GetParent()+364 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D54E28 (0x00000000 0x0062CC10 0x00000194 0x0011045C) USER32.dll, GetWindowTextLengthW()+1351 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D5514C (0x00400000 0x004140E8 0x0029054A 0x73DD6745) USER32.dll, CreateDialogIndirectParamAorW()+51 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D69B1B (0x00400000 0x004140E8 0x0029054A 0x73DD6745) USER32.dll, CreateDialogIndirectParamA()+27 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DDF11E (0x004140E8 0x0013FBDC 0x00400000 0x0013FBDC) MFC42.DLL, Ordinal2147()+373 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DE6A08 (0x0040D9C0 0x00000001 0x00000000 0x00000000) MFC42.DLL, Ordinal2514()+194 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:004078B2 (0x0040D7C0 0x00000111 0x0013F874 0x73DD23BF) RnmsAdaptor.exe, CRnmsAdaptorDlg::OnHelpAbout()+50 byte(s), D:\mss3000\v220\RnmsAdaptor\RnmsAdaptorDlg.cpp, line 428<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD24C0 (0x0013FBDC 0x00008004 0x00000000 0x00407880) MFC42.DLL, Ordinal567()+171 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD23BF (0x00008004 0x00000000 0x00000000 0x00000000) MFC42.DLL, Ordinal4424()+266 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73E3DEAD (0x00008004 0x00000000 0x00000000 0x00000000) MFC42.DLL, Ordinal4431()+29 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD3244 (0x00000000 0x00000000 0x0013FBDC 0x0013FBDC) MFC42.DLL, Ordinal4441()+83 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD1BF1 (0x00000111 0x00008004 0x00000000 0x0013F984) MFC42.DLL, Ordinal5163()+47 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD1B9B (0x00000111 0x00008004 0x00000000 0x0013FA9C) MFC42.DLL, Ordinal6374()+36 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD1B05 (0x0013FBDC 0x00000000 0x00000111 0x00008004) MFC42.DLL, Ordinal1109()+145 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD1A58 (0x0029054A 0x00000111 0x00008004 0x00000000) MFC42.DLL, Ordinal1578()+54 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73E6847D (0x0029054A 0x00000111 0x00008004 0x00000000) MFC42.DLL, Ordinal1579()+57 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D48734 (0x73E68444 0x0029054A 0x00000111 0x00008004) USER32.dll, GetDC()+109 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D48816 (0x00000000 0x73E68444 0x0029054A 0x00000111) USER32.dll, GetDC()+335 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D489CD (0x00412844 0x00000001 0x00412844 0x73DD125A) USER32.dll, GetWindowLongW()+295 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:77D496C7 (0x00412844 0x00000000 0x0013FBDC 0x73DE6B99) USER32.dll, DispatchMessageA()+15 byte(s)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><o:p><font size="2"></font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; LAYOUT-GRID-MODE: char; mso-line-height-alt: 7.0pt; mso-layout-grid-align: none"><span lang="EN-US" style="FONT-SIZE: 7.5pt; FONT-FAMILY: Verdana; mso-bidi-font-size: 12.0pt"><font size="2">001B:73DD125A (0x00008004 0x00000000 0x009068FE 0x0000014D) MFC42.DLL, Ordinal5307()+60 byte(s)<o:p></o:p></font></span></p>
<p><font size="2">&nbsp;</font></p>
<p><font size="2">googlepages 最近不能用. 找个 ftp 先放上代码和带插图的 doc 版本</font></p>
<p><a href="ftp://222.90.231.60/doc/unhandle.rar"><font size="2">ftp://222.90.231.60/doc/unhandle.rar</font></a></p>
<font face="Verdana" color="#0000ff" size="2"></font>
]]></content:encoded><pubDate>2007-01-15 16:15</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[通讯过程中连包分包问题的解决]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2007/01/03/1472969.aspx</link><content:encoded><![CDATA[

<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 黑体"><font face="楷体"><font size="2">博主按: 本来是打算发到什么期刊上面骗点稿费的. 所以, 虽然东西很简单, 但写到很详细. 可是我发过去. 就象石沉大海一般. 连一个确认的 mail 都没有. 郁闷. 还是发表在自己的 blog 上吧. 呵呵. 在这里我说了算. 这里插入图片比较麻烦. 所以, 想要看代插图的完整版, 请下载 doc 文件:</font></font></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 黑体"><font face="楷体"><font size="2"><a href="http://nicoster.googlepages.com/packetextractor.rar">http://nicoster.googlepages.com/packetextractor.rar</a></font></font></span></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font size="3"><span style="FONT-FAMILY: 黑体"></span></font>&nbsp;</p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 黑体">摘要</span> <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">通讯协议的处理过程中往往要处理连包</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">分包的问题</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">本文实现了一个轻巧的</span><span lang="EN-US"> PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">类</span><span lang="EN-US"> , </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">运用分层的思想</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结合模板</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">虚函数等技巧</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">让用户只需要简单的派生自己的类</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">重载</span><span lang="EN-US"> 4 </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">个方法</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">即可轻松完成拆包组包的任务</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">给通讯过程中的连包问题提供了一个普适的解决方案</span><span lang="EN-US">.</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 黑体">关键字</span> <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">通讯</span> <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">协议</span> <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">连包</span> <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">粘包</span> <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">分包</span> <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">组包</span> <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">虚函数</span> <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">模板 PacketExtractor </span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<h1 style="MARGIN: 17pt 0cm 16.5pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font face="Courier New" size="2">引言</font></span></h1>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">所谓连包</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">分包问题</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">比如说</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">根据通讯协议</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">发送了两条命令</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">第一条命令</span><span lang="EN-US"> 80 </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">字节</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">第二条命令</span><span lang="EN-US"> 120 </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">字节</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">但接受方收到数据的时候</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">可能第一次收到</span><span lang="EN-US"> 150 </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">个字节</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">第二次收到</span><span lang="EN-US"> 50 </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">个字节</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">要正确理解发送方的命令包</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">接受方必须根据协议正确的从第一包数据中取出前</span><span lang="EN-US"> 80 </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">个字节</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">作为一条命令</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">再把剩下的</span><span lang="EN-US"> 70 </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">个字节和第二包的数据组合成第二条命令</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这个问题如此常见</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">以致于实现一个可以复用的</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">轻量级的解析器就变得很有必要</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">于是就有了这个</span><span lang="EN-US"> PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">类</span><span lang="EN-US">. PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">用</span><span lang="EN-US"> C++<span style="mso-spacerun: yes">&nbsp; </span></span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">实现</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">运用分层的思想</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">结合模板</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">虚函数等技术</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">让使用者只需要重载几个函数</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">就可以完美的解决在通讯过程中的拆包</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">组包的问题</span><span lang="EN-US">. </span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<h1 style="MARGIN: 17pt 0cm 16.5pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font face="Courier New" size="2">设计思路</font></span></h1>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US">PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的算法其实很朴素</span><span lang="EN-US">. </span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在收到一包数据之后</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">先查找包头特征字</span><span lang="EN-US">(</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">比如</span><span lang="EN-US"> 7e), </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">一般的</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">协议中都有一个包长字段</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">将包头作为包的起始字节</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">找到包长</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果收到的包还不够包长指定的长度</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">则将包放到一个缓冲区</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">等下一包数据到的时候</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">将这次的半包附加到收到数据前面</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">递归调用处理函数</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果收到的数据已经够一包的长度了</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">则根据协议取出校验字段</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">对包进行校验</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果通过</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">则证明是一个合法包</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">交给上层处理</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果校验失败</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">则可能是传输中出现查错</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">更多的情况是找到的包头</span><span lang="EN-US">(7e) </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">并不是真正的包头</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">也许是包中间的数据</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这个时候</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在这个</span><span lang="EN-US"> 7e </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">之后继续查找包头</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">找到之后继续之前的步骤</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">流程图如下</span><span lang="EN-US">:</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: center" align="center"><span lang="EN-US"><font face="Courier New"><font size="2"><v:shapetype id="_x0000_t75" stroked="f" filled="f" path="m@4@5l@4@11@9@11@9@5xe" o:preferrelative="t" o:spt="75" coordsize="21600,21600"><v:stroke joinstyle="miter"></v:stroke><v:formulas><v:f eqn="if lineDrawn pixelLineWidth 0"></v:f><v:f eqn="sum @0 1 0"></v:f><v:f eqn="sum 0 0 @1"></v:f><v:f eqn="prod @2 1 2"></v:f><v:f eqn="prod @3 21600 pixelWidth"></v:f><v:f eqn="prod @3 21600 pixelHeight"></v:f><v:f eqn="sum @0 0 1"></v:f><v:f eqn="prod @6 1 2"></v:f><v:f eqn="prod @7 21600 pixelWidth"></v:f><v:f eqn="sum @8 21600 0"></v:f><v:f eqn="prod @7 21600 pixelHeight"></v:f><v:f eqn="sum @10 21600 0"></v:f></v:formulas><v:path o:connecttype="rect" gradientshapeok="t" o:extrusionok="f"></v:path><o:lock aspectratio="t" v:ext="edit"></o:lock></v:shapetype><v:shape id="_x0000_i1025" style="WIDTH: 257.25pt; HEIGHT: 336pt" o:ole="" type="#_x0000_t75"><v:imagedata o:title="" src="file:///D:\temp\msohtml1\01\clip_image001.emz"></v:imagedata></v:shape></font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: center" align="center"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font face="Courier New" size="2">数据处理流程图</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<h1 style="MARGIN: 17pt 0cm 16.5pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font face="Courier New" size="2">实现细节</font></span></h1>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">有了设计思路，</span> <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">具体实现就简单了。以下是类的主要成员函数以及变量：</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">template &lt;DWORD MAX_PACKET, DWORD MIN_PACKET&gt;</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">class PacketExtractor</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">{</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">核心函数</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">从底层接受数据</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">拆包组包</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">校验合法之后交给上层处理</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>virtual void OnRawDataReceived(const BYTE byBuf[], DWORD dwLen);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// return zero-based position of header in the packet .</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果没有找到包头</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">那么返回</span><span lang="EN-US"> dwLen </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的值</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>virtual UINT LocatePacketHeader(const BYTE byBuf[], DWORD dwLen);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">由收到的包获取这个包的协议包长</span><span lang="EN-US">.</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>virtual UINT ExtractPacketLength(const BYTE byBuf[], DWORD dwLen);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><span style="mso-tab-count: 1"><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">是否一个有效的包</span><span lang="EN-US">.</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">可以在派生类中定义</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>virtual BOOL IsPacketValid(const BYTE [], DWORD);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><span style="mso-tab-count: 1"><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/* </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">收到一个合法有效的包时调用这个函数</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">交给上层处理</span><span lang="EN-US"> */</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>virtual void OnPacketReceived(const BYTE byBuf[], DWORD dwLen) = 0;</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">}</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">其中</span><span lang="EN-US">, OnRawDataReceived() </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">函数实现了流程图所示的算法</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">另外几个函数</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">考虑到代码重用</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">定义为虚函数</span><span lang="EN-US">. </span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">LocatePacketHeader()</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">重载此函数来定位包头所在的位置</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">根据协议的不同</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">查找协议特定的包头特征字</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">返回包头在缓冲区中的位置</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果没有找到包头</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">则返回</span><span lang="EN-US"> dwLen.</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">ExtractPacketLength()</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US">PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">找到包头</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">并且确保收到足够多的数据之后</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">调用此函数来确定此包数据的协议包长</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这里的协议包长是指协议中的包长字段指示的长度</span><span lang="EN-US">. PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">用这个长度确定一包命令的结束</span><span lang="EN-US">.</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">IsPacketValid() </font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US">PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">从包头开始算起</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">取出协议包长指定长度的数据</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">传给</span><span lang="EN-US"> IsPacketValid(), </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">用户可以重载此函数</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在其中根据协议定义的校验方法验证这个命令包是否正确</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果是有效包</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">返回</span><span lang="EN-US"> TRUE, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">否则返回</span><span lang="EN-US"> FALSE.</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">OnPacketReceived() </font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US">PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">通过这个函数将有效的数据包交给上层处理</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">用户可重载这个函数</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">实现自己的业务逻辑</span><span lang="EN-US">. </span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">用户从</span><span lang="EN-US"> PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">派生自己的类</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">然后重载这四个虚函数</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">就可以在</span><span lang="EN-US"> OnPacketReceived() </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">收到合法包用以处理业务逻辑</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">另外</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在</span><span lang="EN-US"> PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">的处理过程中</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">需要知道协议定义的最大包长和最小包长</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">最大包长用来定义缓冲区</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">最小包长用来确定是否已经收到足够的数据以调用</span><span lang="EN-US"> ExtractPacketLength() </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">函数</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">由于这两个值在编译时即可确定</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">所以</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">用模板参数来指定</span><span lang="EN-US">. </span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<h1 style="MARGIN: 17pt 0cm 16.5pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font face="Courier New" size="2">具体应用</font></span></h1>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">举一个简单的例子</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">比如协议的定义如下</span><span lang="EN-US">:</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">7E 07 02 FF FF FF 84</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">其中</span><span lang="EN-US"> 7E </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">为包头</span><span lang="EN-US">, 07 </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">为包长</span><span lang="EN-US">. 02 FF FF FF </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">为数据段</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">数据段长度最小为</span><span lang="EN-US"> 0, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">最大为</span><span lang="EN-US"> 100.<span style="mso-spacerun: yes">&nbsp; </span></span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">最后一个字节</span><span lang="EN-US"> 84 </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">为累加校验和</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这个例子只是为了表意</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">实际的协议可能采用两个或者更多字节作为包头</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">减少数据段中的冲突</span><span lang="EN-US">(</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果要彻底解决冲突问题</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">可以采用转义字符</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">比如将除了包头之外的</span><span lang="EN-US"> 7e </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">都转义成其他字符</span><span lang="EN-US">). </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">校验可能会采用</span><span lang="EN-US"> CRC. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">更加可靠</span><span lang="EN-US">.</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">要解析这样一个协议</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">可以定义下面的类</span><span lang="EN-US">. </span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">// MyPacketExtractor.h header file</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">#include &ldquo;PacketExtractor.h&rdquo;</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US">class MyPacketExtractor : public PacketExtractor&lt;100 + 3/*</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">最大数据段长度</span><span lang="EN-US"> + </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">包头</span><span lang="EN-US"> + </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">包长字段</span><span lang="EN-US"> + </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">校验字段</span><span lang="EN-US">*/, 3 /*</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">数据段最小为</span><span lang="EN-US"> 0 */&gt; </span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">{</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>virtual UINT LocatePacketHeader(const BYTE byBuf[], DWORD dwLen)</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>for (int i = 0; i &lt; dwLen; ++ i)</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (byBuf[i] == 0x7e) return i;</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return dwLen;</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>virtual UINT ExtractPacketLength(const BYTE byBuf[], DWORD){return byBuf[1]; /* </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">包长位于数据包的第二个字节</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">直接返回之</span><span lang="EN-US">*/}</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><span style="mso-tab-count: 1"><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>virtual BOOL IsPacketValid(const BYTE [], DWORD dwLen)</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>BYTE byChksum = 0;</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>for (int i = 0; i &lt; dwLen - 1; ++ i)</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>byChksum += byBuf[i];</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return byChksum == byBuf[dwLen - 1];</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><span style="mso-tab-count: 1"><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>virtual void OnPacketReceived(const BYTE byBuf[], DWORD dwLen)</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在这里处理业务逻辑</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>printf(&quot;recv a packet. len = %d\n&quot;, dwLen);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">}</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">下面的代码演示了如何使用</span><span lang="EN-US"> MyPacketExtractor. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">代码基于</span><span lang="EN-US">MFC, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">使用</span><span lang="EN-US">CAsyncSocket</span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">通讯类</span><span lang="EN-US">.</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">// asyncsock.cpp</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">// compiled in vc6. cmdline: cl.exe -GX -MTd asyncsock.cpp</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">#include &lt;afxwin.h&gt; // MFC core and standard components</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">#include &lt;afxsock.h&gt; // MFC socket extensions</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">#include &lt;stdio.h&gt;</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">#include &quot;MyPacketExtractor.h&quot;</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">const int BUF_LEN = 1024;</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">class CDataSocket : public CAsyncSocket, public MyPacketExtractor {</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>void OnReceive(int) {</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>int nRecv = Receive(byBuf, BUF_LEN);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>do OnRawDataReceived(byBuf, nRecv);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>while ((nRecv = Receive(byBuf, BUF_LEN)) == BUF_LEN);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>}</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>BYTE byBuf[BUF_LEN + 1];</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>void OnClose(int nErr) {</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PostQuitMessage(nErr);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>}</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">};</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">class CListenSocket : public CAsyncSocket {</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>void OnAccept(int nErr) {</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>m_datasock.Close();</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>printf(&quot;OnAccept\n&quot;, nErr);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Accept(m_datasock);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>m_datasock.AsyncSelect(FD_READ | FD_CLOSE);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>}</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>CDataSocket m_datasock;</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">};</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">void main(int argc, char** argv) {</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>bool bServer = !(argc&lt;=1);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>AfxWinInit(::GetModuleHandle(NULL), NULL, NULL, 0);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>AfxSocketInit();</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>CListenSocket sock;</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>CDataSocket sock2;</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>CAsyncSocket* psock = bServer ? (CAsyncSocket*)&amp;sock : &amp;sock2;</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>if (bServer) {</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>psock-&gt;Create(5000);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>psock-&gt;AsyncSelect(FD_ACCEPT);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>psock-&gt;Listen();</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>} else {</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>psock-&gt;Create();</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>psock-&gt;Connect(&quot;127.0.0.1&quot;, 5000);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>}</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>while (1) {</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MSG msg;</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>while (PeekMessage(&amp;msg, 0, 0, 0, PM_NOREMOVE)) {</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (GetMessage(&amp;msg, 0, 0, 0))</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DispatchMessage(&amp;msg);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else exit(msg.wParam);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Sleep(100);</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (! bServer) {</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>static BYTE byFactor = 0, byBuf[] = {</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x7e, 1,5,1,3,5,6,3,1,6,8, <span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; </span>// </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">故意的</span><span lang="EN-US"> 7e </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">开头</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">非法数据包</span><span lang="EN-US">.</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x7E, 07, 02, 0xFF, 0xFF, 0xFF, 0x84, // </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">有效包</span><span lang="EN-US"> 1</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x1, 2, 3, 4, 5, 6,<span style="mso-tab-count: 1">&nbsp;&nbsp; </span>// </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">垃圾数据</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x7e, 0x0d, 03, 0x7e, 0x13, 0x52, 0x7e, 0x7e, 0x33, 0x14, 0x85, 0x64, 0x9d,// </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">有效包</span><span lang="EN-US"> 2. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">但中间故意夹杂了</span><span lang="EN-US"> 7e</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>54,65,68,45,32,12,<span style="mso-tab-count: 1"> </span>// </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">垃圾数据</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>0x7E, 0x8, 05, 0xFF, 0xFF, 0x0F, 0xf0, 0x88 // </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">有效包</span><span lang="EN-US"> 3.</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>};<span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp; </span></font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (! (byFactor ++ % 10))</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>psock-&gt;Send(byBuf, sizeof(byBuf));</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>}</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">}</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这个例子将服务器</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">客户端写到了一起</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">根据命令行参数区分</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果没有命令行参数</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">则作为客户端</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">否则作为服务端</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">先运行服务端程序</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">开始监听</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">然后运行客户端</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">连接服务器</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">建立连接之后</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">每秒发送一包数据</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">这包数据中包含了</span><span lang="EN-US"> 3 </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">个有效包</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">其间还夹杂了一些无效包和无效数据</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">从运行结果可以看出</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">服务端收到数据之后正确的解析了其中的有效包</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">并把有效包的包长打印出来</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">程序运行截图如下</span><span lang="EN-US">:</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><v:shape id="_x0000_i1026" style="WIDTH: 211.5pt; HEIGHT: 213.75pt" type="#_x0000_t75"><v:imagedata o:title="1" src="file:///D:\temp\msohtml1\01\clip_image003.png"></v:imagedata></v:shape><font face="Courier New"><font size="2"><span style="mso-spacerun: yes">&nbsp;</span><v:shape id="_x0000_i1027" style="WIDTH: 211.5pt; HEIGHT: 213.75pt" type="#_x0000_t75"> <v:imagedata o:title="3" src="file:///D:\temp\msohtml1\01\clip_image005.png"></v:imagedata></v:shape></font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">需要注意的是</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">有的协议可能没有包长字段</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">而是采用一个包尾字段来作为包的结束</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">则</span><span lang="EN-US"> ExtractPacketLength() </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">可以这么写</span><span lang="EN-US">:</span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">UINT ExtractPacketLength(const BYTE byBuf[], DWORD dwLen)</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">{</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>for (int i = 0; i &lt; dwLen; ++ i)</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (byBuf[i] == PACKET_TAIL)</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return i + 1;</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New"><font size="2"><span style="mso-tab-count: 1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return dwLen + 1;</font></font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><font face="Courier New" size="2">}</font></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Courier New" size="2">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果找到了包尾</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">那自然可以得出包长</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">如果没有找到</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">则返回一个比当前收到的数据包的长度还大的一个值</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">告诉</span><span lang="EN-US"> PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">收到的数据还不够组成一个合法包</span><span lang="EN-US">. PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">知道了这是一个半包</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">会在下次收到数据的时候将收到的数据附加到这个半包之后继续处理</span><span lang="EN-US">.</span></font></font></p>
<h1 style="MARGIN: 17pt 0cm 16.5pt"><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'"><font face="Courier New" size="2">结语</font></span></h1>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><font face="Courier New"><font size="2"><span lang="EN-US">PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">分层的设计</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">以</span><span lang="EN-US"> C++ </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">继承的方式</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">轻易的实现代码的复用</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">将程序员从通讯的底层细节中解放出来</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">将更多的精力放到程序的业务逻辑当中</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">有助于提高程序的质量</span><span lang="EN-US">. PacketExtractor </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">被运用到多个项目中</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">表现良好</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在这里推荐给大家</span><span lang="EN-US">. </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">也希望您</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">在编程的过程中</span><span lang="EN-US">, </span><span style="FONT-FAMILY: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">能从中受益</span><span lang="EN-US">. </span></font></font></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span lang="EN-US"><o:p><font face="Times New Roman" size="3">&nbsp;</font></o:p></span></p>
&nbsp;
]]></content:encoded><pubDate>2007-01-03 15:55</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[源码级 COM 组件复用的一次尝试]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/12/26/1463415.aspx</link><content:encoded><![CDATA[

<p><font face="Courier New" size="2">说到 COM 组件的复用. 那自然就是包容和聚合. 在二进制的层面上的复用. 这次我们要说的是在基于 ATL 的源代码级的复用. <br />比如已经有了一个 ATL 实现的组件, 比如 CComponentA, 现在想要实现另一个组件 CComponentB. 两个组件要实现的接口都相同, 比如 IComponentA. 而 CComponentB 的行为和 CComponentA 差不多, 只有个别方法的实现有点不同. 如果用 C++ 继承的思想, 应该怎么实现代码的重用呢?</font></p>
<p><font face="Courier New" size="2">class ATL_NO_VTABLE CComponentA : <br />&nbsp;public CComObjectRootEx&lt;CComSingleThreadModel&gt;,<br />&nbsp;public CComCoClass&lt;CComponentA, &amp;CLSID_ComponentA&gt;,<br />&nbsp;public IComponentA<br />{..}&nbsp;<br />&nbsp;<br />注意到 CLSID_ComponentA 是和类相关的. 那么先把它做成模板参数<br />&nbsp;<br />template&lt;const CLSID* pclsid&gt;<br />class ATL_NO_VTABLE CJunk4 : <br />&nbsp;public CComObjectRootEx&lt;CComSingleThreadModel&gt;,<br />&nbsp;public CComCoClass&lt;CComponentA, pclsid&gt;,<br />&nbsp;public IComponentA<br />{..}<br />&nbsp;<br />编译自然是不能通过的. <br />&nbsp;<br />BEGIN_OBJECT_MAP(ObjectMap)<br />OBJECT_ENTRY(CLSID_ComponentA, CComponentA)<br />END_OBJECT_MAP()<br />&nbsp;<br />这里提示 CComponentA 是模板类. 有办法. 加上这么一个 typedef<br />&nbsp;<br />typedef CComponentA&lt;&amp;CLSID_ComponentA&gt; CComponentA_;<br />&nbsp;<br />然后把 OBJECT_MAP 改成:<br />OBJECT_ENTRY(CLSID_ComponentA, CComponentA_)<br />&nbsp;<br />编译可以通过了. 那我们现在着手CComponentB 的实现:</font></p>
<p><font face="Courier New" size="2">class ATL_NO_VTABLE CComponentB : <br />&nbsp;public CComponentA&lt;&amp;CLSID_ComponentB&gt;<br />//&nbsp;public CComObjectRootEx&lt;CComSingleThreadModel&gt;,<br />//&nbsp;public CComCoClass&lt;CComponentB, &amp;CLSID_ComponentB&gt;,<br />//&nbsp;public IComponentA<br />{..}<br />&nbsp;<br />也可以通过编译了. 但是, 用下面的代码测试发现:<br />&nbsp;<br />&nbsp;CComPtr&lt;IComponentA&gt; sp;</font></p>
<p><font face="Courier New" size="2">&nbsp;CoCreateInstance(CLSID_ComponentA, NULL, CLSCTX_INPROC, IID_IComponentA, (void**)&amp;sp);<br />&nbsp;sp-&gt;Test();<br />&nbsp;sp.Release();</font></p>
<p><font face="Courier New" size="2">&nbsp;CoCreateInstance(CLSID_ComponentB, NULL, CLSCTX_INPROC, IID_IComponentA, (void**)&amp;sp);<br />&nbsp;sp-&gt;Test();</font></p>
<p><font face="Courier New" size="2">两次调用了同样的 Test() 函数!?<br />&nbsp;<br />经过分析, 发现错误出现在最开始的假设. CComponentA 的父类:<br />&nbsp;public CComCoClass&lt;CComponentA, &amp;CLSID_ComponentA&gt;,</font></p>
<p><font face="Courier New" size="2">第一个模板参数是 CComponentA, 这个自然也是和 CComponentA 相关的. 我们需要把它也换成一个模板参数, 象这样:<br />template&lt;const CLSID* pclsid, class ThisClass&gt;<br />class ATL_NO_VTABLE CJunk4 : <br />&nbsp;public CComObjectRootEx&lt;CComSingleThreadModel&gt;,<br />&nbsp;public CComCoClass&lt;ThisClass, pclsid&gt;,<br />&nbsp;public IComponentA<br />{..}<br />typedef CComponentA&lt;&amp;CLSID_ComponentA, CComponentA&gt; CComponentA_;<br />&nbsp;<br />想法是很好的. 但问题出现在这个 typedef 上, 编译器抱怨说模板参数中的 CComponentA 是模板类, 但没有实例化. 这条路行不通. <br />查看一下 CComCoClass 类做了些什么:</font></p>
<p><font face="Courier New" size="2">template &lt;class T, const CLSID* pclsid = &amp;CLSID_NULL&gt;<br />class CComCoClass<br />{<br />public:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DECLARE_CLASSFACTORY()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DECLARE_AGGREGATABLE(T)<br />&nbsp;&nbsp;..<br />}</font></p>
<p><font face="Courier New" size="2">这里只有 DECLARE_AGGREGATABLE(T) 用到了这个模板参数. 展开 DECLARE_AGGREGATABLE(T)<br />#define DECLARE_AGGREGATABLE(x) public:\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; typedef CComCreator2&lt; CComCreator&lt; CComObject&lt; x &gt; &gt;, CComCreator&lt; CComAggObject&lt; x &gt; &gt; &gt; _CreatorClass;</font></p>
<p><font face="Courier New" size="2">原来是一个 typedef. 有办法了. 我们自 CComponentB 中再来一个 typedef, 象这样:<br />class ATL_NO_VTABLE CComponentB : <br />&nbsp;public CComponentA&lt;&amp;CLSID_ComponentB&gt;<br />//&nbsp;public CComObjectRootEx&lt;CComSingleThreadModel&gt;,<br />//&nbsp;public CComCoClass&lt;CComponentB, &amp;CLSID_ComponentA&gt;,<br />//&nbsp;public IComponentA<br />{<br />public:<br />&nbsp;DECLARE_AGGREGATABLE(CComponentB)<br />&nbsp;..<br />}</font></p>
<p><font face="Courier New" size="2">父类和子类中出现相同的 typedef, 经测试发现没有冲突. <br />再次测试, 已经和预期的效果一样了. </font></p>
<p><font face="Courier New" size="2">现在 CComponentB 继承了 CComponentA 的实现, 重载感兴趣的方法, 用 C++ 的思想重用了代码. 这里用到的方法有点剑走偏锋. 一般不推荐使用. 但可能也有用得着的地方.</font></p>
<p><a href="http://nicoster.googlepages.com/inheritdemo.rar">下载代码</a>&nbsp;(vc6)<br /><font face="Courier New" size="2">&nbsp;</font></p>
]]></content:encoded><pubDate>2006-12-26 20:26</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[定制 WebBrowser (Part 1)]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/12/23/1456223.aspx</link><content:encoded><![CDATA[

<p>用 WTL 向导创建一个程序 WtlHtml, 显示 HTML page. 其实也就是 host 一个 webBrowser 控件. 打算做一些定制的工作. </p>
<p>1. 首先需要定制的是指定 external IDispatch 接口. 我们可以向项目中增加一个 ATL Object. 或者, 简单一点, 直接在现有的类上实现. 我打算采用第二种方法. 在 CWtlHtmlView 上实现. 给 CWtlHtmlView 增加两个父类:<br />class CWtlHtmlView : <br />&nbsp;public CWindowImpl&lt;CWtlHtmlView, CAxWindow&gt;,<br />&nbsp;public CComObjectRootEx&lt;CComSingleThreadModel&gt;,&nbsp;// 提供 IUnknown 接口<br />&nbsp;public IDispatchImpl&lt;IWtlHtml, &amp;IID_IWtlHtml, &amp;LIBID_WTLHTMLLib&gt;&nbsp;// 实现 IDispatch<br />{..}</p>
<p>既然用 IDispatchImpl, 那得有自己的类型库. 创建一个 idl. 从别的项目中复制一份. 将名字. GUID 换了就可以了. 编译之, 就生成了 tlb (LIBID_WTLHTMLLib).<br />&nbsp;<br />还得在类的声明中加上 COM map:<br />&nbsp;BEGIN_COM_MAP(CWtlHtmlView)<br />&nbsp;&nbsp;COM_INTERFACE_ENTRY(IDispatch)<br />&nbsp;END_COM_MAP()<br />&nbsp;<br />现在 CWtlHtmlView 成了纯虚类. 不能实例化了. 所以, 修改 CMainFrame 中 m_view 的定义:<br />&nbsp;CComObject&lt;CWtlHtmlView&gt; m_view;<br />&nbsp;<br />由于 m_view 没有在堆上创建, 所以不用考虑生命期的问题, 当然也不能被 Release() 里的 delete 掉, 我们可以先在 CMainFrame::OnCreate() AddRef() 一下, 再设置 external. </p>
<p>&nbsp;m_view.AddRef();<br />&nbsp;m_view.SetExternalDispatch(static_cast&lt;IWtlHtml*&gt;(&amp;m_view));<br />&nbsp;<br />现在已经可以在 html 中调用 IWtlHtml 接口中的方法了. <br />&nbsp;</p>
<p>2. 然后为了让网页上的按钮能有 visual style, 需要设置 DOCHOSTUIFLAG_THEME. 一般的方法就是实现 IDocHostUIHandler, 在 ATL 中有一个现成的 IDocHostUIHandlerDispatch 接口. 实现这个比较简单, 继续给 CWtlHtmlView 增加父类.<br />&nbsp;<br />class CWtlHtmlView : <br />&nbsp;..<br />&nbsp;public IDispatchImpl&lt;IDocHostUIHandlerDispatch, &amp;IID_IDocHostUIHandlerDispatch, &amp;LIBID_ATLLib&gt;<br />{..}<br />这里的 LIBID_ATLLib 是 ATL.dll 自带的 tlb, 用 oleview 可以看到, 里面只有两个接口. IDocHostUIHandlerDispatch.<br />IAxWinAmbientDispatch;<br />加入继承了 IID_IDocHostUIHandlerDispatch. 我们不得不实现它的方法. 好在可以直接返回 E_NOTIMPL; 一个比较简单的方法就是从 atliface.h 文件中将方法声明都粘过来. 实现都写成 {return E_NOTIMPL;} 不要忘了实现 GetHostInfo(), 这是我们实现 IDocHostUIHandlerDispatch 的目的:</p>
<p>&nbsp;&nbsp;&nbsp; virtual HRESULT STDMETHODCALLTYPE GetHostInfo( <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* [out][in] */ DWORD __RPC_FAR *pdwFlags,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* [out][in] */ DWORD __RPC_FAR *pdwDoubleClick)<br />&nbsp;{<br />&nbsp;&nbsp;ATLTRACE(&quot;called GetHostInfo\n&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp; *pdwFlags = DOCHOSTUIFLAG_THEME | DOCHOSTUIFLAG_SCROLL_NO | DOCHOSTUIFLAG_NO3DOUTERBORDER;<br />&nbsp;&nbsp;return S_OK;<br />&nbsp;} </p>
<p>我们在这里还设置了 DOCHOSTUIFLAG_SCROLL_NO 标志位, 用于去掉右边的滚动条. DOCHOSTUIFLAG_NO3DOUTERBORDER 用于去掉多余的 border.<br />&nbsp;<br />在 CMainFrame::OnCreate() 中加入:<br />&nbsp;m_view.SetExternalUIHandler(static_cast&lt;IDocHostUIHandlerDispatch*&gt;(&amp;m_view));<br />&nbsp;<br />应该差不多了, 编译. 没有起作用? 而且第一步已经实现的 external 也不可用了. 查看了一下 IDocHostUIHandlerDispatch, 发现有个 GetExternal 方法. 一查, 原来 webBrowser 发现你实现了 IDocHostUIHandlerDispatch, 它会在需要的时候调用 GetExternal() 获得这个 IDispatch. 因为我们直接返回了 E_NOTIMPL.&nbsp; 所以导致 external 不可用了. 修改也很简单:<br />&nbsp;&nbsp;&nbsp; virtual HRESULT STDMETHODCALLTYPE GetExternal( <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* [out] */ IDispatch __RPC_FAR *__RPC_FAR *ppDispatch)<br />&nbsp;{<br />&nbsp;&nbsp;*ppDispatch = static_cast&lt;IWtlHtml*&gt;(this); <br />&nbsp;&nbsp;return S_OK;<br />&nbsp;} </p>
<p>新问题解决了. 但我们要的 visual style 还是没有. 没有办法. google 吧. 找到了 codeguru 的一个帖子:<br /><a href="http://www.codeguru.com/forum/archive/index.php/t-164752.html">http://www.codeguru.com/forum/archive/index.php/t-164752.html</a>&nbsp;<br />&nbsp;<br />原来是因为在调用 m_view.Create() 的时候就创建了控件, 加载了 HTML 页面. 但我们的 SetExternalUIHandler() 调用是在这之后的. 所以当前页面没有 visual style. 但现在如果调用 Navigate2() 到一个新页面就可以看到设置的那些 flag 就生效了. 最直接的办法就是在 Create() 的时候先到 about:blank, 设置属性之后在 Navigate2 到我们要的页面. 不过 codeguru 的帖子里提到了另一种方法: 调用 IOleControl::OnAmbientPropertyChange() 通知 webBrowser 属性改变了. webBrowser 得到通知后自然就会重新应用新的属性. 代码就象这样:<br />&nbsp;&nbsp;CComPtr&lt;IOleControl&gt; spOC;<br />&nbsp;&nbsp;HRESULT hr = m_view.QueryControl(IID_IOleControl, (void**)&amp;spOC);<br />&nbsp;&nbsp;if (SUCCEEDED(hr))<br />&nbsp;&nbsp;&nbsp;spOC-&gt;OnAmbientPropertyChange(DISPID_UNKNOWN);<br />&nbsp;<br />DISPID_UNKNOWN 表示告诉 webBrowser 所有的属性都要重新应用一遍. 现在再运行程序. 已经是预期的效果了.<br />&nbsp;&nbsp;<br />3. 我们常常还要将右键菜单去掉. 不过现在已经是举手之劳了. IDocHostUIHandlerDispatch 还有一个 ShowContextMenu(), 重载这个方法就可以了:<br />&nbsp;&nbsp;&nbsp; virtual HRESULT STDMETHODCALLTYPE ShowContextMenu( <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* [in] */ DWORD dwID,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* [in] */ DWORD x,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* [in] */ DWORD y,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* [in] */ IUnknown __RPC_FAR *pcmdtReserved,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* [in] */ IDispatch __RPC_FAR *pdispReserved,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* [retval][out] */ HRESULT __RPC_FAR *dwRetVal)<br />&nbsp;&nbsp;{*dwRetVal = S_OK; return S_OK;} &nbsp;&nbsp;<br />&nbsp;&nbsp;<br />*dwRetVal = S_OK 是告诉 webBrowser 菜单不用它操心了. 我们自己搞定.&nbsp;</p>
]]></content:encoded><pubDate>2006-12-23 16:45</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[一个演示 CAsyncSocket 用法的极简单的例子. ]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/12/20/1451076.aspx</link><content:encoded><![CDATA[


<p>&nbsp;不到 100 行代码. 实现服务器, 客户端. 如果带有命令行参数, 则为服务器, 否则是客户端. </p>
<p>vc6 下编译. 环境变量中, 确保 cl.exe 在 PATH 中, INCLUDE 包含 vc6 头文件目录. LIB 包含库文件目录.</p>
<blockquote dir="ltr" style="MARGIN-RIGHT: 0px">
<p><font face="Courier New"><span style="COLOR: #000000">D:\&gt;set path<br />Path=C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\Program Files\Mi<br />crosoft Visual Studio\Common\Tools\WinNT;C:\Program Files\Microsoft Visual Studi<br />o\Common\MSDev98\Bin;C:\Program Files\Microsoft Visual Studio\Common\Tools;C:\Pr<br />ogram Files\Microsoft Visual Studio\VC98\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\W<br />INDOWS\System32\Wbem;C:\JBuilderX\jdk1.4\bin;C:\JBuilderX\jdk1.4\jre\bin;c:\debu<br />ggers;d:\program files\system internals;d:\program files<br />PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH</span></font></p>
<p><font face="Courier New"><span style="COLOR: #000000">D:\&gt;set in<br />include=C:\Program Files\Microsoft Visual Studio\VC98\atl\include;C:\Program Fil<br />es\Microsoft Visual Studio\VC98\mfc\include;C:\Program Files\Microsoft Visual St<br />udio\VC98\include</span></font></p>
<p><font face="Courier New"><span style="COLOR: #000000">D:\&gt;set li<br />lib=C:\Program Files\Microsoft Visual Studio\VC98\mfc\lib;C:\Program Files\Micro<br />soft Visual Studio\VC98\lib<br /><img alt="" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /><br /></span></font><span style="COLOR: #000000"><font face="Courier New">D:&gt;cl -GX -MTd asyncsock3.cpp<br />Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 12.00.8804 for 80x86<br />Copyright (C) Microsoft Corp 1984-1998. All rights reserved.</font></span></p>
<p><span style="COLOR: #000000"><font face="Courier New">asyncsock3.cpp<br />Microsoft (R) Incremental Linker Version 6.00.8447<br />Copyright (C) Microsoft Corp 1992-1998. All rights reserved.</font></span></p>
<p><span style="COLOR: #000000"><font face="Courier New">/out:asyncsock3.exe <br />asyncsock3.obj <br /></font></span></p>
<p>如果用 IDE 打开, 需要修改编译参数. </p>
<p><a href="http://nicoster.googlepages.com/asyncsock3.cpp">源码下载</a></p>


<pre>&nbsp;</pre>

</blockquote>
]]></content:encoded><pubDate>2006-12-20 21:56</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Difference between CComPtr and CComQIPtr]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/12/17/1447086.aspx</link><content:encoded><![CDATA[

<p>可能每个人学习 ATL 的时候都要区分 CComPtr 和 CComQIPtr 的不同. <br />CComQIPtr 是 CComPtr 的超集, 但 CComQIPtr 不能用于 IUnknown. 为什么不能用. </p>
<p>#include &lt;atlbase.h&gt;<br />void main(){CComQIPtr&lt;IUnknown&gt; spunk;}</p>
<p>果然, 编译错误. 原来错误的原因只是 CComQIPtr 定义了 &nbsp;</p>
<p>CComQIPtr(T* lp){..}<br />CComQIPtr(IUnknown* lp){..}</p>
<p>两个函数, 当 T = IUnknown 的时候, 函数重定义了. 还有另两个函数有这样的冲突.<br />查看 atlbase.h, 可以看到 CComQIPtr 还有一个特化的版本:</p>
<p>template&lt;&gt;<br />class CComQIPtr&lt;IUnknown, &amp;IID_IUnknown&gt;<br />{..}</p>
<p>这个版本可以让这样的代码通过编译:</p>
<p>CComQIPtr &lt;IUnknown, &amp;IID_IUnknown&gt; spunk;</p>
<p>但 </p>
<p>CComQIPtr&lt;IUnknown&gt; sp;</p>
<p>为什么不能通过编译呢? CComQIPtr&lt;IUnknown&gt; 取了默认的模板参数, 成为 CComQIPtr&lt;IUnknown, &amp;__uuidof(IUnknown)&gt;. __uuidof 这个操作符返回一个类型:</p>
<p>struct __s_GUID _GUID_00000000_0000_0000_c000_000000000046</p>
<p>很显然, 编译器不认为它和 IID_IUnknown 相同. <br />&nbsp;</p>
]]></content:encoded><pubDate>2006-12-17 21:22</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Smart formating source code using astyle in Scite]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/12/17/1447080.aspx</link><content:encoded><![CDATA[

<p>用 vc6 很喜欢 alt+F8 的功能. 能够格式化代码. scite 没有这个功能. 今天看它的配置文件发现这么两行:</p>
<p>command.name.0.*.cxx=Indent<br />command.0.*.cxx=astyle -tapO $(FileNameExt)</p>
<p>用来缩进的? 查了一下 astyle, 原来就是这个功能. 下载了 astyle 1.19, 修改了一下配置文件 cpp.properties, 如下:</p>
<p>command.name.0.*.cpp=Indent<br />command.0.*.cpp=astyle --style=ansi $(FileNameExt)</p>
<p>scite 更好用了.<br /></p>
]]></content:encoded><pubDate>2006-12-17 21:19</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[ATL 编程的两个 trick]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/12/17/1447076.aspx</link><content:encoded><![CDATA[

<p>ATL 编程的两个 trick<br />调试 dll<br />写一个简单的 atl 组件. 也少不了调试. 自然就需要一个程序来调用这个组件. ActiveX 控件有 ActiveX Control Test Container. 但好像不能加载普通的组件. 写一个 exe 来加载, 自然也不难. 但终究有些麻烦. 如果是支持 IDispatch 接口. 那么用脚本来调用组件是最简单的. 比如一个这样的 vbs 文件. 就可以实现调用:</p>
<p>'atldb.vbs<br />set db = CreateObject(&quot;Atldb.DB&quot;)<br />db.Execute(&quot;insert into [data] values(1)&quot;)</p>
<p>但 vc6 只支持调试 EXE, 也有办法, 指定被调试的程序为 cscript.exe, 把脚本文件作为参数. 现在 F7 编译好, 按 F5, 就可以调试啦.</p>
<p>shellext <br />这个不是原创, 是我在这里(<a href="http://www.sellsbrothers.com/tools/regsvr.reg">http://www.sellsbrothers.com/tools/regsvr.reg</a>)看到的. 以前也见过. 好像是用 dll 实现的. 还是这个简单, 一个 reg 文件, 而且比较全. 右击一个 dll, tlb, ocx, exe, olb.. 等等文件, 出现与 COM 相关的一些菜单项: reg/unreg, view in OLEVIEW.. 但有个小问题. 原版本的 View in OLEVIEW 不能用. 分析发现, 改成这样子就好了(假设你的机器里将 vc6 安装到了默认路径):</p>
<p>[HKEY_CLASSES_ROOT\dllfile\shell\View in OLEVIEW\command]<br />@=&quot;\&quot;C:\\Program Files\\Microsoft Visual Studio\\Common\\Tools\\oleview.exe\&quot; %L&quot;</p>
<p>[HKEY_CLASSES_ROOT\typelib\shell\View in OLEVIEW\command]<br />@=&quot;\&quot;C:\\Program Files\\Microsoft Visual Studio\\Common\\Tools\\oleview.exe\&quot; %L&quot;</p>
<p>[HKEY_CLASSES_ROOT\exefile\shell\View in OLEVIEW\command]<br />@=&quot;\&quot;C:\\Program Files\\Microsoft Visual Studio\\Common\\Tools\\oleview.exe\&quot; %L&quot;</p>
<p><br />改这个 reg 文件的时候, 修改/导入注册表好多次. 一直都是用 scite 的. scite 的好处尽可能的支持 F7/F5 等快捷键来编译/运行程序. 但是 F5 不支持 reg 文件. 虽然按 F5 导入 reg 文件的想法很自然. 而且 regedit.exe /s 本来也支持命令行参数. 找了一下, 发现在 other.properties 文件里加上这一句就可以了(可以加到最后). </p>
<p>command.go.*.reg=regedit /s $(FileNameExt)</p>
<p>改完一个 reg 文件后, 按 F5 就可以导入啦. 真方便.</p>
<p>-------------------------------------</p>
<p>看 other.properties 文件的时候, 偶然发现这个:</p>
<p>&nbsp;command.name.0.*.bat=Execute Selection<br />&nbsp;command.0.*.bat=$(CurrentSelection)</p>
<p>原来就是我一直想要的自定义功能键. 这里的设置是, 在编辑 bat 文件的时候, 将 ctrl + 0 设置为执行选中的文本. 第一行的作用是在 Tools 菜单下加入一个菜单项: Execute Selection. </p>
<p>以前看 scite 的帮助的时候好像看到过关于自定义功能键的说明. 但没有看太明白. 原来就是这个意思.:)</p>
<p><br />&nbsp;</p>
]]></content:encoded><pubDate>2006-12-17 21:16</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[关于 narrator.dll 的一个小插曲]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/12/05/1430656.aspx</link><content:encoded><![CDATA[

<p>前两天做好的 <a href="http://blog.csdn.net/ArCoolGG/archive/2006/12/03/1427932.aspx">narrator.dll</a>. 却变成了一个恶意插件:( 事情是这样的:</p>
<p>安装 narrator.DLL 之后, 360安全卫士会报两个恶意插件: iShare-MMSSender, Bysoo. 开始的时候我以为是因为调用一些敏感的 API 比如: SetWindowsHookEx(), 但去掉之后它还是把我的&nbsp; DLL 识别成两个病毒. 又一想, 是不是有特征字符串? 将 ATL 项目中的 bhoplugin, EyeOnIE, GUID 什么的都改成别的. 编译, 用 strings.exe (from sysinternals.com) 查看一下它的字符串. 发现还有 bhoplugin 等串. 没办法. 重新创建一个新的 ATL 项目把. 把代码填进去. 编译. 再用 360安全卫士检查. 终于不是恶意插件了. </p>
<p>由此看来. 上面提到的两个恶意插件也是基于 <a href="http://www.cnblogs.com/hbifts/articles/24265.html">http://www.cnblogs.com/hbifts/articles/24265.html</a><br />&nbsp;&nbsp; &quot;VC++开发BHO插件&mdash;&mdash;定制你的浏览器&quot; 这篇文章的代码修改的. 不曾想. 这样一篇入门的文章, 却也给轰轰烈烈的浏览器劫持大战起到了推波助澜的作用. 这也是作者始料未及的吧.&nbsp;</p>
]]></content:encoded><pubDate>2006-12-05 11:48</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[MSDN 不能使用 ]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/12/04/1429400.aspx</link><content:encoded><![CDATA[

<p>很久没有用 MSDN 了, 但终于觉得在线访问 msdn.com 效率太低, 今天决定在本机安装. 照旧使用 LAN 安装的方式, 只需要 100M 的空间, 安装速度快. 安装一切顺利. 然后就是使用的时候发现绝大多数帮助都显示找不到页面. 很郁闷. 在同事的 win2000 上同样的安装, 没有问题. 我用的是 XP. 刚开始怀疑安装有问题. 依稀记得需要先映射一个网络驱动器, 在网络驱动器里面点击 setup 安装. 不过在重装之前先在 IE 里试了一下帮助文件的 URL. 象这样的: <br />mk:@MSITStore:\\192.168.28.140\D$\MSDN\MSDN\fox7help.chm::/html/dgoriusingvisualfoxpro.htm<br />在 IE 里也不能打开. <br />那我就映射一个网络驱动器: <a href="file://\\192.168.28.140\MSDN">\\192.168.28.140\MSDN</a> -&gt; Y:, 用这样的连接访问:<br />mk:@MSITStore:Y:\MSDN\fox7help.chm::/html/dgoriusingvisualfoxpro.htm<br />故障依旧. 那也就意味这通过网络映射盘来安装也是不行的.</p>
<p>看了看记事本的帮助 URL, 是这样的: <br />ms-its:C:\WINDOWS\Help\notepad.chm::/win_notepad_finding_words.htm</p>
<p>难道 xp 里面把协议换了? 试了试:<br />ms-its:\\192.168.28.140\D$\MSDN\MSDN\fox7help.chm::/html/dgoriusingvisualfoxpro.htm</p>
<p>情况有点变化. 不是显示页面找不到了. 而是一个空白的窗口. <br />看来得弄清楚 ms-its, mk:@MSITStore 的来龙去脉. google &quot;mk:@MSITStore: 帮助 协议&quot;, 得到的第一条结果就是:<br />Microsoft 安全公告MS05-026： HTML 帮助中的漏洞可能允许远程执行代码 (896358)<br />shit, 看来是补丁惹的祸.<br />看一下已安装的补丁列表:</p>
<p>D:\nico&gt;psinfo -h|findstr 896358</p>
<p>PsInfo v1.70 - Local and remote system information viewer<br />Copyright (C) 2001-2005 Mark Russinovich<br />Sysinternals - <a href="http://www.sysinternals.com">www.sysinternals.com</a></p>
<p>2006-2-20&nbsp;&nbsp;&nbsp;&nbsp; Security Update for Windows XP (KB896358)<br />&nbsp;<br />果然安装了. 继续看:<br /><a href="http://support.microsoft.com/kb/896054/">http://support.microsoft.com/kb/896054/</a></p>
<p>将这样的注册表文件都导入了:<br />REGEDIT4<br />[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\HTMLHelp]<br />[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\HTMLHelp\1.x\ItssRestrictions]<br />&quot;MaxAllowedZone&quot;=dword:00000001</p>
<p>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\HTMLHelp\1.x\ItssRestrictions]<br />&quot;UrlAllowList&quot;=&quot;<a href="file://\\192.168.28.140">\\192.168.28.140</a>&quot;</p>
<p>重启系统, 不管用. 改了好几次, 也重启了几回, 还是不行. 有了一种上当的感觉.</p>
<p>继续看, 发现了这样一条信息:</p>
<p>Internet Explorer 增强的安全性<br />如果启用 Internet Explorer 增强的安全性，则可能会遇到类似于本文所述的症状。在这种情况下，本文中的替代方法可能不足以消除这些症状。 有关更多信息，请单击下面的文章编号，以查看 Microsoft 知识库中相应的文章： <br />815141 (<a href="http://support.microsoft.com/kb/815141/">http://support.microsoft.com/kb/815141/</a>) Internet Explorer 增强安全配置改变了浏览体验 </p>
<p>将 <a href="file://\\192.168.28.140">\\192.168.28.140</a> 加入到 intranet, 终于搞定了.</p>
<p><font color="#0000ff"><strong>后记: 导入注册表和添加 IP 到 intranet 两者需要同时使用才能奏效.</strong></font><br />&nbsp;</p>
]]></content:encoded><pubDate>2006-12-04 15:53</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[SHUT UP, GreatNews]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/12/03/1428240.aspx</link><content:encoded><![CDATA[

<p>一直都用 GreatNews 看 RSS, 虽然不是那么令人满意. 但它还是是我用起来最习惯的. 但有一点实在 annoying. 每次我启动程序的时候就提醒我. 我已经有 30 天没有更新程序了. 我已经有 216 天没有清理旧的消息了. 而且还一次弹出来 3 个. 在点击 RSS 的时候还得弹出来两三个. 本来也是作者善意的提醒. 但是,<br />. 每 30 天一次的更新并不是那样的激动人心. 作为一个普通用户. 我看不出更新前后有什么区别. 那我为什么还有花时间去做这样无意义的事情?<br />. 我喜欢把看过的 feeds 在本地保留下来. 因为以后我要找的时候不用在全球范围内搜索, 只要找我机器里的记录就好了. 况且用来保存 feeds 的数据库文件并不大 -- 即使我 216 天没有清空. 文件也只要 24M. 其实以前我也清理过. 但我也没有觉得清理之后程序跑起来就轻快一些了. 每次我打开程序, 它开始自动更新的时候. 程序的主界面就死了好一会儿. 更糟的是. 我的任务栏窗口都不响应了. 不知道作者是怎么实现的. </p>
<p>其实就这两个问题我也给作者写过邮件. 但却没有任何回复. 也许是太忙了吧.<br />作者回复不回复, 那是遥远的事情, 仿佛可以不管, 但每次要点击五六次确定. 却实在令人难受. 怎么办?&nbsp; 自己动手, 丰衣足食. 我的要求也不高. 只要不弹出 msgbox 就成. 还好这很容易实现. 祭出我们的终极武器: DETOUR! 玩 API 劫持. 改了改 detour 的例子. 编译成一个 simple.dll. 执行 detour 自带的 setdll.exe, 让 simple.dll 作为 greatnews.exe 的一个 dependency. 再次打开程序. 哈. 整个世界清净了.</p>
<p>附件中是源码和编译好的 dll. 将他们解压到 greatnews 所在目录. 执行 setdll /d:simple.dll greatnews.exe 即可.</p>
<p><u><font color="#0000ff"><a href="http://nicoster.googlepages.com/shutup_greatnews.rar">http://nicoster.googlepages.com/shutup_greatnews.rar</a></font></u></p>
<p>另外, 导出我的 RSS 频道和大家共享:</p>
<p><u><font color="#0000ff"><a href="http://nicoster.googlepages.com/myfeeds.opml">http://nicoster.googlepages.com/myfeeds.opml</a></font></u><a href="http://nicoster.googlepages.com/shutup_greatnews.rar"></a></p>
]]></content:encoded><pubDate>2006-12-03 21:56</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Narrator.dll 的实现]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/12/03/1427932.aspx</link><content:encoded><![CDATA[

<p>&nbsp;常常看英文网页. 有不少单词不认识, 甚至不知道如何发音. 也有软件可以翻译. 比如 googletoolbar, 还支持屏幕取词. 而金山词霸的一些版本也可以发音. 但它太庞大了. 我只要一个小小的发音功能. 犯不着. 这个时候, 往往我将这个词粘贴到控制面板的 speech applet, 让 windows 给我读出来. 虽然声音很糟糕. 毕竟是免费的午餐. 至少能知道单词是怎么读的.<br />这个操作虽然简单. 但次数一多, 就有些厌烦了. 因此, 就有了写一个 IE 插件的想法. 比如选中一个单词. 点击工具栏上的一个按钮. 电脑就帮你读出来. nice idea!</p>
<p>有两个问题需要解决.<br />. 怎么使用微软的 speech.<br />. 怎么创建 Internet Explorer 插件.</p>
<p>对于第一个问题. 我找到了 Microsoft Speech SDK 5.1, 居然是微软 2001 年发布的. 还是使用经典的 COM, 没有 .NET 这么先进. 附带了不少例子. 其中的 TalkBack 是一个简单的 console 程序. 先识别语言. 然后再读出来. 而我只需要读出来 (Text To Speech). 就在这个例子上面修改吧. 几行代码就可以高定. 如下:</p>
<p>&nbsp;CComPtr&lt;ISpVoice&gt; cpVoice;<br />&nbsp;hr = cpVoice.CoCreateInstance(CLSID_SpVoice);<br />&nbsp;<br />&nbsp;if (SUCCEEDED(hr))<br />&nbsp;{<br />&nbsp;&nbsp;cpVoice-&gt;Speak( L&quot;What can I say?&quot;, SPF_DEFAULT, NULL);<br />&nbsp;}</p>
<p>第二个问题费了一些时间. 首先我想到的就是 IE toolbar, IE toolbar 现在的名气很大. 很多流氓软件都用这个. 在 IE 上增加一个工具栏, 可以加上想要的通用控件, 比如工具栏按钮什么的. 但没有告诉我如何获取网页上选中的文本. 然后我又找到了 BHO. 也是一个 in-proc COM 组件. 通常没有界面. 还有一篇很好的文章介绍这个:<br />&nbsp;&nbsp;&nbsp;<a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnwebgen/html/bho.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnwebgen/html/bho.asp</a><br />&nbsp;&nbsp;&nbsp;Browser Helper Objects: The Browser the Way You Want It</p>
<p>还提供了例子代码. 加上另一篇文章:<br />&nbsp;&nbsp;&nbsp;<a href="http://www.cnblogs.com/hbifts/articles/24265.html">http://www.cnblogs.com/hbifts/articles/24265.html</a><br />&nbsp;&nbsp;&nbsp;VC++开发BHO插件&mdash;&mdash;定制你的浏览器<br />&nbsp;&nbsp;&nbsp;<br />另外, 还找到了一个如何从网页获取选中文本的脚本. 就是这么简单:<br />&nbsp;&nbsp;&nbsp;document.selection.createRange().text;</p>
<p>其中的 document 是 dhtml 中的文档对象. 我要做的只是把它翻译程 C++. 就象这样(为了简洁, 去掉了错误处理):<br />&nbsp;mWebBrowser2-&gt;get_Document(&amp;pDisp);<br />&nbsp;CComQIPtr&lt;IHTMLDocument2, &amp;IID_IHTMLDocument2&gt; spHTML = pDisp;<br />&nbsp;<br />&nbsp;if (spHTML)<br />&nbsp;{<br />&nbsp;&nbsp;CComPtr&lt;IHTMLSelectionObject&gt; selectObj;<br />&nbsp;&nbsp;spHTML-&gt;get_selection(&amp;selectObj);<br />&nbsp;&nbsp;if (selectObj)<br />&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;CComPtr&lt;IDispatch&gt; iDispRange;<br />&nbsp;&nbsp;&nbsp;selectObj-&gt;createRange(&amp;iDispRange);<br />&nbsp;&nbsp;&nbsp;CComQIPtr&lt;IHTMLTxtRange&gt; range(iDispRange);<br />&nbsp;&nbsp;&nbsp;if (range)<br />&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;BSTR bstrSelection;<br />&nbsp;&nbsp;&nbsp;&nbsp;range-&gt;get_text(&amp;bstrSelection);<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;mcpVoice-&gt;Speak(bstrSelection, SPF_ASYNC, NULL);<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br />&nbsp;}<br />&nbsp;<br />有了这些. 已经可以实现我的想法了. &nbsp;</p>
<p><br />于是, 就有了这个 narrator.dll. 在 IE 里遇到不知道如何读的单词. 选中它. 然后按 F2 (预定义的快捷键), 电脑就会读出这个单词. </p>
<p>Known Problems:<br />. 基于 Microsoft 的语言引擎, 只要 xp 及其以上采用安装, 所以, 默认情况下, 只支持 xp (极其以上)<br />. 默认情况下, 不支持中文阅读<br />. 如果您选中了一大段英文文本, 他会一直念到最后. 不能中断<br />. 还不能自定义键(偷懒)</p>
<p>Un/Installation:<br />. 拷贝到 windows 目录. 然后在开始/运行 执行 regsvr32 narrator.dll 来安装.<br />. 卸载: 在开始/运行 执行 regsvr32 /u narrator.dll, 然后删除 windows 目录的 narrator.dll. 绝对没有残留.</p>
<p>&nbsp;<a href="http://nicoster.googlepages.com/narrator.rar">http://nicoster.googlepages.com/narrator.rar</a></p>

<hr />

<p>&nbsp;如果只要求右键菜单触发, 那么就忘掉上面说得那么多吧. no ATL, no C++, just scripts</p>
<div style="BORDER-RIGHT: windowtext 0.5pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 0.5pt solid; PADDING-LEFT: 5.4pt; BACKGROUND: #e6e6e6; PADDING-BOTTOM: 4px; BORDER-LEFT: windowtext 0.5pt solid; WIDTH: 95%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: windowtext 0.5pt solid">
<div><img id="_28_148_Open_Image" onclick="this.style.display='none'; document.getElementById('_28_148_Open_Text').style.display='none'; document.getElementById('_28_148_Closed_Image').style.display='inline'; document.getElementById('_28_148_Closed_Text').style.display='inline';" alt="" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockStart.gif" /><img id="_28_148_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_28_148_Closed_Text').style.display='none'; document.getElementById('_28_148_Open_Image').style.display='inline'; document.getElementById('_28_148_Open_Text').style.display='inline';" alt="" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedBlock.gif" /><span style="COLOR: #0000ff">&lt;</span><span style="COLOR: #800000">script&nbsp;</span><span style="COLOR: #ff0000">language</span><span style="COLOR: #0000ff">=&quot;vbscript&quot;</span><span style="COLOR: #0000ff">&gt;</span><span id="_28_148_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">...</span><span id="_28_148_Open_Text"><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5"><br /><img alt="" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" /></span><span style="COLOR: #0000ff; BACKGROUND-COLOR: #f5f5f5">set</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">&nbsp;oVoice&nbsp;</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">=</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">&nbsp;</span><span style="COLOR: #0000ff; BACKGROUND-COLOR: #f5f5f5">CreateObject</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">(</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">&quot;</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">Sapi.SpVoice</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">&quot;</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">)<br /><img alt="" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockEnd.gif" />oVoice.Speak&nbsp;external.menuArguments.document.selection.createRange().text&nbsp;,&nbsp;</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5">2</span><span style="COLOR: #000000; BACKGROUND-COLOR: #f5f5f5"><br /><img alt="" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span></span><span style="COLOR: #0000ff">&lt;/</span><span style="COLOR: #800000">script</span><span style="COLOR: #0000ff">&gt;</span><span style="COLOR: #000000"><br /><img alt="" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span></div>
</div>

<div style="BORDER-RIGHT: windowtext 0.5pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 0.5pt solid; PADDING-LEFT: 5.4pt; BACKGROUND: #e6e6e6; PADDING-BOTTOM: 4px; BORDER-LEFT: windowtext 0.5pt solid; WIDTH: 95%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: windowtext 0.5pt solid">
<div><img alt="" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /><span style="COLOR: #000000">Windows&nbsp;Registry&nbsp;Editor&nbsp;Version&nbsp;</span><span style="COLOR: #000000">5.00</span><span style="COLOR: #000000"><br /><img alt="" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /><br /><img alt="" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />[HKEY_CURRENT_USER\Software\Microsoft\Internet&nbsp;Explorer\MenuExt\</span><span style="COLOR: #000000">&amp;</span><span style="COLOR: #000000">Say&nbsp;it]<br /><img alt="" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />@</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&quot;</span><span style="COLOR: #000000">d:\\narrator.htm</span><span style="COLOR: #000000">&quot;</span><span style="COLOR: #000000"><br /><img alt="" align="top" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span><span style="COLOR: #000000">&quot;</span><span style="COLOR: #000000">contexts</span><span style="COLOR: #000000">&quot;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">dword:</span><span style="COLOR: #000000">00000010</span></div>
</div>
<p><font size="2">注意注册表文件的路径, 这里假设你把 narrator.thm 放到了 d:\</font></p>
<img alt="" src="http://nicoster.googlepages.com/narrator_htm.png" />

<p><a href="http://nicoster.googlepages.com/narrator_setup.rar">http://nicoster.googlepages.com/narrator_setup.rar</a></p>
]]></content:encoded><pubDate>2006-12-03 16:55</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[星空极速 简单破解]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/11/30/1423181.aspx</link><content:encoded><![CDATA[

<p>我的一个同事也在装 ADSL. 电信肯定要强行安装 &quot;星空极速&quot; 的, 幸好网上早就有破解方法. 使用 sniffer&nbsp; PPP 数据包. 直接可以看到被星空急速加密后的密码. 将这个被修改过的密码填入 xp 自带的拨号程序, 或者带路由的 ADSL 猫的拨号程序. 即可拨号成功. 但使用 sniffer 还是有些麻烦. 我用过的是 sniffer pro. 由于不支持无线网卡. 让我的机器蓝屏了两回. 界面也稍显专业. 一般用户对着使用教程还是有些发怵.如果能够不用安装 sniffer 直接看到密码. 那就能方便很多了. </p>
<p>最近刚开始玩 windbg. 正好也练练手. </p>
<p><img alt="depends" src="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/1.PNG" /><br />先看看 depands, 都是些平常的 dll, 除了这个 rasapi32.dll, 查了一下 MSDN. 这个 dll 就是用来拨号的. 看看它的导出函数 RasDialA. 这个函数就是用来拨号的. <br />DWORD RasDial(<br />&nbsp; LPRASDIALEXTENSIONS lpRasDialExtensions,&nbsp;// pointer to function extensions data<br />&nbsp; LPCTSTR lpszPhonebook,&nbsp; &nbsp;// pointer to full path and file name of phone-book file<br />&nbsp; LPRASDIALPARAMS lpRasDialParams,&nbsp;// pointer to calling parameters data<br />&nbsp; DWORD dwNotifierType,&nbsp;&nbsp; // specifies type of RasDial event handler<br />&nbsp; LPVOID lpvNotifier,&nbsp;&nbsp;&nbsp;&nbsp; // specifies a handler for RasDial events<br />&nbsp; LPHRASCONN lphRasConn&nbsp;&nbsp; // pointer to variable to receive connection handle<br />);</p>
<p>关键就在第三个参数 LPRASDIALPARAMS:<br />typedef struct _RASDIALPARAMS { <br />&nbsp; DWORD&nbsp; dwSize; <br />&nbsp; TCHAR&nbsp; szEntryName[RAS_MaxEntryName + 1]; <br />&nbsp; TCHAR&nbsp; szPhoneNumber[RAS_MaxPhoneNumber + 1]; <br />&nbsp; TCHAR&nbsp; szCallbackNumber[RAS_MaxCallbackNumber + 1]; <br />&nbsp; TCHAR&nbsp; szUserName[UNLEN + 1]; <br />&nbsp; TCHAR&nbsp; szPassword[PWLEN + 1]; <br />&nbsp; TCHAR&nbsp; szDomain[DNLEN + 1] ; <br />#if (WINVER &gt;= 0x401)<br />&nbsp; DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dwSubEntry;<br />&nbsp; ULONG_PTR&nbsp; dwCallbackId;<br />#endif<br />} RASDIALPARAMS; </p>
<p>其中的 szPassword 就是我们感兴趣的. 知道了这些就好办了. 启动 cdb.exe</p>
<p>D:\nico&gt;cdb -pn dialterminal.exe</p>
<p>Microsoft (R) Windows Debugger&nbsp; Version 6.6.0007.5<br />Copyright (c) Microsoft Corporation. All rights reserved.</p>
<p>*** wait with pending attach<br />Symbol search path is: srv*c:\websymbols*http://msdl.microsoft.com/download/symb<br />ols<br />Executable search path is:<br />ModLoad: 00400000 00458000&nbsp;&nbsp; C:\Program Files\ChinaNetSn\bin\Dialterminal.exe<br />ModLoad: 7c900000 7c9b0000&nbsp;&nbsp; C:\WINDOWS\system32\ntdll.dll<br />ModLoad: 7c800000 7c8f4000&nbsp;&nbsp; C:\WINDOWS\system32\kernel32.dll<br />...</p>
<p>下断点 rasapi32!RasDialA, 然后 g <br />0:001&gt; bp rasapi32!RasDialA<br />0:001&gt; g</p>
<p>在 星空急速 的登录窗口输入电信给的用户名和密码. 然后点连接. </p>
<p><img alt="dialterminal" src="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/2.PNG" /></p>
<p>一会儿之后就到断点了.<br />Breakpoint 0 hit<br />eax=00433a90 ebx=0012ce00 ecx=7c80be2d edx=0012c3c4 esi=0012c6d4 edi=0012c3c3<br />eip=76ef6a25 esp=0012c150 ebp=7c80be01 iopl=0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nv up ei ng nz na pe nc<br />cs=001b&nbsp; ss=0023&nbsp; ds=0023&nbsp; es=0023&nbsp; fs=003b&nbsp; gs=0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; efl=00000286<br />RASAPI32!RasDialA:<br />76ef6a25 8bff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; edi,edi<br />0:000&gt;</p>
<p>查看一下 callstack<br />0:000&gt; kb<br />*** WARNING: Unable to verify checksum for C:\Program Files\ChinaNetSn\bin\Dialt<br />erminal.exe<br />*** ERROR: Module load completed but symbols could not be loaded for C:\Program<br />Files\ChinaNetSn\bin\Dialterminal.exe<br />ChildEBP RetAddr&nbsp; Args to Child<br />0012c14c 00417370 00000000 00000000 0012c3c4 RASAPI32!RasDialA<br />WARNING: Stack unwind information not available. Following frames may be wrong.<br />0012c168 0012dbd4 0012ce7c 0012dbe0 0012f5f0 Dialterminal+0x17370<br />0012c16c 0012ce7c 0012dbe0 0012f5f0 0037c9e0 0x12dbd4<br />0012dbd4 0037c940 0037c760 0037c710 00001000 0x12ce7c<br />0012dbd8 0037c760 0037c710 00001000 00000000 0x37c940<br />0012dbdc 0037c710 00001000 00000000 00000000 0x37c760<br />0012dbe0 00000000 00000000 00000000 00000000 0x37c710<br />0:000&gt;</p>
<p>第三个参数 0012c3c4 就是我们要找的 LPRASDIALPARAMS. szPassword 在偏移 776 的地方. 查看之.<br />0:000&gt; dc 0012c3c4 + 0n776<br />0012c6cc&nbsp; 31323738 31323738 65356165 36343661&nbsp; 87218721ea5ea646<br />0012c6dc&nbsp; 61393430 00326436 00000000 00000000&nbsp; 049a6d2.........<br />0012c6ec&nbsp; 00000000 00000000 00000000 00000000&nbsp; ................<br />0012c6fc&nbsp; 00000000 00000000 00000000 00000000&nbsp; ................<br />0012c70c&nbsp; 00000000 00000000 00000000 00000000&nbsp; ................<br />0012c71c&nbsp; 00000000 00000000 00000000 00000000&nbsp; ................<br />0012c72c&nbsp; 00000000 00000000 00000000 00000000&nbsp; ................<br />0012c73c&nbsp; 00000000 00000000 00000000 00000000&nbsp; ................<br />0:000&gt;</p>
<p>密码出来啦. <br />要获取这个密码, 最简单的方法就是做一个 API 钩子. 截获之后将参数显示出来即可. <br />前两天看到 detour 的介绍. 正好可以试试. 下载 detour SDK, 照着例子修改了一下. 很快就写出破解程序了. </p>
<p><img alt="passwd" src="http://p.blog.csdn.net/images/p_blog_csdn_net/ArCoolGG/3.PNG" /><br />使用很简单. 将程序解压到星空急速的安装目录得到 5 个文件. 执行 patch.cmd, 就给 dialterminal.exe 打了补丁. <br />再执行 dialterminal.exe, 输入用户名, 密码. 点击连接. 一会儿就会弹出一个显示密码的对话框了.</p>
<p>另外的文件: unpatch.cmd 用于卸载补丁. rasdial.dll 用于 api hook. <br />setdll.exe, detoured.dll 为 Detour 自带.&nbsp;</p>
<p>从我的 googlepages 上下载 (27K):</p>
<p><a href="http://nicoster.googlepages.com/rasdial.rar">http://nicoster.googlepages.com/rasdial.rar</a></p>
]]></content:encoded><pubDate>2006-11-30 21:49</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[关于调试]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/11/28/1419113.aspx</link><content:encoded><![CDATA[

&nbsp;这段时间在学习调试的技巧.<br />以前的调试只局限在 vc6 IDE 中的调试.&nbsp; <a href="http://www.cnblogs.com/lixiong/">http://www.cnblogs.com/lixiong/</a> 的 &quot;windows 用户态程序高效排错&quot; 展现了<br />一个全新的调试世界. windbg 的引入. 让这一切成为可能. <br />大多数的时候, 调试的程序都是没有源代码的. 这也就要求要有汇编功底. 在学校的汇编只玩过 8086 的. 除了一些基本的指令. 基本上是从头学起. 学习函数的 prolog, 学习查看 call stack. 学习 SEH 的实现原理. 查看 windbg 调试实例. <br />不知不觉的. 又来到的系统的底层. 由于工作需要, 以前也看过一段时间的驱动开发. 但是感觉太过艰深. 最终没有继续下去. 而且告诫自己. 不要轻易涉足这个领域. 但随着调试的深入学习. 却是殊途同归. 但调试程序的乐趣. 让我感觉我属于那里.
]]></content:encoded><pubDate>2006-11-28 23:20</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Geexbox]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/11/17/1393281.aspx</link><content:encoded><![CDATA[

<p>Geexbox 是一个简化的 linux 版本 + mplayer,&nbsp;用于媒体播放.&nbsp;和 windows 相比有两个优点:</p>
<p>. 对配置要求低. 200M, 96M 就能播?</p>
<p>. 简单.&nbsp;有点象微软的 media&nbsp;center? 机器开机就进入媒体播放界面. &nbsp;有点信息家电的意思.</p>

<p>朋友有台旧机器. 打算给她装一个试试效果. 那个机器极其慢. windows 下看视频基本不可用. </p>

<p>也在公司的旧机器上试过. 发现对配置的要求没有想象的低. </p>
<p>另外, 也发现 700M 的 divx/xvid 的解码要比 rmvb 效率高. </p>
<p>同等画质下, rmvb 的高压缩率也造成了编解码算法复杂.</p>
]]></content:encoded><pubDate>2006-11-17 23:38</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Lost Watch ScreenSaver]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/11/17/1393273.aspx</link><content:encoded><![CDATA[

<p>在深圳华强北逛的时候看到商家将这款屏保跑在机器上. </p>
<p>回到西安也找了一个.&nbsp;实在是太精细了. 巧夺天工. </p>
<p>制作公司对水波纹进行了深入的研究. 涟漪的光影效果做得极其逼真. very nice.&nbsp;</p>
<p>向制作团队致敬.</p>
]]></content:encoded><pubDate>2006-11-17 23:31</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[tATu 的 30 minutes]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/11/17/1393266.aspx</link><content:encoded><![CDATA[

<p>偶然发现的. 感觉不错.&nbsp;找了一些 tatu 其他的作品, 感觉一般. </p>
<p>&quot;<font face="Verdana">歌手是一对有同性恋倾向的女孩团体Tatu，她们是近年轰动东欧的俄罗斯冠军组合（Tatu是俄文Ta lyubit Tu的缩写，翻译成英文应该是She loves her）。寂寞，迷茫，无助；却又坚强，独立，秉持自我&mdash;&mdash;Tatu的歌魅力即在于此，就像那个在欧亚两个大洲中间难以找到归属于认同的俄罗斯民族一样，在罪与罚中期待拯救。</font></p>
<p><font face="Verdana">　　清冷的《30分钟》，可以作出太多决定，可以发生太多事，只开头一句呢喃&ldquo;爸爸妈妈，原</font><font face="Verdana">谅我&rdquo;，就会让你的心会跟着紧缩，跟着她们坠入另一个世界，暗夜。&quot;</font></p>
<p><font face="Verdana"></font></p>
<p><font face="Verdana">30 Minutes<br />Tatu</font></p>
<p><font face="Verdana">Mama, Papa, forgive me </font></p>
<p><font face="Verdana">Out of sight, out of mind, out of time to decide<br />Do we run? Should I hide for the rest of my life?<br />Can we fly? Do I stay? We could lose. We could fail<br />In the moment it takes to make plans or mistakes</font></p>
<p><font face="Verdana">30 minutes, a blink of an eye. 30 minutes to alter our lives<br />30 minutes to make up my mind. 30 minutes to finally decide<br />30 minutes to whisper your name. 30 minutes to shoulder the blame<br />30 minutes of bliss, thirty lies. 30 minutes to finally decide</font></p>
<p><font face="Verdana">Carousels in the sky that we shape with our eyes<br />Under shade, silhouettes, casting shade, crying rain<br />Can we fly? Do I stay? We could lose. We could fail<br />Either way. Options change. Chances fail. Trains derail</font></p>
<p><font face="Verdana">30 minutes, a blink of an eye. 30 minutes to alter our lives<br />30 minutes to make up my mind. 30 minutes to finally decide<br />30 minutes to whisper your name. 30 minutes to shoulder the blame<br />30 minutes of bliss, thirty lies. 30 minutes to finally decide</font></p>
<p><font face="Verdana">To decide (Repeat)</font></p>
<p><font face="Verdana"><br /></font></p>
]]></content:encoded><pubDate>2006-11-17 23:26</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[从 filedonkey.com 找文件]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/11/07/1370406.aspx</link><content:encoded><![CDATA[

一直都想在程序中使用 LIST_ENTRY. 今天找了一些文档, 包括 msdn 等, 在一个 native API 的文件中得知 LIST_ENTRY 等只能在 DDK 中使用. 但还提到了一个 w2k_def.h 文件.<br />寻之. 发现在 Undocumented Windows 2000 Secrets 随书光盘中. 先找书. 很快就在 infoxa.com 找到了中文版. 然后再找随书源码. 只找到一个连接在 zndev 上. 有一个人回复说<br />有, 而且可以下载, 很幸运, 下载下来一看. 文件名中包含了 &quot;found via <a href="http://www.FileDonkey.com">www.FileDonkey.com</a>&quot; 的字样. 遂到 <a href="http://www.filedonkey.com">www.filedonkey.com</a> 看看. 还是搜 Undocumented Windows 2000 Secrets.<br />My God, 居然还能搜索到. 因为没有装 emule, 没有测试能否下载. 但找到了一个下载文件的好去处. 也是一个收获阿.<br />&nbsp;
]]></content:encoded><pubDate>2006-11-07 00:18</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[TopCoder]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/10/30/1357705.aspx</link><content:encoded><![CDATA[

看 编译原理与实践, 知道了 Kenneth Louden 教授(<a href="http://www.cs.sjsu.edu/faculty/louden/">http://www.cs.sjsu.edu/faculty/louden/</a>), San Jose State University<br />&nbsp;计算机系主席. (学校位于硅谷附近. ), 偶然的看到了 <a href="http://www.sjsu.edu">www.sjsu.edu</a> 上的 TopCoder 的新闻. 到 topcoder 上一看. 发现清华也在其中.<br />google 了一下, 知道了 topcoder 是个什么东东. 其实是编程牛人的游戏. 玩的都是算法. 而现在的 IT 企业对这个都很关注. 也从中选拔人才.<br />同时也赞助 topcoder 上的比赛. 参赛者能够获得奖金. 打算去看看. &nbsp;
]]></content:encoded><pubDate>2006-10-30 23:24</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Active Sync over WiFi in Windows Mobile 5 ]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/09/20/1255969.aspx</link><content:encoded><![CDATA[

<div class="itemTitleStyle"><a class="TitleLinkStyle" href="http://www.fastchicken.co.nz/blog/2005-09-21-ActiveSyncOverWiFiInWindowsMobile5.aspx"><font color="#0000ff">Active Sync over WiFi in Windows Mobile 5</font></a> </div>
<div class="itemBodyStyle">


<p>This is mostly for anyone searching with Google :) Another MVP recently asked for clarification on an issue:</p>
<p><strong>Q:</strong> Does Active Sync 4 prevent syncing over WiFi, or do <span class="searchword">WM5</span> devices not sync over WiFi AT ALL.</p>
<p>There are 2 issues here:</p>
<ol>
    <li>Can a <span class="searchword">WM5</span> device sync to an Exchange server (Server Active Sync) over WiFi </li>
    <li>Can a <span class="searchword">WM5</span> device sync to a PC (Active Sync 4) over WiFi</li>
</ol>
<p>There appears to be some confusion about this out in the world. The definitive answer, from <a href="http://www.fastchicken.co.nz/blog/ct.ashx?id=72d49a15-c2a2-40c2-87f2-1d37dab8053b&amp;url=http%3a%2f%2fwww.geekzone.co.nz%2f"><strong>geekzone.co.nz</strong></a> as well as Microsoft is:</p>
<ul>
    <li>A Windows Mobile 5 device <strong>CAN</strong> sync to an Exchange Server (Server Active Sync) using any method available to it (<strong>including WiFi</strong>). </li>
    <li>A Windows Mobile 5 device <strong>CAN</strong> sync to a PC (Active Sync 4) using Bluetooth, Serial, IR&nbsp;and USB Only. It definitely <strong>CAN NOT</strong> use WiFi OR Ethernet.</li>
</ul>
<p><span class="searchword">WM5</span> Windows Mobile Active Sync WiFi <span class="searchword">Wireless</span> (keyword-o-rama)</p>


... &quot;possibly Ethernet&quot;... <br /><br />Nope, Ethernet is not allowed, wired or <span class="searchword">wireless</span>...&nbsp;<br />&nbsp;</div>
]]></content:encoded><pubDate>2006-09-20 22:56</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Timer, TimerWnd]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/08/18/1092081.aspx</link><content:encoded><![CDATA[

<p>有时候, 你需要一个定时器. 可能你在这个线程里还没有属于自己的窗口. 你当然也可以不创建窗口而直接使用线程里的定时器消息. 就象这样(以 CWinThread 的一个派生类为例)</p>
<p>CYourThread::InitInstance()<br />{<br />&nbsp;m_nTimerID = ::SetTimer(NULL, NULL, 1000/*ms*/,&nbsp; NULL);<br />&nbsp;...<br />}</p>
<p>BEGIN_MESSAGE_MAP()<br />&nbsp;ON_WM_TIMER()<br />&nbsp;...<br />END_MESSAGE_MAP</p>
<p>CYourThread::OnTimer(UINT nID)<br />{<br />&nbsp;if (nID == m_nTimerID)<br />&nbsp;{<br />&nbsp;&nbsp;// do your work here<br />&nbsp;}<br />}<br />&nbsp;<br />这个方法的缺点在于. 如果你不用 CWinThread 的派生类. 可能添加 WM_TIMER 的消息处理函数比较麻烦. 甚至不能实现</p>
<p>所以, 还是回到老办法, 创建一个辅助窗口. 写自己的 WM_TIMER 处理函数. <br />但如果使用 MFC 的 CWnd 的派生类. 会遇到这样的问题. 你可能不能跨线程来关闭这个窗口. 或者一些其他的窗口操作. 又是由于 MFC 里臭名昭著的大量的 map, 这些 map 都是线程相关的. <br />既然我们这里的应用只是一个定时器的辅助窗口. 我们完全可以自己实现一个 TimerWnd. 就像这样:</p>

<div style="BORDER-RIGHT: windowtext 0.5pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 0.5pt solid; PADDING-LEFT: 5.4pt; BACKGROUND: #e6e6e6; PADDING-BOTTOM: 4px; BORDER-LEFT: windowtext 0.5pt solid; WIDTH: 95%; WORD-BREAK: break-all; PADDING-TOP: 4px; BORDER-BOTTOM: windowtext 0.5pt solid">
<div><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /><span style="COLOR: #008000">//</span><span style="COLOR: #008000">&nbsp;TimerWnd.h&nbsp;start&nbsp;here&nbsp;-------------------------------------------------</span><span style="COLOR: #008000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span><span style="COLOR: #000000"><br /><img id="_76_139_Open_Image" onclick="this.style.display='none'; document.getElementById('_76_139_Open_Text').style.display='none'; document.getElementById('_76_139_Closed_Image').style.display='inline'; document.getElementById('_76_139_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockStart.gif" /><img id="_76_139_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_76_139_Closed_Text').style.display='none'; document.getElementById('_76_139_Open_Image').style.display='inline'; document.getElementById('_76_139_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedBlock.gif" /></span><span id="_76_139_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="_76_139_Open_Text"><span style="COLOR: #008000">/*</span><span style="COLOR: #008000">&nbsp;Nico&nbsp;06-8-14&nbsp;1124&nbsp;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;a&nbsp;simple&nbsp;HWND&nbsp;encapsulation&nbsp;for&nbsp;timer&nbsp;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockEnd.gif" /></span><span style="COLOR: #008000">*/</span></span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" />#ifndef&nbsp;_TIMERWND_H_<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span><span style="COLOR: #0000ff">#define</span><span style="COLOR: #000000">&nbsp;_TIMERWND_H_</span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span><span style="COLOR: #0000ff">class</span><span style="COLOR: #000000">&nbsp;TimerWnd<br /><img id="_200_1839_Open_Image" onclick="this.style.display='none'; document.getElementById('_200_1839_Open_Text').style.display='none'; document.getElementById('_200_1839_Closed_Image').style.display='inline'; document.getElementById('_200_1839_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockStart.gif" /><img id="_200_1839_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_200_1839_Closed_Text').style.display='none'; document.getElementById('_200_1839_Open_Image').style.display='inline'; document.getElementById('_200_1839_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedBlock.gif" /></span><span id="_200_1839_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">...</span><span id="_200_1839_Open_Text"><span style="COLOR: #000000">{<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" /></span><span style="COLOR: #0000ff">public</span><span style="COLOR: #000000">:<br /><img id="_221_235_Open_Image" onclick="this.style.display='none'; document.getElementById('_221_235_Open_Text').style.display='none'; document.getElementById('_221_235_Closed_Image').style.display='inline'; document.getElementById('_221_235_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_221_235_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_221_235_Closed_Text').style.display='none'; document.getElementById('_221_235_Open_Image').style.display='inline'; document.getElementById('_221_235_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;TimerWnd()</span><span id="_221_235_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">...</span><span id="_221_235_Open_Text"><span style="COLOR: #000000">{Initialize();}</span></span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" /><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" /></span><span style="COLOR: #0000ff">private</span><span style="COLOR: #000000">:<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">static</span><span style="COLOR: #000000">&nbsp;&nbsp;LRESULT&nbsp;CALLBACK<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;WndProc(HWND&nbsp;hwnd,&nbsp;UINT&nbsp;uiMsg,&nbsp;WPARAM&nbsp;wParam,&nbsp;LPARAM&nbsp;lParam)<br /><img id="_345_549_Open_Image" onclick="this.style.display='none'; document.getElementById('_345_549_Open_Text').style.display='none'; document.getElementById('_345_549_Closed_Image').style.display='inline'; document.getElementById('_345_549_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_345_549_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_345_549_Closed_Text').style.display='none'; document.getElementById('_345_549_Open_Image').style.display='inline'; document.getElementById('_345_549_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="_345_549_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">...</span><span id="_345_549_Open_Text"><span style="COLOR: #000000">{<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;</span><span style="COLOR: #0000ff">if</span><span style="COLOR: #000000">&nbsp;(uiMsg&nbsp;</span><span style="COLOR: #000000">==</span><span style="COLOR: #000000">&nbsp;WM_TIMER)<br /><img id="_374_484_Open_Image" onclick="this.style.display='none'; document.getElementById('_374_484_Open_Text').style.display='none'; document.getElementById('_374_484_Closed_Image').style.display='inline'; document.getElementById('_374_484_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_374_484_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_374_484_Closed_Text').style.display='none'; document.getElementById('_374_484_Open_Image').style.display='inline'; document.getElementById('_374_484_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;</span><span id="_374_484_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">...</span><span id="_374_484_Open_Text"><span style="COLOR: #000000">{<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;TimerWnd&nbsp;</span><span style="COLOR: #000000">*</span><span style="COLOR: #000000">that&nbsp;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&nbsp;(TimerWnd&nbsp;</span><span style="COLOR: #000000">*</span><span style="COLOR: #000000">)GetWindowLong(hwnd,&nbsp;GWL_USERDATA);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;that</span><span style="COLOR: #000000">-&gt;</span><span style="COLOR: #000000">OnTimer(wParam);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">return</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockEnd.gif" />&nbsp;&nbsp;}</span></span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">return</span><span style="COLOR: #000000">&nbsp;DefWindowProc(hwnd,&nbsp;uiMsg,&nbsp;wParam,&nbsp;lParam);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockEnd.gif" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" /><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;</span><span style="COLOR: #0000ff">virtual</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #0000ff">void</span><span style="COLOR: #000000">&nbsp;OnTimer(UINT&nbsp;uID)<br /><img id="_585_633_Open_Image" onclick="this.style.display='none'; document.getElementById('_585_633_Open_Text').style.display='none'; document.getElementById('_585_633_Closed_Image').style.display='inline'; document.getElementById('_585_633_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_585_633_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_585_633_Closed_Text').style.display='none'; document.getElementById('_585_633_Open_Image').style.display='inline'; document.getElementById('_585_633_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;</span><span id="_585_633_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">...</span><span id="_585_633_Open_Text"><span style="COLOR: #000000">{<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;OutputDebugString(</span><span style="COLOR: #000000">&quot;</span><span style="COLOR: #000000">TimerWnd::OnTimer&nbsp; </span><span style="COLOR: #000000">&quot;</span><span style="COLOR: #000000">);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockEnd.gif" />&nbsp;}</span></span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">static</span><span style="COLOR: #000000">&nbsp;BOOL&nbsp;Initialize()<br /><img id="_673_822_Open_Image" onclick="this.style.display='none'; document.getElementById('_673_822_Open_Text').style.display='none'; document.getElementById('_673_822_Closed_Image').style.display='inline'; document.getElementById('_673_822_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_673_822_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_673_822_Closed_Text').style.display='none'; document.getElementById('_673_822_Open_Image').style.display='inline'; document.getElementById('_673_822_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="_673_822_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">...</span><span id="_673_822_Open_Text"><span style="COLOR: #000000">{<br /><img id="_698_748_Open_Image" onclick="this.style.display='none'; document.getElementById('_698_748_Open_Text').style.display='none'; document.getElementById('_698_748_Closed_Image').style.display='inline'; document.getElementById('_698_748_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_698_748_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_698_748_Closed_Text').style.display='none'; document.getElementById('_698_748_Open_Image').style.display='inline'; document.getElementById('_698_748_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WNDCLASSW&nbsp;wc&nbsp;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&nbsp;</span><span id="_698_748_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">...</span><span id="_698_748_Open_Text"><span style="COLOR: #000000">{</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">,&nbsp;WndProc,&nbsp;</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">,&nbsp;</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">,&nbsp;</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">,&nbsp;</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">,&nbsp;</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">,&nbsp;</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">,&nbsp;</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">,&nbsp;L</span><span style="COLOR: #000000">&quot;</span><span style="COLOR: #000000">TimerWndClass</span><span style="COLOR: #000000">&quot;</span><span style="COLOR: #000000">}</span></span><span style="COLOR: #000000">;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #0000ff">if</span><span style="COLOR: #000000">&nbsp;(</span><span style="COLOR: #000000">!</span><span style="COLOR: #000000">RegisterClassW(</span><span style="COLOR: #000000">&amp;</span><span style="COLOR: #000000">wc))&nbsp;</span><span style="COLOR: #0000ff">return</span><span style="COLOR: #000000">&nbsp;FALSE;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;</span><span style="COLOR: #0000ff">return</span><span style="COLOR: #000000">&nbsp;TRUE;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockEnd.gif" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" /></span><span style="COLOR: #0000ff">public</span><span style="COLOR: #000000">:<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;BOOL&nbsp;Create()<br /><img id="_859_1557_Open_Image" onclick="this.style.display='none'; document.getElementById('_859_1557_Open_Text').style.display='none'; document.getElementById('_859_1557_Closed_Image').style.display='inline'; document.getElementById('_859_1557_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_859_1557_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_859_1557_Closed_Text').style.display='none'; document.getElementById('_859_1557_Open_Image').style.display='inline'; document.getElementById('_859_1557_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="_859_1557_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">...</span><span id="_859_1557_Open_Text"><span style="COLOR: #000000">{<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HWND&nbsp;hwnd&nbsp;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&nbsp;CreateWindowW(<br /><img id="_947_962_Open_Image" onclick="this.style.display='none'; document.getElementById('_947_962_Open_Text').style.display='none'; document.getElementById('_947_962_Closed_Image').style.display='inline'; document.getElementById('_947_962_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_947_962_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_947_962_Closed_Text').style.display='none'; document.getElementById('_947_962_Open_Image').style.display='inline'; document.getElementById('_947_962_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L</span><span style="COLOR: #000000">&quot;</span><span style="COLOR: #000000">TimerWndClass</span><span style="COLOR: #000000">&quot;</span><span style="COLOR: #000000">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="_947_962_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="_947_962_Open_Text"><span style="COLOR: #008000">/*</span><span style="COLOR: #008000">&nbsp;Class&nbsp;Name&nbsp;</span><span style="COLOR: #008000">*/</span></span><span style="COLOR: #000000"><br /><img id="_1010_1020_Open_Image" onclick="this.style.display='none'; document.getElementById('_1010_1020_Open_Text').style.display='none'; document.getElementById('_1010_1020_Closed_Image').style.display='inline'; document.getElementById('_1010_1020_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_1010_1020_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_1010_1020_Closed_Text').style.display='none'; document.getElementById('_1010_1020_Open_Image').style.display='inline'; document.getElementById('_1010_1020_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L</span><span style="COLOR: #000000">&quot;</span><span style="COLOR: #000000">TimerWnd</span><span style="COLOR: #000000">&quot;</span><span style="COLOR: #000000">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="_1010_1020_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="_1010_1020_Open_Text"><span style="COLOR: #008000">/*</span><span style="COLOR: #008000">&nbsp;Title&nbsp;</span><span style="COLOR: #008000">*/</span></span><span style="COLOR: #000000"><br /><img id="_1060_1070_Open_Image" onclick="this.style.display='none'; document.getElementById('_1060_1070_Open_Text').style.display='none'; document.getElementById('_1060_1070_Closed_Image').style.display='inline'; document.getElementById('_1060_1070_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_1060_1070_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_1060_1070_Closed_Text').style.display='none'; document.getElementById('_1060_1070_Open_Image').style.display='inline'; document.getElementById('_1060_1070_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WS_OVERLAPPED,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="_1060_1070_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="_1060_1070_Open_Text"><span style="COLOR: #008000">/*</span><span style="COLOR: #008000">&nbsp;Style&nbsp;</span><span style="COLOR: #008000">*/</span></span><span style="COLOR: #000000"><br /><img id="_1116_1129_Open_Image" onclick="this.style.display='none'; document.getElementById('_1116_1129_Open_Text').style.display='none'; document.getElementById('_1116_1129_Closed_Image').style.display='inline'; document.getElementById('_1116_1129_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_1116_1129_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_1116_1129_Closed_Text').style.display='none'; document.getElementById('_1116_1129_Open_Image').style.display='inline'; document.getElementById('_1116_1129_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CW_USEDEFAULT,&nbsp;CW_USEDEFAULT,&nbsp;&nbsp;&nbsp;</span><span id="_1116_1129_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="_1116_1129_Open_Text"><span style="COLOR: #008000">/*</span><span style="COLOR: #008000">&nbsp;Position&nbsp;</span><span style="COLOR: #008000">*/</span></span><span style="COLOR: #000000"><br /><img id="_1175_1184_Open_Image" onclick="this.style.display='none'; document.getElementById('_1175_1184_Open_Text').style.display='none'; document.getElementById('_1175_1184_Closed_Image').style.display='inline'; document.getElementById('_1175_1184_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_1175_1184_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_1175_1184_Closed_Text').style.display='none'; document.getElementById('_1175_1184_Open_Image').style.display='inline'; document.getElementById('_1175_1184_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CW_USEDEFAULT,&nbsp;CW_USEDEFAULT,&nbsp;&nbsp;&nbsp;</span><span id="_1175_1184_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="_1175_1184_Open_Text"><span style="COLOR: #008000">/*</span><span style="COLOR: #008000">&nbsp;Size&nbsp;</span><span style="COLOR: #008000">*/</span></span><span style="COLOR: #000000"><br /><img id="_1230_1241_Open_Image" onclick="this.style.display='none'; document.getElementById('_1230_1241_Open_Text').style.display='none'; document.getElementById('_1230_1241_Closed_Image').style.display='inline'; document.getElementById('_1230_1241_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_1230_1241_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_1230_1241_Closed_Text').style.display='none'; document.getElementById('_1230_1241_Open_Image').style.display='inline'; document.getElementById('_1230_1241_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="_1230_1241_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="_1230_1241_Open_Text"><span style="COLOR: #008000">/*</span><span style="COLOR: #008000">&nbsp;Parent&nbsp;</span><span style="COLOR: #008000">*/</span></span><span style="COLOR: #000000"><br /><img id="_1287_1299_Open_Image" onclick="this.style.display='none'; document.getElementById('_1287_1299_Open_Text').style.display='none'; document.getElementById('_1287_1299_Closed_Image').style.display='inline'; document.getElementById('_1287_1299_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_1287_1299_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_1287_1299_Closed_Text').style.display='none'; document.getElementById('_1287_1299_Open_Image').style.display='inline'; document.getElementById('_1287_1299_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="_1287_1299_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="_1287_1299_Open_Text"><span style="COLOR: #008000">/*</span><span style="COLOR: #008000">&nbsp;No&nbsp;menu&nbsp;</span><span style="COLOR: #008000">*/</span></span><span style="COLOR: #000000"><br /><img id="_1344_1357_Open_Image" onclick="this.style.display='none'; document.getElementById('_1344_1357_Open_Text').style.display='none'; document.getElementById('_1344_1357_Closed_Image').style.display='inline'; document.getElementById('_1344_1357_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_1344_1357_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_1344_1357_Closed_Text').style.display='none'; document.getElementById('_1344_1357_Open_Image').style.display='inline'; document.getElementById('_1344_1357_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="_1344_1357_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="_1344_1357_Open_Text"><span style="COLOR: #008000">/*</span><span style="COLOR: #008000">&nbsp;Instance&nbsp;</span><span style="COLOR: #008000">*/</span></span><span style="COLOR: #000000"><br /><img id="_1403_1429_Open_Image" onclick="this.style.display='none'; document.getElementById('_1403_1429_Open_Text').style.display='none'; document.getElementById('_1403_1429_Closed_Image').style.display='inline'; document.getElementById('_1403_1429_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_1403_1429_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_1403_1429_Closed_Text').style.display='none'; document.getElementById('_1403_1429_Open_Image').style.display='inline'; document.getElementById('_1403_1429_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR: #000000">0</span><span style="COLOR: #000000">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="_1403_1429_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">/**/</span><span id="_1403_1429_Open_Text"><span style="COLOR: #008000">/*</span><span style="COLOR: #008000">&nbsp;No&nbsp;special&nbsp;parameters&nbsp;</span><span style="COLOR: #008000">*/</span></span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" /><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;</span><span style="COLOR: #0000ff">if</span><span style="COLOR: #000000">&nbsp;(hwnd&nbsp;</span><span style="COLOR: #000000">==</span><span style="COLOR: #000000">&nbsp;NULL)&nbsp;</span><span style="COLOR: #0000ff">return</span><span style="COLOR: #000000">&nbsp;FALSE;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;SetWindowLong(hwnd,&nbsp;GWL_USERDATA,&nbsp;(</span><span style="COLOR: #0000ff">long</span><span style="COLOR: #000000">)</span><span style="COLOR: #0000ff">this</span><span style="COLOR: #000000">);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_hwnd&nbsp;</span><span style="COLOR: #000000">=</span><span style="COLOR: #000000">&nbsp;hwnd;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;</span><span style="COLOR: #0000ff">return</span><span style="COLOR: #000000">&nbsp;TRUE;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockEnd.gif" />&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" /><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;BOOL&nbsp;DestroyWindow()<br /><img id="_1583_1620_Open_Image" onclick="this.style.display='none'; document.getElementById('_1583_1620_Open_Text').style.display='none'; document.getElementById('_1583_1620_Closed_Image').style.display='inline'; document.getElementById('_1583_1620_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_1583_1620_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_1583_1620_Closed_Text').style.display='none'; document.getElementById('_1583_1620_Open_Image').style.display='inline'; document.getElementById('_1583_1620_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;</span><span id="_1583_1620_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">...</span><span id="_1583_1620_Open_Text"><span style="COLOR: #000000">{<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;</span><span style="COLOR: #0000ff">return</span><span style="COLOR: #000000">&nbsp;::DestroyWindow(m_hwnd);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockEnd.gif" />&nbsp;}</span></span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" /><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;UINT_PTR&nbsp;SetTimer(UINT_PTR&nbsp;nIDEvent,&nbsp;UINT&nbsp;uElapse)<br /><img id="_1676_1733_Open_Image" onclick="this.style.display='none'; document.getElementById('_1676_1733_Open_Text').style.display='none'; document.getElementById('_1676_1733_Closed_Image').style.display='inline'; document.getElementById('_1676_1733_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_1676_1733_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_1676_1733_Closed_Text').style.display='none'; document.getElementById('_1676_1733_Open_Image').style.display='inline'; document.getElementById('_1676_1733_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;</span><span id="_1676_1733_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">...</span><span id="_1676_1733_Open_Text"><span style="COLOR: #000000">{<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;</span><span style="COLOR: #0000ff">return</span><span style="COLOR: #000000">&nbsp;::SetTimer(m_hwnd,&nbsp;nIDEvent,&nbsp;uElapse,&nbsp;NULL);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockEnd.gif" />&nbsp;}</span></span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" /><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;BOOL&nbsp;KillTimer(UINT_PTR&nbsp;uIDEvent)<br /><img id="_1772_1815_Open_Image" onclick="this.style.display='none'; document.getElementById('_1772_1815_Open_Text').style.display='none'; document.getElementById('_1772_1815_Closed_Image').style.display='inline'; document.getElementById('_1772_1815_Closed_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockStart.gif" /><img id="_1772_1815_Closed_Image" style="DISPLAY: none" onclick="this.style.display='none'; document.getElementById('_1772_1815_Closed_Text').style.display='none'; document.getElementById('_1772_1815_Open_Image').style.display='inline'; document.getElementById('_1772_1815_Open_Text').style.display='inline';" align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ContractedSubBlock.gif" />&nbsp;</span><span id="_1772_1815_Closed_Text" style="BORDER-RIGHT: #808080 1px solid; BORDER-TOP: #808080 1px solid; DISPLAY: none; BORDER-LEFT: #808080 1px solid; BORDER-BOTTOM: #808080 1px solid; BACKGROUND-COLOR: #ffffff">...</span><span id="_1772_1815_Open_Text"><span style="COLOR: #000000">{<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;</span><span style="COLOR: #0000ff">return</span><span style="COLOR: #000000">&nbsp;::KillTimer(m_hwnd,&nbsp;uIDEvent);<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedSubBlockEnd.gif" />&nbsp;}</span></span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/InBlock.gif" />&nbsp;&nbsp;&nbsp;&nbsp;HWND&nbsp;m_hwnd;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/ExpandedBlockEnd.gif" />}</span></span><span style="COLOR: #000000">;<br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span><span style="COLOR: #0000ff">#endif</span><span style="COLOR: #000000">&nbsp;</span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">&nbsp;_TIMERWND_H_</span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span><span style="COLOR: #008000">//</span><span style="COLOR: #008000">&nbsp;TimerWnd.h&nbsp;end&nbsp;here&nbsp;-------------------------------------------------</span><span style="COLOR: #008000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span><span style="COLOR: #000000"><br /><img align="top" alt="" src="http://images.csdn.net/syntaxhighlighting/OutliningIndicators/None.gif" /></span></div>
</div>
<p>使用起来很简单, 从 TimerWnd 派生一个窗口类. 重载 OnTimer(), 在初始化的时候调用 Create() 创建即可.. 使用简单, 不用记住繁琐的 Create 参数. 没有 MFC 的烦人的 map. 可以跨线程操作.</p>
<p>说说实现上的几个细节.<br />. 使用了宽字符版本的 API, 从理论上讲, 效率能高一点.<br />. 从窗口句柄转换为对象, 使用的是简单的 Set/GetWindowLong, 因为只处理 WM_TIMER, 效率不成问题, 没有使用 MFC 繁琐的 map, 也没有用 ATL 的高深的 thunk.<br />. 没有使用 .cpp, 直接 include 即可.&nbsp;</p>
]]></content:encoded><pubDate>2006-08-18 11:29</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[在 VBA host 中实现 Sleep() 函数]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/07/25/976029.aspx</link><content:encoded><![CDATA[

<p>在 vba 中需要使用 sleep() 函数. <br />想当然, 一开始是这样实现的:<br />STDMETHODIMP CShell::Sleep(int nMillSeconds)<br />{<br />&nbsp;::Sleep(nMillSeconds);<br />&nbsp;return S_OK;<br />}<br />&nbsp;<br />但很快就发现这样不行.&nbsp; Sleep 的时候, 程序主界面死了. <br />应该用 GetMessage() 来实现. 但 GetMessage() 是阻塞的. 不拿到一条消息不会返回. <br />我需要的是 GetMessageTimeOut(), 可以指定一个超时. 超时后不管有没有消息都返回. <br />可惜 MSDN 里没有这样的函数. <br />那就只好在循环里面 PeekMessage(), 发现有消息再 GetMessage() 了. 象这样:</p>
<p>STDMETHODIMP CShell::Sleep(int nMillSeconds)<br />{<br />&nbsp;for (int n = 0; n &lt; nMillSeconds; n += 50)<br />&nbsp;{<br />&nbsp;&nbsp;MSG msg;<br />&nbsp;&nbsp;while (PeekMessage(&amp;msg, NULL, NULL, NULL, PM_NOREMOVE))<br />&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;if (GetMessage(&amp;msg, NULL, NULL, NULL))<br />&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;TranslateMessage(&amp;msg);<br />&nbsp;&nbsp;&nbsp;&nbsp;DispatchMessage(&amp;msg);<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br />&nbsp;&nbsp;::Sleep(50);<br />&nbsp;}<br />&nbsp;return S_OK;<br />}</p>
<p>这样子能够满足需要. 但还是不够完美. 每 50ms 醒来一次. 醒来只是为了继续睡觉.<br />我需要的是一直睡, 直到指定的时间再醒来. 并且还得在睡觉的时候有消息还得处理消息.<br />还是 GetMessage(), 如果在指定的时间到了之后收到一条不管什么消息. 让 GetMessage() 返回即可.<br />既然是指定的时间之后的消息, 那 WM_TIMER 就很自然了. 最后的实现是这样的:</p>
<p>STDMETHODIMP CShell::Sleep(int nMillSeconds)<br />{<br />&nbsp;MSG msg;<br />&nbsp;int nTimerID = SetTimer(NULL, 0, nMillSeconds, NULL);<br />&nbsp;while (GetMessage(&amp;msg, NULL, NULL, NULL))<br />&nbsp;{<br />&nbsp;&nbsp;if (msg.message == WM_TIMER &amp;&amp; msg.wParam == nTimerID)<br />&nbsp;&nbsp;&nbsp;return S_OK;<br />&nbsp;&nbsp;TranslateMessage(&amp;msg);<br />&nbsp;&nbsp;DispatchMessage(&amp;msg);<br />&nbsp;}</p>
<p>&nbsp;return S_FALSE;<br />}&nbsp;</p>
]]></content:encoded><pubDate>2006-07-25 18:06</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[远程调试小结]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/07/25/974214.aspx</link><content:encoded><![CDATA[

<p>远程机器必须运行Visual C++ Debug Monitor（Msvcmon.exe，和MSDEV.exe在同一个目录下），为了运行 Msvcmon.exe，远程机器上必须有：Tln0t.dll、Dm.dll、Msvcp60.dll、Msdis100.dll</p>
<p>步骤： <br />在远程机器(比如 192.168.0.2)上运行 msvcmon.exe，选择 Network(TCP/IP)， Settings 不用填, 点击 Connect, 此时 msvcmon 作为服务端在监听 2049, 2050 端口.<br />在本地机器(比如 192.168.0.1)上<br />&nbsp;将 <a href="file://192.168.0.2/d$">\\192.168.0.2\d$</a> 映射为网络盘(比如 z:\)<br />&nbsp;运行 Visual Studio，<br />&nbsp;&nbsp;选择 Build-&gt;Debugger Remote Connection 打开 Remote Connection，选中 Network(TCP/IP)，点击 Settings 设置远程机器的 IP.<br />&nbsp;&nbsp;选择 Project-&gt;Settings/Debug/Remote executable path and file name, 指定在远程机器的待调试的程序. 比如 <a href="file://192.168.0.2/d$/demo.exe">\\192.168.0.2\d$\demo.exe</a><br />&nbsp;&nbsp;选择 Project-&gt;Settings/Link/Output file name, 填入 z:\demo.exe<br />&nbsp;&nbsp;</p>
<p>远程机器上可能没有 vc debug runtime, 所以需要将下面的 dll 复制过去. <br />mfc42d.dll<br />mfcd42d.dll<br />mfcn42d.dll<br />mfco42d.dll<br />MSVCP60D.DLL<br />Msvcrtd.dll<br />放到 demo.exe 能够访问到的地方.</p>
<p>在本地机器的 vc 里按F5开始调试程序 <br />另外, 如果两个机器不在同一个地方. 使用 vnc 等远程控制工具配置使用效果尤佳.&nbsp;</p>
]]></content:encoded><pubDate>2006-07-25 11:34</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[小议 COM 线程模型]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/07/21/953695.aspx</link><content:encoded><![CDATA[

<p>最开始的时候 COM 没有多线程的概念. inproc 组件也没有 InprocServer32 这样的键值.<br />所有的组件都认为自己在唯一的线程中被创建. 使用. 不用同步访问任何数据. 因为一个进程中只有一个线程.<br />所有的组件都挤在 main STA 执行. 等一个组件的函数调用执行完成, 另一个组件的函数调用才可能继续.</p>
<p>然后多线程出现了. inproc 组件开始支持 InprocServer32=apartment, 组件可以在不同的线程里被创建. <br />apartment 组件要做的是同步全局数据. 比如, 两个线程创建了同一个组件的两个实例. 如果组件有一些独立于实例的全局数据. <br />那么这些数据需要同步访问. <br />情况好转了一些. 一个组件可以在一个单独的线程执行. 在一个线程内部访问该线程创建的组件. 不用调度, 可以直接访问.</p>
<p>但问题依然存在, 跨线程访问一个组件时. 需要调度. 不论是否真的需要同步访问, 每次都需要等待组件的一个函数调用完成, <br />才能继续另一个函数调用. 毕竟只有一个线程. <br />然后就出现了 InprocServer32=free 的组件. 一个进程中多个线程可以加入到一个 MTA 中. 这个 MTA 中的线程可以自由<br />的访问这个 MTA 中的组件的方法. 要不要同步. 全由程序员来决定了.<br />对于 COM runtime 来说. 它可以不用再管组件的同步. 所有的工作都交给了 COM 程序员. 而在 single 和 apartment 中.<br />COM runtime 还为 COM 组件创建了一个隐藏的窗口来实现函数调用的同步. </p>
<p>一个 STA 客户访问一个 free 的组件. 那么还是需要调度. 影响效率. 所以. 出现了 InprocServer32=both 的组件. <br />当 STA 客户访问时. 它就是 STA 组件. 可以直接调用. 当 MTA 客户访问时. 它就是 MTA 组件.&nbsp; 也可以直接调用. &nbsp;</p>

<p>COM 的线程模型其实也用来解决 COM 在多线程中遇到的问题. 它用于减轻程序员的编程负担. &nbsp;Not a burden, but a&nbsp;helper.<br /></p>
]]></content:encoded><pubDate>2006-07-21 16:20</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Phases of Translation]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/06/27/841196.aspx</link><content:encoded><![CDATA[

<h1><a name="_predir_phases_of_translation"></a>Phases of Translation</h1>
<p>C and C++ programs consist of one or more source files, each of which contains some of the text of the program. A source file, together with its include files (files that are included using the <strong>#include</strong> preprocessor directive) but not including sections of code removed by conditional-compilation directives such as <strong>#if</strong>, is called a &ldquo;translation unit.&rdquo;</p>
<p>Source files can be translated at different times &mdash; in fact, it is common to translate only out-of-date files. The translated translation units can be kept either in separate object files or in object-code libraries. These separate translation units are then linked to form an executable program or a dynamic-link library (DLL).</p>
<p>Translation units can communicate using: </p>
<ul type="disc">
    <li>Calls to functions that have external linkage.<br /><br /></li>
    <li>Calls to class member functions that have external linkage.<br /><br /></li>
    <li>Direct modification of objects that have external linkage.<br /><br /></li>
    <li>Direct modification of files.<br /><br /></li>
    <li>Interprocess communication (for Microsoft Windows-based applications only). </li>
</ul>
<p>The following list describes the phases in which the compiler translates files:</p>
<p class="dt"><em>Character mapping</em></p>
<p class="indent">Characters in the source file are mapped to the internal source representation. Trigraph sequences are converted to single-character internal representation in this phase.</p>
<p class="dt"><em>Line splicing</em></p>
<p class="indent">All lines ending in a backslash (<strong>\</strong>) and immediately followed by a newline character are joined with the next line in the source file, forming logical lines from the physical lines. Unless it is empty, a source file must end in a newline character that is not preceded by a backslash.</p>
<p class="dt"><em>Tokenization</em></p>
<p class="indent">The source file is broken into preprocessing tokens and white-space characters. Comments in the source file are replaced with one space character each. Newline characters are retained.</p>
<p class="dt"><em>Preprocessing</em></p>
<p class="indent">Preprocessing directives are executed and macros are expanded into the source file. The <strong>#include</strong> statement invokes translation starting with the preceding three translation steps on any included text.</p>
<p class="dt"><em>Character-set mapping</em></p>
<p class="indent">All source-character-set members and escape sequences are converted to their equivalents in the execution-character set. For Microsoft C and C++, both the source and the execution character sets are ASCII.</p>
<p class="dt"><em>String concatenation</em></p>
<p class="indent">All adjacent string and wide-string literals are concatenated. For example, <code>&quot;String &quot; &quot;concatenation&quot;</code> becomes <code>&quot;String concatenation&quot;</code>.</p>
<p class="dt"><em>Translation</em></p>
<p class="indent">All tokens are analyzed syntactically and semantically; these tokens are converted into object code.</p>
<p class="dt"><em>Linkage</em></p>
<p class="indent">All external references are resolved to create an executable program or a dynamic-link library.</p>
<p>The compiler issues warnings or errors during phases of translation in which it encounters syntax errors.</p>
<p>The linker resolves all external references and creates an executable program or DLL by combining one or more separately processed translation units along with standard libraries.</p>
<!--FOOTER_START-->
< language="JavaScript" src="MS-ITS:dsmsdn.chm::/html/msdn_footer.js" type="text/javascript"></script>
&nbsp;
]]></content:encoded><pubDate>2006-06-27 17:19</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[转一篇候捷的 Inside C++ Object Model 译本的译序]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/05/11/723408.aspx</link><content:encoded><![CDATA[

<p><em>最近在读 Inside C++ Object Model; Essential COM</em></p>
<p><em>转一篇候捷的 Inside C++ Object Model 译本的译序</em></p>
<p>对於传统的循序性（sequential）语言，我们向来没有太多的疑惑，虽然在函式呼叫的背後，也有着堆叠建制、叁数排列、回返位址、堆叠清除等等幕後机制，但函式呼叫是那麽地自然而明显，好像只是夹带着一个包裹，从程式的某一个地点跳到另一个地点去执行。<br />&nbsp;&nbsp;&nbsp; 但是对於物件导向（Object Oriented）语言，我们的疑惑就多了。究其因，这种语言的编译器为我们（程式员）做了太多的服务：建构式、解构式、虚拟函式、继承、多型...。有时候它为我们合成出一些额外的函式（或运算子），有时候它又扩张我们所写的函式内容，放进更多的动作。有时候它还会为我们的 objects 加油添醋，放进一些奇妙的东西，使你面对 sizeof 的结果大惊失色。<br />&nbsp;&nbsp;&nbsp; 存在我心里头一直有个疑惑：电脑程式最基础的形式，总是脱离不了一行一行的循序执行模式，为什麽OO（物件导向）语言却能够「自动完成」这麽多事情呢？另一个疑惑是，威力强大的 polymorphism（多型），其底层机制究竟如何？ <br />&nbsp;&nbsp;&nbsp; 如果不了解编译器对我们所写的 C++ 码做了什麽手脚，这些困惑永远解不开。 <br />&nbsp;&nbsp;&nbsp; 这本书解决了过去令我百思不解的诸多疑惑。我要向所有已具备 C++ 多年程式设计经验的同好们大力推荐这本书。<br />&nbsp;&nbsp;&nbsp; 这本书同时也是跃向元件软体（component-ware）基本精神的跳板。不管你想学习 COM（Component Object Model）或CORBA（Common Object Request Broker Architecture）或是 SOM（System Object Model），了解 C++ Object Model，将使你更清楚软体元件（components）设计上的难点与运应之道。不但我自己在学习 COM 的道路上有此强烈的感受，Essential COM（COM 本质论，侯俊杰译， 峰 1998）的作者 Don Box 也在他的书中推崇 Lippman 的这一本卓越的书籍。 ?<br />&nbsp;&nbsp;&nbsp; 是的，这当然不会是一本轻松的书籍。某些章节（例如３、４两章）可能给你立即的享受 -- 享受於面对底层机制有所体会与掌控的快乐；某些章节（例如５、６、７三章）可能带给你短暂的痛苦 -- 痛苦於艰难深涩难以吞咽的内容。这些快乐与痛苦，其实就是我翻译此书时的心情写照。无论如何，我希望透过我的译笔，把这本难得的好书带到更多人面前，引领大家见识C++ 底层建设的技术之美。<br />&nbsp;</p>
]]></content:encoded><pubDate>2006-05-11 08:59</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[没有登录就自动完成ADSL拨号]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/05/05/709652.aspx</link><content:encoded><![CDATA[

问：我使用的操作系统是Windows XP，采用ADSL上网，拨号链接名为myadsl。只有我的电脑上网了，其它电脑才能上网。但是有时其他同事总比我起得早，因此我希望在系统还没有登录的情况下能自动完成ADSL拨号上网。这样以后同事只要直接打开我的主机电源而不需要登录我的系统就可以上网，请问如何设置？<br /><br />　　答：可以利用系统&ldquo;计划任务&rdquo;功能来实现，具体方法是添加一个拨号任务（程序的路径及文件名是：c:\Windows\system32\rasphone.exe），然后将任务的执行时间设置为&ldquo;计算机启动时&rdquo;，点击&ldquo;下一步&rdquo;设置登录系统的账号和密码。设置完成后，打开该计划任务的属性，然后设置&ldquo;任务&rdquo;标签下运行为：&ldquo;C:\WINDOWS\system32\rasphone.exe d myadsl&rdquo;（不包含引号），最后点击&ldquo;确定&rdquo;即可
]]></content:encoded><pubDate>2006-05-05 22:13</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[连词“while”的不同含义及其不同译法]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/05/05/709554.aspx</link><content:encoded><![CDATA[

<h1>连词&ldquo;while&rdquo;的不同含义及其不同译法</h1>
<div class="text">2006-04-19 09:41:31　来源: <a target="_blank" href="http://education.163.com/06/0419/09/2F2HAO0A00291ONA.html#">长春新东方学校教学教</a>　　　<a class="cDRed" target="_self" href="http://education.163.com/06/0419/09/2F2HAO0A00291ONA.html#0">网友评论 <span class="cDRed" id="replycounttop">0</span>&nbsp;条</a> </div>
<div class="clear">　</div>
<!-- main -->
<div id="main">
<div id="text">
<p style="TEXT-INDENT: 2em">连词while除具有&ldquo;当时&rdquo;、&ldquo;同时&rdquo;等意义外，根据上下文还有以下不同含义及其不同译法。</p>
<p style="TEXT-INDENT: 2em"><strong>一、引导时间状语从句 </strong></p>
<p style="TEXT-INDENT: 2em">译作&ldquo;当&hellip;&hellip;时&rdquo;。例如： </p>
<p><!-- 文章大屏幕广告 --></p>
<p style="TEXT-INDENT: 2em">1. Make hay while the sun shines. </p>
<p style="TEXT-INDENT: 2em">趁着有太阳晒晒草。（乘机行事，抓紧时机。） </p>
<p style="TEXT-INDENT: 2em">2. We must work hard to gain more knowledge while we are young. </p>
<p style="TEXT-INDENT: 2em">趁着现在还年轻，我们必须刻苦学习，获得更多的知识。 </p>
<p style="TEXT-INDENT: 2em"><strong>二、引导让步状语从句</strong> </p>
<p style="TEXT-INDENT: 2em">常放在句首，译作&ldquo;尽管&rdquo;、&ldquo;虽然&rdquo;，比although或 though语气要轻。例如： </p>
<p style="TEXT-INDENT: 2em">1. While I believe it is true, I cannot prove it. </p>
<p style="TEXT-INDENT: 2em">虽然我相信那是真的，但我无法证明。 </p>
<p style="TEXT-INDENT: 2em">2. While any kind of athletic shoe can provide a certain amount of rebound, energy-return sneakers are designed to maximize this effect. </p>
<p style="TEXT-INDENT: 2em">虽然任何一种运动鞋都能提供一定的反弹力，但回力运动鞋能够使这种效果最大化。 </p>
<p style="TEXT-INDENT: 2em"><strong>三、引导条件状语从句 </strong></p>
<p style="TEXT-INDENT: 2em">相当于as long as，译作&ldquo;只要&rdquo;。例如： </p>
<p style="TEXT-INDENT: 2em">1. While there is life, there is hope. </p>
<p style="TEXT-INDENT: 2em">有生命，就有希望。 </p>
<p style="TEXT-INDENT: 2em">2. While a spark of life remains, it is a doctor's duty to save the patient. </p>
<p style="TEXT-INDENT: 2em">只要病人还有一息生机，医生就有责任挽救。 </p>
<p style="TEXT-INDENT: 2em"><strong>四、引导原因状语从句 </strong></p>
<p style="TEXT-INDENT: 2em">相当于since， 有&ldquo;既然&rdquo;的意思。例如： </p>
<p style="TEXT-INDENT: 2em">1. You'll never save any money while you're so extravagant. </p>
<p style="TEXT-INDENT: 2em">你这么奢侈，永远存不下钱来。 </p>
<p style="TEXT-INDENT: 2em">2. I'd like to get it settled today while we're at it. </p>
<p style="TEXT-INDENT: 2em">既然我们着手干了，我想今天就把它干完。 </p>
<p style="TEXT-INDENT: 2em"><strong>五、连接并列句 </strong></p>
<p style="TEXT-INDENT: 2em">表示对比，相当于whereas，译作&ldquo;而&rdquo;、&ldquo;可是&rdquo;。例如： </p>
<p style="TEXT-INDENT: 2em">1. An outdoors man will soon become pale if he changes to an indoor job, while a desk clerk will take on a tan after a short vacation in the sun. </p>
<p style="TEXT-INDENT: 2em">从事室外工作的人如果调到室内工作，不久肤色就会变白；而一个伏案工作的文员出去度个短假，就会被太阳变黑。 </p>
<p style="TEXT-INDENT: 2em">2. Motion is absolute while stagnation is relative.</p>
<p style="TEXT-INDENT: 2em">运动是绝对的，而静止是相对的。 </p>
<p style="TEXT-INDENT: 2em"><strong>六、连接并列句 </strong></p>
<p style="TEXT-INDENT: 2em">表示递进，相当于and what is more, 译作&ldquo;并且&rdquo;、&ldquo;而且&rdquo;。例如： </p>
<p style="TEXT-INDENT: 2em">1. The new man-made fibres are more hardwearing than natural fibres and greatly reduce mending, while good ready-made clothes are cheap and plentiful.</p>
<p style="TEXT-INDENT: 2em">新的人造纤维比天然纤维耐磨，因此能大大减少修补工作，而且做好的衣服价廉物美，数量也多。 </p>
<p style="TEXT-INDENT: 2em">2. Of course, I resolutely determined not to marry, while I quite forgot to consider at all that great rock of disaster in the working-class world-- sickness.</p>
<p style="TEXT-INDENT: 2em">当然, 我下定决心不结婚，而且把工人阶级的巨大灾难&mdash;&mdash;疾病，也忘得一干二净</p>
</div>
</div>
]]></content:encoded><pubDate>2006-05-05 20:53</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[vc6 Tools: &amp;Zip it]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2006/05/01/699378.aspx</link><content:encoded><![CDATA[

<p>cmd:</p>
<p>c:\program files\winrar\winrar.exe</p>
<p>param:</p>
<p>a -ag&quot;YYYY-MM-DD HH.MM'&quot; -r -o- -xdebug\ -xrelease\ -idp -m5 -ed -isnd -x*.rar -x*.exe -x*.ilk -x*.ncb -x*.scc -x*.obj -x*.pch -x*.res -x*.pdb &quot;..\$(WkspName) &quot; </p>
]]></content:encoded><pubDate>2006-05-01 00:13</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[在公交车上如何占到座位?]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2005/07/06/415522.aspx</link><content:encoded><![CDATA[

首先是在站台上的站位. 理想情况下. 公交车司机停车的时候一般都让车门对着自己的站牌. 在现实社会中. 因为有干扰而发生偏差. 最常见的就是自己的站牌位置被其他车辆占据(因为大家的站牌都竖在一起), 所以, 这种情况下. 要先计算车停的位置. 最好的站位应该是车停稳之后车门正对着你.

上了车之后. 如果有人售票. 那么我们就多了一个收集信息的途径. 你可以跟在售票员身后, 售票员都要问乘客到那一站下车. 这样. 我们就可以选择站在最近站点下车的乘客身边了. 使用这种方法有一个额外条件: 你要学会忍受售票员异样的眼光(小样儿..干嘛呢??). 如果是无人售票车, 我们就只能自力更生了. 根据乘客的言谈, 衣着等来判断她/他/它(哦. 错了. 宠物一般不会占一个位子的)会在哪儿下车. 简单一些的. 比如前面坐着一个个学生模样的, 而再过两站就是 xx 大学了. 那么你可以考虑站到他的身边. 毕竟两站的话, 机会成本也不是很高嘛.
]]></content:encoded><pubDate>2005-07-06 13:20</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[设置 windows 2000/2003 server 自动登录]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2005/06/20/398283.aspx</link><content:encoded><![CDATA[

大家都知道， win2000pro 下在控制面板里面有一个 applet 可也设置 windows 自动登录。
但在 server 版下， 却没有这个选项了。
 
其实可也用这个命令调出那个 applet.
 
windows2000: 
 
control userpasswords

 
windows2003:
control userpasswords2 
 


]]></content:encoded><pubDate>2005-06-20 10:28</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[set DEVMGR_SHOW_NONPRESENT_DEVICES=1 ]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2005/03/25/330575.aspx</link><content:encoded><![CDATA[

<p>由於windows莫名其妙的registry原因,很多用户发现,在安装蓝牙管理软件之後,对应的蓝牙虚拟端口居然变成COM9,甚至是COM13或更高,导致与许多应用程序,如手机同步软件,PDA同步软件无法使用 <br/>多次重新安装蓝牙管理软件只会让状况更恶化.. </p><p>解决方案如下(执行下列步骤之前,请务必卸载蓝牙管理程序,并重新开机) <br/>1.在Windows系统,按开始&gt;执行&gt;输入cmd,按回车 <br/>2.出现命令字符视窗之後,输入 <br/>set DEVMGR_SHOW_NONPRESENT_DEVICES=1 <br/>按回车 <br/>devmgmt.msc <br/>按回车 <br/>3.然后在设备管理器点击&gt;查看&gt;显示隐藏的设备 <br/>您现在能能删除多余的端口了,删除完毕之後,请务必重新开机 </p><p>4.重新安装蓝牙管理软件 </p><p>5.如果您想永久性投入这个环境变量到XP, 到我的电脑&gt;点选之後,按鼠标右键&gt;属性&gt;高级&gt;环境变量 <br/>在系统变量里面,按&quot;新建&quot;,在&quot;变量名&quot;里面填入&quot; DEVMGR_SHOW_NONPRESENT_DEVICES&quot; ,变量值填入&quot;1&quot;</p>
]]></content:encoded><pubDate>2005-03-25 21:28</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Intel集成显卡的桌面右键菜单延迟问题]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2005/03/24/328559.aspx</link><content:encoded><![CDATA[

<table class="ubb_quote" cellspacing="1" cellpadding="0" width="90%" border="0"><tbody><tr><td class="ubb_quote_title">去掉Intel集成显卡的桌面右键菜单:</td></tr><tr><td><p>运行：<br/>regsvr32 /u igfxpph.dll </p><p>恢复使用 regsvr32 igfxpph.dll</p></td></tr></tbody></table>
]]></content:encoded><pubDate>2005-03-24 10:50</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[Fedora Core3 @ vmware 4.5.2Build8848]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2004/12/02/202430.aspx</link><content:encoded><![CDATA[

今天在 vmware 上整了一个 FC3. 感觉不错阿.
创建了一个 4G 的硬盘. 第一次装的时候没有注意安装大小. 居然提示空间不足. 没办法, 只好重来. 再次选的时候, 把一些奢侈的东东就免了. 安装停顺利的.

装完后重起, 到了登录界面. 直接输入用户名,密码.居然没有见到 KDE!奇怪. 我明明选了的阿. 原来在登录的时候有个关于 "会话"的选项.在哪里可以选择 KDE.然后登录就可以进入KDE了. 

然后就发现分辨率只有800x 600. 上网一查, 发现原来是没有安装 vmware-tools. 按照说明一步一步的安装之后. 完成配置. 发现进不了 X 了! 继续找. 的确有人也遇到这个问题. 接着就找到了解决方案.见:
http://kerneltrap.org/node/view/4030 
这个老外还提供了一个 vmware-tools的一个补丁. 按照他的说明把补丁打上. 顺便学他的去掉了一些没用的服务, reboot. 可以了. 速度也快多了. 

这段文字就是在 fedora 下写出来的. 它自带的 智能拼音 虽然比不上紫光. 但已经很出色了. nice..
]]></content:encoded><pubDate>2004-12-02 20:01</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[世事变幻...]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2004/11/18/186331.aspx</link><content:encoded><![CDATA[

今天早上一点多的时候. 我还在这里测试自己的blog, 然后就睡觉了.<br />但就在凌晨4点, 我居然从睡梦中醒来---疼醒的. 胃靠后的部分很疼. <img alt="" src="http://blog.csdn.net/Emoticons/cry_smile.gif" />.<br />很疼..坐也不是, 睡也不是. 没有一个姿势可以缓释我的疼痛. 凌晨4 点.<br />医院都没有开门. 我只能慢慢的熬..可以想见时间过得是多么的慢..我在屋子<br />里面走来走去. 但疼痛并没有因此而少一点. 老婆不在家. 出差去了. <br /><br />很少觉得无助的我感到了一个人在外乡的孤独. 要是在家里该有多好啊..<br />真的想给老婆打电话. 但这次老婆去上海出差. 还要顺便回家一趟. 我不想<br />让她担心. 我打算向房东求助(就住在隔壁), 但想想还是算了. 不好意思这样<br />麻烦别人. 毕竟只是房东嘛.&nbsp; 还好的是我的一个哥们还在这边. 大学同学. <br />终于熬到了早上7点. 给他打电话. 接电话的声音居然比我想象的要清醒.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><br />和他说明了情况. 他答应马上就过来. I feel better.. 7:30. 终于过来了. 开门的时候<br />从镜子里面发觉自己的气色真的很差. 稍事收拾, 打的去省医院. 发觉幸亏叫了<br />哥们. 挂号. 验尿. x光. (其间都是要排队的). 我自己一个人是决计搞不定的.<br />因为还没有确诊. 医生不同意给我打止疼针. 等到这些都搞定了. 大概也是 10:30了.<br />医生认为是小的肾结石, 建议我保守治疗. 也就是打针, 吃药. 到了 11:00, 终于开始<br />实际的治疗--打点滴. <br /><br />一直打到下午 2:30. 哥们下午有事. 就先走了. 点滴打完. 感觉好一些了. 虽然还是<br />有些疼. <br /><br />现在我躺在家里. 真的觉得世事的变幻. 昨晚还是好好的. 现在却是这个样子..<br />痛苦啊..
]]></content:encoded><pubDate>2004-11-18 19:05</pubDate><wp:status>publish</wp:status></item>
<item><title><![CDATA[无聊, 无聊, 真无聊...]]></title><link>http://blog.csdn.net/ArCoolGG/archive/2004/11/18/185103.aspx</link><content:encoded><![CDATA[

老婆出差去了..<BR>home alone... 感觉越来越相依为命了..<IMG src="http://blog.csdn.net/Emoticons/sad_smile.gif"><BR>
<HR id=null>
2004年11月18日0:58:18
]]></content:encoded><pubDate>2004-11-18 0:58</pubDate><wp:status>publish</wp:status></item>
</channel>
</rss>